<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>CaiusTheory</title>

    <link rel="alternate" type="application/atom+xml" title="Caius Theory" href="/feed/" />

    <link rel="stylesheet" href="/stylesheets/stylesheet.css" type="text/css" media="screen" title="no title" charset="utf-8">
  </head>
  <body>

    <header>
      <h1><a href="/">Caius Theory</a></h1>
      <h2>Now with even more cowbell&hellip;</h2>
    </header>

    <main>
        <article>

  <header>
    <h1>SoundCloud RSS Feeds</h1>
    <time datetime="2015-11-26T23:33:37+00:00">2015-11-26 23:33:37</time>
  </header>

  <p><a href="https://soundcloud.com">SoundCloud</a> appears to have gained popularity in recent times for hosting podcasts on. As a consumer of their service they're pretty good at everything except having a visible RSS feed on a profile page for a show! If I want to listen to a shown in my podcast app of choice, an RSS feed is the easiest way for me to achieve that.</p>

<p>Turns out SoundCloud <em>do</em> have RSS feeds, they're just well hidden and unfindable from the profile page itself. Thankfully, you can construct the URL for it from information on the profile page, and here's a bookmarklet that will do it for you:</p>

<pre><code>javascript:var%20userURI;var%20metaTags=document.getElementsByTagName(
%22meta%22);for(var%20i=0;i&lt;metaTags.length;i++){t=metaTags[i];if(
t.attributes[%22property%22]&amp;&amp;t.attributes[%22property%22].value==
%22al:ios:url%22){userURI=t.content;}}if(userURI){u=userURI.split(%22//%22)[1];
window.location=%22http://feeds.soundcloud.com/users/soundcloud:%22+u+
%22/sounds.rss%22;}
</code></pre>

<p>Or as a <a href="javascript:var%20userURI;var%20metaTags=document.getElementsByTagName(%22meta%22);for(var%20i=0;i&lt;metaTags.length;i++){t=metaTags[i];if(t.attributes[%22property%22]&amp;&amp;t.attributes[%22property%22].value==%22al:ios:url%22){userURI=t.content;}}if(userURI){u=userURI.split(%22//%22)[1];window.location=%22http://feeds.soundcloud.com/users/soundcloud:%22+u+%22/sounds.rss%22;}">handy link</a> to copy to your bookmarks bar. Simply click/run that when on a SoundCloud profile page and you'll be taken to the RSS Feed URL.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/bookmarklet/">bookmarklet</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/soundcloud/">soundcloud</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>exec(3) in Go</h1>
    <time datetime="2015-01-31T09:37:37+00:00">2015-01-31 09:37:37</time>
  </header>

  <p>Using <a href="http://man7.org/linux/man-pages/man3/exec.3.html">exec(3)</a> from Go is simple enough, once you figure out to look in the <a href="http://golang.org/pkg/syscall/">syscall</a> package and how to pass arguments to the new command.</p>

<p>As a simple example, I'm going to exec <code>/bin/echo</code> with a hardcoded string from the go binary. <em>The program built here is in the <a href="https://github.com/caius/gecho">gecho</a> (Gecko, geddit?) git repo, which each stage as a commit.</em></p>

<p>In our main function lets setup some variables we're going to need for arguments to <code>syscall.Exec</code>:</p>

<pre><code>func main() {
	cmdPath := "/bin/echo"
	cmdArgs := []string{"Hello", "World"}
	cmdEnv := []string{}    
}
</code></pre>

<p><em>(We could use <code>os.Environ()</code> for <code>cmdEnv</code> to take the ENV from the go binary, but we don't require anything from the environmnt here so it doesn't matter that we aren't.)</em></p>

<p>Now we have the arguments for <code>syscall.Exec</code>, lets add that in and see what happens:</p>

<pre><code>err := syscall.Exec(cmdPath, cmdArgs, cmdEnv)
if err != nil {
    panic(err)
}
</code></pre>

<p>And running the file (<code>go run gecho.go</code> compiles &amp; runs for us) gives the following output:</p>

<pre><code>World
</code></pre>

<p>Err, say what now? Where's "Hello" gone?!</p>

<p>Took me a while to figure this out when I originally ran into this. The answer is staring us right in the face if we go look at the <a href="http://golang.org/pkg/syscall/#Exec">syscall.Exec docs</a>. Lets have a look at the function signature, argument names and all:</p>

<pre><code>func Exec(argv0 string, argv []string, envv []string) (err error)
</code></pre>

<p>Hmm. The first argument is <code>argv0</code> (and a string), rather than <code>binaryPath</code> or something similar. The second argument is then <code>argv</code> and an array of strings.</p>

<p><em>At this point I remember that the first element of <code>argv</code> in other runtimes is the name of the binary or command invoked - <code>$0</code> in a bash script is the name of the script for example.</em></p>

<p>The answer is simple. <code>cmdArgs</code> in our script should have <code>/bin/echo</code> as the first element, and then we pass <code>cmdArgs[0], cmdArgs</code> as the first two arguments to <code>syscall.Exec</code>. Lets give that a go:</p>

<pre><code>func main() {
	cmdArgs := []string{"/bin/echo", "Hello", "World"}
	cmdEnv := []string{}

	err := syscall.Exec(cmdArgs[0], cmdArgs, cmdEnv)
	if err != nil {
		panic(err)
	}
}
</code></pre>

<p>And running it (<code>go run gecho.go</code> remember) gives the expected output:</p>

<pre><code>Hello World
</code></pre>

<p>Excellent. Now I just need to remember <code>argv</code> contains the command name as <code>argv[0]</code> and we're golden.</p>

<hr />

<p>There is also the <a href="http://golang.org/pkg/os/exec/">os/exec</a> package in the stdlib, which is intended for executing other binaries as child processes from what I can tell. Tellingly, when you create a <code>exec.Cmd</code> struct with <code>exec.Command()</code> you give it the name as first argument, and args as following arguments. Then it has the following snippet in the documentation:</p>

<blockquote>
  <p>The returned Cmd's Args field is constructed from the command name followed by the elements of arg, so arg should not include the command name itself. For example, <code>Command("echo", "hello")</code></p>
</blockquote>

<p>So <code>cmd := exec.Command("echo", "hello"); cmd.Args</code> would return <code>[]string{"echo", "hello"}</code> - which is recognisable as what we have to pass to <code>syscall.Exec</code>!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/go/">Go</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Example Article</h1>
    <time datetime="2015-01-01T00:00:00+00:00">2015-01-01 00:00:00</time>
  </header>

  <p>This is an example article. You probably want to delete it and write your own articles!</p>

<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/fred/">fred</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Changing hostname in SmartOS Zone</h1>
    <time datetime="2014-12-18T00:00:00+00:00">2014-12-18 00:00:00</time>
  </header>

  <p>Given a non-global zone in SmartOS that we want to change the hostname of, we need to make sure to edit the following files to change it:</p>

<ul>
  <li><code>/etc/hosts</code></li>
  <li><code>/etc/nodename</code></li>
</ul>

<p>A quick way to do that is with <code>sed</code> <em>(renaming "fred" to "beth" here)</em>:</p>

<pre><code>sed -e 's/fred/beth/g' -i /etc/hosts /etc/nodename
</code></pre>

<p>Then shutdown &amp; start the zone <em>(from my testing a restart doesn't apply it)</em>.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/smartos/">SmartOS</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Install Rubinius on OS X</h1>
    <time datetime="2014-11-05T12:50:16+00:00">2014-11-05 12:50:16</time>
  </header>

  <p>Using <a href="https://github.com/postmodern/ruby-install/">ruby-install</a>, <a href="http://brew.sh/">homebrew</a> building it for use with <a href="https://github.com/postmodern/chruby/">chruby</a>, here's how I install <a href="http://rubini.us/">Rubinius</a> under Yosemite (works for Mavericks as well.)</p>

<ol>
  <li>
    <p>Make sure llvm is installed</p>

    <pre><code> $ brew install llvm
</code></pre>
  </li>
  <li>
    <p>Prepend the homebrew-installed llvm tools to your path</p>

    <pre><code> $ export PATH="$(brew --prefix llvm)/bin:$PATH"

 # Or, for ZSH
 $ path=( $(brew --prefix llvm)/bin $path )
</code></pre>
  </li>
  <li>
    <p>Install rubinius, v2.3.0 at the time of writing</p>

    <pre><code> $ ruby-install rbx 2.3.0
</code></pre>
  </li>
  <li>
    <p>Open a fresh shell once that's built, and you should be able to switch to rbx!</p>

    <pre><code> $ chruby rbx
 $ ruby -v
 rubinius 2.3.0 (2.1.0 9d61df5d 2014-10-31 3.5.0 JI) [x86_64-darwin14.0.0]
</code></pre>
  </li>
</ol>

<hr />

<p><em>There is also a homebrew tap for rubinius which should also work instead of the above. I couldn't get it working on one of my laptops though, which is why I was installing by hand using the above instead. The tap is at <a href="https://github.com/rubinius/homebrew-apps/">https://github.com/rubinius/homebrew-apps/</a> and <a href="https://twitter.com/brixen/status/529725881498226688">https://twitter.com/brixen/status/529725881498226688</a> explains install steps.</em></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/install/">install</a>, <a href="/tag/os-x/">OS X</a>, <a href="/tag/rubinius/">Rubinius</a>, <a href="/tag/ruby/">Ruby</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Changing root password in global zone</h1>
    <time datetime="2014-10-19T17:44:20+00:00">2014-10-19 17:44:20</time>
  </header>

  <p>SmartOS mounts <code>/etc/shadow</code> from <code>/usbkey/shadow</code> so we can change the root password for the global zone after install. Here's how:</p>

<ol>
  <li>Fire up a console or ssh session as root in the global zone</li>
  <li>
    <p>Check the existing permissions on the file</p>

    <pre><code> $ ls -l /usbkey/shadow
 -r--------   1 root     root         560 Oct 19 16:45 /usbkey/shadow
</code></pre>
  </li>
  <li>
    <p>Make the file writable</p>

    <pre><code> $ chmod 600 /usbkey/shadow
</code></pre>
  </li>
  <li>
    <p>Fire up <code>vi</code> to edit the file</p>

    <pre><code> $ vi /usbkey/shadow
</code></pre>
  </li>
  <li>
    <p>Edit the line containing root to change the crypted password. See <a href="https://us-east.manta.joyent.com/smartosman/public/man4/shadow.4.html"><code>shadow(4)</code></a> if you need help with the format of <code>/etc/shadow</code> &amp; use <code>/usr/lib/cryptpass</code> to generate a hash for the password you desire. <em>(Remember to clean the bash history!)</em></p>
  </li>
  <li>
    <p>Save the file and exit <code>vi</code></p>
  </li>
  <li>
    <p>Make the file readonly again</p>

    <pre><code> $ chmod 400 /usbkey/shadow
</code></pre>
  </li>
  <li>
    <p>Double check permissions are correct on the file again</p>

    <pre><code> $ ls -l /usbkey/shadow
 -r--------   1 root     root         560 Oct 19 16:49 /usbkey/shadow
</code></pre>
  </li>
</ol>

<p>Job done. Verify by logging in as root (invoking <code>/usr/bin/login</code> from an ssh session makes this easy to verify.)</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/smartos/">SmartOS</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Compiling SmartOS for AMD processors</h1>
    <time datetime="2014-09-28T00:00:00+00:00">2014-09-28 00:00:00</time>
  </header>

  <p>There's a few community-provided patches for SmartOS that enable KVM on AMD processors amongst other things, and given the HP Microserver has an AMD processor, that's quite useful for turning it into a better lab server. The main <a href="http://imgapi.uqcloud.net/builds">list of so called "eait" builds</a> was hiccuping when I tried to download the latest, and all I could find was a 20140812T062241Z image <a href="http://builds.smartos.skylime.net">here</a>.</p>

<p>The source code for the eait builds is maintained at <a href="https://github.com/arekinath/smartos-live">https://github.com/arekinath/smartos-live</a>, and you can see the patches applied on top of the normal SmartOS master by going to <a href="https://github.com/arekinath/smartos-live/compare/joyent:master...eait">https://github.com/arekinath/smartos-live/compare/joyent:master...eait</a>.</p>

<p>So here's how to use SmartOS to compile a more up to date AMD-friendly Smartos!</p>

<ol>
  <li>
    <p>Grab the latest multiarch SmartOS image (which <strong>has</strong> to be used, or the compile will fail.) The latest at the time of writing was <code>4aec529c-55f9-11e3-868e-a37707fcbe86</code>, so that's what I'll use.</p>

    <pre><code> imgadm import 4aec529c-55f9-11e3-868e-a37707fcbe86
</code></pre>
  </li>
  <li>
    <p>Spin up a zone for us to build in (the <a href="http://wiki.smartos.org/display/DOC/Building+SmartOS+on+SmartOS">Building SmartOS on SmartOS</a> page has extra info about this):</p>

    <pre><code> echo '{
   "alias": "platform-builder",
   "brand": "joyent",
   "dataset_uuid": "4aec529c-55f9-11e3-868e-a37707fcbe86",
   "max_physical_memory": 32768,
   "quota": 0,
   "tmpfs": 8192,
   "fs_allowed": "ufs,pcfs,tmpfs",
   "maintain_resolvers": true,
   "resolvers": [
     "8.8.8.8",
     "8.8.4.4"
   ],
   "nics": [
     {
       "nic_tag": "admin",
       "ip": "dhcp",
       "primary": true
     }
   ],
   "internal_metadata": {
     "root_pw": "password",
     "admin_pw": "password"
   }
 }' | vmadm create
</code></pre>
  </li>
  <li>
    <p>Login to the created zone:</p>

    <pre><code> zlogin &lt;uuid from `vmadm create` output&gt;
</code></pre>
  </li>
  <li>
    <p>Update the image to the latest packages, etc:</p>

    <pre><code> pkgin -y update &amp;&amp; pkgin -y full-upgrade
</code></pre>
  </li>
  <li>
    <p>Install a few images we'll need to compile &amp; package SmartOS:</p>

    <pre><code> pkgin install scmgit cdrtools pbzip2
</code></pre>
  </li>
  <li>
    <p>Grab the source code of the fork containing the patches we want, from <a href="https://github.com/arekinath/smartos-live">arekinath/smartos-live</a></p>

    <pre><code> git clone https://github.com/arekinath/smartos-live
 cd smartos-live
</code></pre>
  </li>
  <li>
    <p><em>Optional</em>: Edit <code>src/Makefile.defs</code> and change <code>PARALLEL =      -j$(MAX_JOBS)</code> to <code>PARALLEL =      -j8</code> to do less at once. (Microserver only has a dual core CPU!)</p>
  </li>
  <li>
    <p>Copy the configure definition into the right place and start configuration:</p>

    <pre><code> cp {sample.,}configure.smartos
 ./configure
</code></pre>

    <p><em>(You'll probably get asked to accept the java license during configuration, so keep half an eye on it)</em></p>
  </li>
  <li>
    <p>Once configure has completed (which doesn't take <em>too</em> long, 15 minutes or so), start building:</p>

    <pre><code> gmake world &amp;&amp; gmake live
</code></pre>
  </li>
  <li>
    <p>Once the build is successfully finished, time to package an iso &amp; usb image:</p>

    <pre><code>export LC_ALL=C
tools/build_iso
tools/build_usb
</code></pre>
  </li>
</ol>

<p>Hey presto, you've a freshly built AMD-friendly SmartOS build to flash to a USB key / put on your netboot server and boot your Microserver from!</p>

<hr />

<p><strong>References</strong></p>

<ul>
  <li><a href="http://wiki.smartos.org/display/DOC/Building+SmartOS+on+SmartOS">http://wiki.smartos.org/display/DOC/Building+SmartOS+on+SmartOS</a></li>
  <li><a href="https://github.com/arekinath/smartos-live">https://github.com/arekinath/smartos-live</a></li>
</ul>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/smartos/">SmartOS</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/geek/">geek</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>The People's Triathlon 2014</h1>
    <time datetime="2014-08-11T00:00:00+00:00">2014-08-11 00:00:00</time>
  </header>

  <p>My first Olympic distance triathlon, and the first time I've ever run 10km to boot.</p>

<p><strong>1500m Open Water (Freshwater Lake) Swim: 00:38:08</strong></p>

<p>Equally happy and upset with my swim. Basically everything went well except my wetsuit, must get a proper swimming one (possibly sleeveless) before my next wetsuit event. Having to get out at the end of each lap and run down the bank to re-enter the water was a bit strange but not too bad. Worst bit of that was diving back in and forgetting to look down - goggles bruised the edge of my eyesocket!</p>

<p><strong>Transition 1: 00:03:53</strong></p>

<p>Took this at a sedate pace, didn't rush but didn't dawdle either. Perhaps could've gone a bit quicker but not unhappy with it. Found bike OK this time, although chain fell off as I went to mount which was slightly annoying.</p>

<p><strong>40km Cycle: 01:28:49</strong></p>

<p>Started off really badly, managed to knock my watch from cycle into Transition 2 before I'd gotten out the car park. Had to reset it quickly into just bike mode from multisport mode which wasn't too bad to be fair, just annoying. Having done the route in training was a <em>big</em> help on the day, I was aiming for about the time I did it in. Didn't push too hard on the two hills (one of which looks deceptively easy). Very happy with my time and more importantly how little effort it was comparatively.</p>

<p><strong>Transition 2: 00:01:28</strong></p>

<p>Quicker than T1, as normal. Got my shit on quickly, didn't forget anything and even managed to get my watch in run mode whilst jogging to the exit of the transition area.</p>

<p><strong>10km Run: 01:18:40</strong></p>

<p>The bit I was dreading the most. Very very happy with my performance here though. Walked about 90 seconds of the whole thing and kept plodding away the rest of the time. Given the furthest I'd run solidly in training was about 5.5km, I was exceptionally happy to just keep plodding the whole time. Managed to not take on liquid for the third lap, which lead to some impressive cramping in my right quad, so making sure I take liquid on is a definite thing to watch out for in future. And amazingly I wasn't even tail end charlie (not that it really matters, given I race the clock, not other people. But still.)</p>

<p><strong>Total: 03:30:51</strong></p>

<p>There's a tiny part of me that's gutted I didn't manage it in under 3:30 hours, but what's 51 seconds over that period of time. More importantly, I completed the bloody thing! Especially happy with the run, enjoyed the cycle even if it was trying to drown us (there was 6" deep standing water on one of the roundabouts by the end), and mostly happy with my swim.</p>

<p>Looking forward to returning next year and beating 3:30!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/triathlon/">triathlon</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Solve volume down button not working on iPhone 5</h1>
    <time datetime="2014-07-01T11:31:39+00:00">2014-07-01 11:31:39</time>
  </header>

  <p>I noticed this morning that my volume down button (-) wasn't working on my iPhone 5 running iOS 7. Pushing the physical button in didn't change the volume. The volume up button increased the volume successfully still.</p>

<p>As is my normal first step debugging iPhone weirdness, I rebooted the phone by turning it off, leaving it off for a few seconds, then booting it back up with the power button. Once powered off and on in this way, the volume down key still didn't decrease the volume.</p>

<p>Fearing a physical button issue at this point, I turned to google for suggestions on what else to try. Running across <a href="https://discussions.apple.com/thread/4894152">this thread</a> on Apple's discussion forums, I tried out the solution in there.</p>

<ol>
  <li>Open "Settings"</li>
  <li>Scroll down and tap on "General"</li>
  <li>Tap on "Accessibility"</li>
  <li>Scroll down to the bottom and tap on "AssistiveTouch"</li>
  <li>Tap the toggle for AssistiveTouch to turn it on, and you should see a little icon appear on screen (white circle contained in a dark grey rounded square)</li>
  <li>Tap the AssistiveTouch icon (was in the top left corner on screen for me)</li>
  <li>Tap on "Device"</li>
  <li>Tap "Volume Down" a bunch of times and you should see the volume being turned down</li>
  <li>Tap outside the AssistiveTouch dialog to close it</li>
  <li>Try pushing the physical Volume Down button</li>
</ol>

<p>In my case, following these steps made my physical volume down button start working again. Makes me wonder if the solution author on the apple discussion thread is right, in that this is a software issue and forcing a volume down action through the on-screen interface makes it remember that there's a physical button to respond to as well.</p>

<p>Either way, I can stop deafening myself whenever I receive a notification now!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/apple/">apple</a>, <a href="/tag/iphone/">iphone</a>, <a href="/tag/ios/">iOS</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Compile &amp; run swift files directly</h1>
    <time datetime="2014-06-06T14:32:18+00:00">2014-06-06 14:32:18</time>
  </header>

  <p>Turns out you can run a swift file without having to compile it into a binary somewhere and then run that binary. Makes swift behave a bit more like a scripting language like ruby or python when you need it to.</p>

<p>Using the <code>xcrun</code> binary, we can reach into the current Xcode <code>/bin</code> folder and run binaries within there. So <code>xcrun swift</code> lets you run the swift binary to compile files for instance. If you view the help with <code>-h</code>, there's a useful flag <code>-i</code> listed there:</p>

<blockquote>
  <p>-i               Immediate mode</p>
</blockquote>

<p>Turns out immediate mode means "compile &amp; run" in the same command, which is what we're after.</p>

<pre><code>    $ cat hello.swift
    println("Hello World")

    $ xcrun swift -i hello.swift
    Hello World
</code></pre>

<p>Bingo. But what if we want to make hello.swift executable and call it directly without having to know it needs the swift binary to call it. Unix lets files define their shebang to say how the file needs to be executed, so lets go for that here too!</p>

<pre><code>    $ cat hello2.swift
    #!/usr/bin/env xcrun swift -i
    
    println("Hello World 2")

    $ chmod +x hello2.swift
    $ ./hello2.swift
    Hello World 2
</code></pre>

<p>No more having to fire up Xcode for quick CLI tools, especially ones using the system frameworks!</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/apple/">apple</a>, <a href="/tag/swift/">swift</a>, <a href="/tag/unix/">unix</a>, <a href="/tag/shebang/">shebang</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Cheshire Triathlon 2014</h1>
    <time datetime="2014-06-02T00:00:00+00:00">2014-06-02 00:00:00</time>
  </header>

  <p>Successfully completed my second Sprint Triathlon of the season in Nantwich.</p>

<p><strong>500m Swim - 00:10:49</strong></p>

<p>Felt good swimming this. Mixed up my usual breaststroke with some front crawl to overtake and use my legs less towards the end. Think I need to put a shorter time down on paper next time though, was in with people who were swimming much slower than me. (Including one chap who was doing doggy paddle in the deep end and walking as soon as his feet touched bottom. Oh well!) Need to continue with front crawl practice, and aim to do next sprint tri entirely crawl.</p>

<p><strong>Transition 1 - 00:02:43</strong></p>

<p>Went well. Ran from pool to bike and felt OK. Kit on without any fuckups. Didn't fall off getting on bike. Winning. Need to practice getting on my bike in shoes at a run though.</p>

<p><strong>20km Bike - 00:42:31</strong></p>

<p>10 minutes quicker than same length course last year. (Although a slightly new route this year.) Lost a minute when my water bottle fell out about 12km in though. Barely saw a soul, got stuck at one pedestrian crossing on red. Felt very good on the bike (and finally beat Liam on the same route &amp; day  ). Need to fit a tighter bottle carrier to stop the bottle falling out on bumpy roads.</p>

<p><strong>Transition 2 - 00:01:21</strong></p>

<p>Came off bike well and ran to shoes. Couldn't find where I'd left them, was trying to find Liam's bike as my marker for it, only someone else earlier in the same row had the same bike as him! Wasted 10 seconds looking probably. Need to remember where my stuff is more accurately in future.</p>

<p><strong>5km Run - 00:39:03</strong></p>

<p>Boiling hot by the point I started running; didn't feel great in the first few hundred meters and never really got comfortable after that. Walked about 800m of it in total at a guess, really didn't have much left in my legs. Not convinced pushing less on the bike would've helped my run though. On the plus side, only 7 minutes slower than a training run a couple of weeks ago in similar heat, and this was on grass. Need to continue running at 5km distance, and train on grass as well as tarmac I think.</p>

<p><strong>Total time - 01:36:27</strong></p>

<p>8 minutes slower than York a couple of months ago, and felt <em>much</em> worse on the run. Very happy with my bike &amp; swim though. More run training required!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/triathlon/">triathlon</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>York April 2014 Triathlon</h1>
    <time datetime="2014-04-28T00:00:00+00:00">2014-04-28 00:00:00</time>
  </header>

  <p>Completed the York sprint distance tri in 1:28:37 total, and didn't die in the process. Split times &amp; my thoughts below..</p>

<p><strong>400m Swim: 00:08:08</strong><br />
<strong>T1: 00:03:47</strong><br />
<strong>18km Bike: 00:38:43</strong><br />
<strong>T2: 00:00:58</strong><br />
<strong>5km Run: 00:38:08</strong></p>

<p>(Amusingly the official time for my swim was 00:10:10, which then makes my official time for T1 00:00:38; Fastest Swim/Bike transition time in the tri on paper! Ahem.)</p>

<p>Happy with my swim, not much different from training speed &amp; felt good getting out the pool. T1 was okay, and I remembered to put my tshirt on before my helmet this time! Quite happy with my cycling, got down on the drop bars going downhill with tailwind, and could maintain 16mph uphill on the return leg, the bike itself had a major service 2 weeks ago and I'd not really ridden much since that either. Legs responded with life in them coming off the bike, second transition was quicker than expected (elastic laces win!). Moderately happy with the run, was hoping to do it in under 40 minutes (and did), but still felt like I had no more distance/pace left before halfway through. Pushed through to the end okay, and didn't walk at all. Overall very happy for my first sprint distance, and especially happy to be running 5km after swim/bike without walking.</p>

<p>First event of the season done. Main area to work on is my run, but that's been the case since last season. Winter running training seems to have paid off so far.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/triathlon/">triathlon</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Rename Google Drive folder on Mac</h1>
    <time datetime="2014-03-06T15:49:22+00:00">2014-03-06 15:49:22</time>
  </header>

  <ol>
  <li>Quit Google Drive app</li>
  <li>Rename "~/Google Drive/" to whatever you want</li>
  <li>Open Google Drive and wait for it to complain the folder is missing</li>
  <li>Click the menu item and click the warning item</li>
  <li>Click "Locate Folder.." button on the right in window that pops up</li>
  <li>Find your renamed folder and hit OK</li>
  <li>There is no step seven</li>
</ol>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/apple/">apple</a>, <a href="/tag/google-drive/">google drive</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Add to iCloud Reading List programmatically</h1>
    <time datetime="2013-12-16T22:26:31+00:00">2013-12-16 22:26:31</time>
  </header>

  <p>One piece of a larger puzzle I'm trying to solve currently, was how to add a given URL to my Apple "<a href="http://www.apple.com/uk/safari/#icloud">Reading List</a>" that is stored in iCloud and synced across all my OS X and iOS devices. More specifically, I wanted to add URLs to the list from my mac running Mavericks (10.9). I had a quick look at the Cocoa APIs and couldn't see anything in OS X to do this. (iOS has an API to do it from Cocoa-land it seems though.)</p>

<p>I figured <a href="http://www.apple.com/uk/safari/">Safari.app</a> was the key to getting this done on OS X, given it has the ability itself to add the current page to the reading list, either via a keyboard command, a menu item, or a button in the address bar. One quick mental leap later, and I was wondering if the engineers at Apple had been nice enough to expose that via Applescript for me to take advantage of.</p>

<p>One quick stop in "Script Editor.app" later, and I had the Applescript dictionary open for Safari.app. Lo and behold, there is rather handily an Applescript command called "add reading list item", which does <strong>exactly</strong> what I want. It has a few different options you can call it with, depending on whether you want Safari to go populate the title &amp; preview text, or if you want to specify it yourself at save-time.</p>

<p>As I want to be able to call this from multiple runtimes, I've chosen to save it as an executable, which leans on <a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/osascript.1.html"><code>osascript</code></a> to run the actual Applescript. And here it is:</p>

<pre><code>#!/usr/bin/env osascript

on run argv
    if (count of argv) &gt; 0
        tell app "Safari" to add reading list item (item 1 of argv as text)
    end if
end run
</code></pre>

<p>Save it as whatever you want (eg. <code>add_to_reading_list</code>), make it executable (<code>chmod +x add_to_reading_list</code>), and then run it with the URL you want saving as the first argument.</p>

<pre><code>$ add_to_reading_list "http://caius.name/"
$ add_to_reading_list "http://google.com/"
# … etc …
</code></pre>

<p><em>(Adding support for specifying preview text and title is left as an exercise for the reader!)</em></p>

<p>Have fun reading later!</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/safari/">safari</a>, <a href="/tag/instapaper/">instapaper</a>, <a href="/tag/applescript/">applescript</a>, <a href="/tag/osascript/">osascript</a>, <a href="/tag/reading-list/">reading list</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>North West Triathlon 2013</h1>
    <time datetime="2013-09-12T00:00:00+00:00">2013-09-12 00:00:00</time>
  </header>

  <p>"Fun" triathlon (super sprint distance) done in Nantwich. First ever Triathlon, 7 months after starting training properly.</p>

<p><strong>200m swim: 00:04:08</strong></p>

<p>Despite feeling like I was going super slow. Brine pool was fairly nice.</p>

<p><strong>20km bike: 00:52:31</strong></p>

<p>Pretty happy with that, strongest discipline for me anyway.</p>

<p><strong>2.5km run: 00:21:08</strong></p>

<p>Walked 2/3s of it at a guess. Really hate running, so happyish with this. Need to work on running over the winter.</p>

<p><strong>Total: 1h 17m 47s</strong></p>

<p>BOOYA. Enjoyable. Pretty damn happy with that (had a vague plan of being under 1h30m. So yay.)</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/triathlon/">triathlon</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Happy Villanelle</h1>
    <time datetime="2013-02-22T15:15:03+00:00">2013-02-22 15:15:03</time>
  </header>

  <p>The writing group that Carole and Liberty belong to had a homework this month to write a Villanelle. It's a very specific kind of poem, written to both a repeating line structure and a rhyming pattern. (If you go read <a href="http://libertyfallsdown.wordpress.com/2013/02/22/villanelle/">Liberty's villanelle</a> she explains it properly at the start.)</p>

<p>However, after reading both <a href="http://carolefindsherwings.wordpress.com/2013/02/23/ward-26-a-villanelle/">Carole's</a> and <a href="http://libertyfallsdown.wordpress.com/2013/02/22/villanelle/">Liberty's</a>, I was feeling they'd both done very depressing poems. It might be a strict structure of poem, but there's no need to make the subject matter so down!</p>

<p>So here's my overly enthusiastically attempt to try and balance the world of villanelle's into something less depressing!</p>

<blockquote>
  <p>Striding out down the street at last,<br />
Like I own this town,<br />
Tipping my hat to all that I passed.</p>

  <p>Smiling at a friendly chugger who asked,<br />
Grinning at an exuberant clown,<br />
Striding out down the street at last.</p>

  <p>Saluting the bookie behind his glass,<br />
Turning frowns upside down,<br />
Tipping my hat to all that I passed.</p>

  <p>Tapping my feet and having a blast,<br />
Abusing verbs like they were a noun,<br />
Striding out down the street at last.</p>

  <p>Being amused by kids playing on grass,<br />
Seeing the queen in her glorious crown,<br />
Tipping my hat to all that I passed.</p>

  <p>Compared to sadness I am a contrast,<br />
Cheering folk up in my dressing gown,<br />
Striding out down the street at last,<br />
Tipping my hat to all that I passed.</p>
</blockquote>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/poetry/">poetry</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Pair new device with Nexxus Drive Transmit Pro</h1>
    <time datetime="2013-02-12T18:26:59+00:00">2013-02-12 18:26:59</time>
  </header>

  <p>The device is a bluetooth to FM transmitter with Model number NEX-FMTX-BTCK. (Hereafter DTP.)</p>

<p>The set of instructions I use to pair it to a new device, having lost the user manual/instruction booklet, is as follows:</p>

<ol>
  <li>Remove all previously paired devices from range (turn them off/move them away from the DTP.)</li>
  <li>Turn the power on to the DTP without touching any buttons.</li>
  <li>Let it flash the blue call button a couple of times as it searches for known devices.</li>
  <li>Hold the call button down until the call/hangup buttons flash blue/red respectively.</li>
  <li>Find the "Drive Transmit Pro" on your device you want paired to it and pair with DTP.</li>
  <li>Test out the pairing by calling your girlfriend and talking to her in a funny accent.</li>
  <li>Celebrate with a beer!</li>
</ol>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/fix/">fix</a>, <a href="/tag/iphone/">iphone</a>, <a href="/tag/nexxus/">nexxus</a>, <a href="/tag/drivetransmit-pro/">drivetransmit pro</a>, <a href="/tag/nex-fmtx-btck/">NEX-FMTX-BTCK</a>, <a href="/tag/bluetooth/">bluetooth</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Church intertwined with State</h1>
    <time datetime="2013-02-05T23:06:18+00:00">2013-02-05 23:06:18</time>
  </header>

  <p>In the UK currently we're moving (slowly) toward the <a href="http://www.publications.parliament.uk/pa/bills/cbill/2012-2013/0126/cbill_2012-20130126_en_1.htm">same sex marriage bill</a> making it's way into law. (It's got a way to go still, but support seems to be there now at least.)</p>

<p>For the record, I'm glad to see the state moving toward allowing two people to be united under law, irrespective of terminology used - and with equal rights to those currently enjoyed by the uniting of a man &amp; woman to date. But for a while now I've been thinking that the discussion is presented in an unclear fashion, which causes people to jump to polarising positions on it, without any common ground.</p>

<p>The way I see it is the UK has been a country with Religion and State intertwined for many, many hundreds of years - and therefore we have some constructs that exist both in law, and religion, but are conflated under one word and changing one appears to be changing them both.</p>

<p>The Church of England is Protestant, because Henry VIII wanted to get a divorce and the Catholics wouldn't allow him that, so we as a country "forked" our own religion that wasn't so different, but allowed divorce of marriage. Times were slightly different back then, the church had a lot more direct power in terms of laws &amp; how people lived. We're a more diverse society today, and the church has less (direct?) involvement in our laws, although older laws are still based upon that original conflation of state and church.</p>

<p>I almost wonder if in this case (and others) we need to start diverging church from state and allowing the state to change things irrespective of the church, whilst still allowing the church to continue unhindered with practices it's held for many years. Seems like the best of both worlds almost - in law we are a very generic and equal society, and if you wish to belong to or align with a group that has more specific beliefs, then that is open to you as well.</p>

<p>Lets jump back to gay marriage here as an example then. If we define state marriage to be "the unity of two human beings, irrespective of their attributes", then everyone is equal to join with a partner in the eyes of the law, and all such partnerships are afforded the lawful benefits that come with that unity. The church (and indeed, all religions) are also then free to define religious marriage in their doctrine as they wish, so they can say that for them it's only permissible between a man and a woman. And if you wish to join with a partner following that doctrine, then you have to meet their rules.</p>

<p>In this circumstance, I wonder how much of it is a hangup on the word "marriage". I can see how the state wants to keep hold of it to describe partnerships between two people, and also that religions want to keep hold of it as they've been using it for years and neither wish to yield the word for the other to use. Which possibly means people think solely of this issue as just being an intertwined construct between state and religion, and not as the state giving everyone equality being a separate issue.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/musings/">musings</a>, <a href="/tag/religion/">religion</a>, <a href="/tag/state/">state</a>, <a href="/tag/marriage/">marriage</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>evil.rb</h1>
    <time datetime="2013-01-23T11:07:43+00:00">2013-01-23 11:07:43</time>
  </header>

  <p>Here be hax. Don't <strong>ever</strong> do these. ;-)</p>

<h2 id="reduce-local-variables-with-instanceeval">Reduce local variables with instance_eval</h2>

<p>Sometimes (usually in a one-liner) I want to do some work with a value without assigning it to a variable. Chucking an <code>#instance_eval</code> call in there will set <code>self</code> to the value, which saves having to assign it to a local value. Pretty much only used by me in one-off scripts or cli commands.</p>

<h4 id="good">Good</h4>

<pre><code>start_date, end_date = ["24 Dec 2011", "23 Jan 2013"].map {|d| Date.parse(d) }
puts "#{start_date} to #{end_date} is #{(end_date - start_date).to_i} days"
</code></pre>

<h4 id="bad">Bad</h4>

<pre><code>puts ["24 Dec 2011", "23 Jan 2013"].map {|d| Date.parse(d) }
  .instance_eval { "#{first} to #{last} is #{(last - first).to_i} days" }
</code></pre>

<p>See, way less code! <em>cough, cough</em></p>

<h3 id="bonus-usage-misdirection">Bonus usage: Misdirection</h3>

<p>I also dropped some instance_eval on our campfire bot at <a href="https://emberads.com/">EmberAds</a> to always blame one person, but without the code reading as such.</p>

<pre><code>%w{Dom Mel Caius CBetta Baz}.sample.instance_eval { "(4V5A8F5T=&amp;$`".unpack("u")[0] }
</code></pre>

<p>That does not return one of the array elements as you might think it does from quickly scanning the code…</p>

<h2 id="set-method-local-variables-in-default-arguments">Set method-local variables in default arguments</h2>

<p>You have a method and it takes one argument, which has a default value of <code>nil</code> specified. You then run into the situation where you need to know if <code>nil</code> was passed to the method, or if you're getting the default value of <code>nil</code>. You could change the default value to something you choose to be the "default value" and unlikely to be passed from elsewhere as the argument's value, and reset the parameter to <code>nil</code> after checking it, like this:</p>

<pre><code>def output name=:default_value
  if name == :default_value
    name = "caius"
    default = true
  end

  "name: #{name.inspect} -- default: #{default.inspect}"
end

output() # =&gt; "name: \"caius\" -- default: true"
output("fred") # =&gt; "name: \"fred\" -- default: nil"
</code></pre>

<p>That's quite a lot of code added to the method just to find out if we passed a default value or not. And if we forget to reset the value when it's <code>:default_value</code> then we end up leaking that into whatever the method does with that value. We also have the problem that one day the program <em>could</em> possibly send that "default value" we've chosen as the actual parameter, and we'd blindly change it thinking it was set as the default value, not the passed argument.</p>

<p>Instead we could (ab)use the power of ruby, and have ruby decide to set <code>default = true</code> for us when, and only when, the variable is set <em>to</em> the default value.</p>

<pre><code>def output name=((default=true); "caius")
  "name: #{name.inspect} -- default: #{default.inspect}"
end

output() # =&gt; "name: \"caius\" -- default: true"
output("fred") # =&gt; "name: \"fred\" -- default: nil"
</code></pre>

<p>As you can see, the output is identical. Yet we have no extra code <em>inside</em> the method to figure out if we were given the default value or not. And as a bonus to that, we no longer have to check for a specific value being passed and presume that is actually the default, and not one passed by the program elsewhere.</p>

<p>I posted this one in <a href="https://gist.github.com/1528785">a gist</a> a while back (to show <a href="http://avdi.org/">Avdi</a> it looks like), and people came up with some more insane things to do with it, including <a href="https://gist.github.com/1528785#comment-71861">returning early</a>, <a href="https://gist.github.com/1528785#comment-71862">raising errors</a> or even <a href="https://gist.github.com/1528785#comment-71876">redefining the current method</a>, all from the argument list! I'd suggest going to read them, it's a mixture of OMG HAHA and OMFG NO WAY WHYY?!?!.</p>

<h3 id="dont-do-this">Don't do this.</h3>

<p>Don't do the above. No really, don't do them. Unless you're writing a one-off thing. But seriously, don't do them. :-D</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/funny/">funny</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/hax/">hax</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Some Small Refactorings in Ruby</h1>
    <time datetime="2013-01-16T12:23:54+00:00">2013-01-16 12:23:54</time>
  </header>

  <p>Here's a few things I refactor as I write code down initially. Not entirely convinced it's strictly refactoring, but it's how I amend from one pattern I see in a line or three of code into a different structure that I feel achieves the same result with cleaner or more concise code.</p>

<h3 id="multiple-equality-comparisons">Multiple equality comparisons</h3>

<p>Testing the equality of an object against another is fairly simple, just do <code>foo == "bar"</code>. However, I usually try to test against multiple objects in a slightly different way. Your first thought might be that the easiest way is just to chain a series of <code>==</code> with the OR (<code>||</code>) operator.</p>

<pre><code>foo == "bar" || foo == "baz" || foo == :sed || foo == 5
</code></pre>

<p>I much prefer to flip it around, think of the objects I'm testing against as a collection (<code>Array</code>), and then ask them if they contain the object I'm checking. And for that, I use <code>Array#include?</code></p>

<pre><code>    ["bar", "baz", :sed, 5].include?(foo)
</code></pre>

<p><em>(And if you're only testing against strings, you could use <code>%w(bar baz)</code> as a shortcut to create the array. Here's more <a href="http://caiustheory.com/ruby-shortcuts">ruby shortcuts</a>.)</em></p>

<h3 id="assigning-multiple-items-from-a-nested-hash-to-variables">Assigning multiple items from a nested hash to variables</h3>

<p>Occasionally I find myself needing to be given a hash of a hash of data (most recently, an <a href="https://github.com/intridea/omniauth/wiki">omniauth</a> auth hash) and assign some values from it to separate variables within my code. Given the following hash, containing a nested hash:</p>

<pre><code>details = {
  uid: "12345",
  info: {
    name: "Caius Durling",
    nickname: "caius",
  },
}
</code></pre>

<p>Lets say we want to extract the name and nickname fields from <code>details[:info]</code> hash into their own local variables (or instance variables within a class, more likely.) We should probably handle the case of <code>details[:info]</code> not being a hash, and try not to read from it if that's the case - so we might end up with something like the following:</p>

<pre><code>name = details[:info] &amp;&amp; details[:info][:name]
nickname = details[:info] &amp;&amp; details[:info][:nickname]

name # =&gt; "Caius Durling"
nickname # =&gt; "caius"
</code></pre>

<p>And then in the spirit of <a href="http://en.wikipedia.org/wiki/Don't_repeat_yourself">DRYing</a> up our code, we see there's duplication in both lines in checking <code>details[:info]</code> exists (not actually that it's a hash, but hey ho, we rely on upstream to send us <code>nil</code> or a hash.) So we reduce it down using an if statement and give ourselves slightly less to type at the same time.</p>

<pre><code>if (( info = details[:info] ))
  name = info[:name]
  nickname = info[:nickname]
end

name # =&gt; "Caius Durling"
nickname # =&gt; "caius"
</code></pre>

<h3 id="returning-two-values-conditionally">Returning two values conditionally</h3>

<p>Sometimes a method will end with a ternary, where depending on a condition it'll either return one or another value. If this conditional returns true, then the first value is returned. Otherwise it returns the second value. You could quite easily write it out as an if/else longer-form block too.</p>

<pre><code>def my_method
  @blah == foo ? :foo_matches : :no_match
end
</code></pre>

<p>My brain finds picking the logic in this apart slightly harder mentally, than if I drop a <a href="http://en.wikipedia.org/wiki/Return_early">return early</a> bomb on the method. Then it reads more akin to how I'd think through the logic. Return the first value if this conditional returns true. Otherwise the method returns this second value. I think the second value being on a completely separate line helps me make this mental distinction quicker too.</p>

<p>So I'd write it this way:</p>

<pre><code>def my_method
  return :foo_matches if @blah == foo
  :no_match
end
</code></pre>

<h3 id="returning-nil-or-a-value-conditionally">Returning nil or a value conditionally</h3>

<p>Following on from the last snippet, but taking advantage of the ruby runtime a bit more, is when you're wanting to return a value if a conditional is true, or otherwise false. The easy way is to just write <code>nil</code> in the ternary:</p>

<pre><code>def my_method
  @foo == :bar ? :foo_matches : nil
end
</code></pre>

<p>However, we know ruby returns the result of the last expression in the method. And that if a single line conditional isn't met, it returns nil from the expression. Combining that, we can rewrite the previous example into this:</p>

<pre><code>def my_method
  :foo_matches if @foo == :bar
end
</code></pre>

<p>And it will still return nil in the case that <code>@foo</code> doesn't match <code>:bar</code>.</p>

<h3 id="returning-a-boolean">Returning a boolean</h3>

<p>Sometimes you have a method that returns the result of a conditional, but it's written to return true/false in a conditional instead.</p>

<p><code>
def my_method
  @foo == :bar ? true : false
end
</code></p>

<p>The really easy refactor here is to just remove the ternary and leave the conditional.</p>

<p><code>
def my_method
  @foo == :bar
end
</code></p>

<p>And of course if you were returning <code>false</code> when the conditional evaluates to <code>true</code>, you can either negate the comparison (use <code>!=</code> in that example), or negate the entire conditional result by prepending <code>!</code> to the line.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Why I love DATA</h1>
    <time datetime="2013-01-08T19:09:42+00:00">2013-01-08 19:09:42</time>
  </header>

  <p>In a ruby script, there's a keyword <code>__END__</code> that for a long time I thought just marked anything after it as a comment. So I used to use it to store snippets and notes about the script that weren't really needed inline. Then one day I stumbled across the <code>DATA</code> constant, and wondered what flaming magic it was.</p>

<p><code>DATA</code> is in fact an IO object, that you can read from (or anything else you'd do with an IO object). It contains all the content after <code>__END__</code> in that ruby script file<a href="#fn1">*</a>. (It only exists when the file contains <code>__END__</code>, and for the first file ruby invokes though. See <a href="#fn1">footnote</a> for more details.)</p>

<p>How can we use this, and why indeed do I love this fickle constant? I mostly use it for quick scripts where I need to process text data, rather than piping to STDIN.</p>

<p>Given a list of URLs that I want to open in my web browser and look at, I could do the following for instance:</p>

<pre><code>DATA.each_line.map(&amp;:chomp).each do |url|
  `open "#{url}"`
end

__END__
http://google.com/
http://yahoo.com/
</code></pre>

<p>which upon running (on a mac) would open all the URLs listed in DATA in my default web browser. (For bonus points, use <a href="https://github.com/copiousfreetime/launchy#readme">Launchy</a> for cross-platform compatibility.) Really handy &amp; quick/simple when you've got 500+ URLs to open at once to go through. (I once had a job that required me to do this daily. Fun.)</p>

<p>Or given a bunch of CSV data that you just want one column for, you could reach for <code>cut</code> or <code>awk</code> in the terminal, but ruby has a really good CSV library which I trust and know how to use already. Why not just use that &amp; <code>DATA</code> to pull out the field you want?</p>

<pre><code>require "csv"

CSV.parse(DATA, headers: true).each do |row|
  puts row["kName"]
end

__END__
kId,kName,kURL
1,Google UK,http://google.co.uk
2,"Yahoo, UK",http://yahoo.co.uk

# &gt;&gt; Google UK
# &gt;&gt; Yahoo, UK
</code></pre>

<p>I find when the data I want to munge is already in my clipboard, and I can run ruby scripts directly from text editors without having to save a file, it saves having to write the data out to a file, have ruby read it back in, etc just to do something with the data. I can just write the script reading from <code>DATA</code>, paste the data in and run it. Which also lets me run it iteratively and build up a slightly more complex script that I don't want to keep. Then do what I need with the output and close the file without saving it.</p>

<p><span id="fn1">*</span> technically DATA is an IO handler to read <code>__FILE__</code>, which has been wound forward to the start of the first line after <code>__END__</code> in the file. And it only exists for the first ruby file to be invoked by the interpreter.</p>

<pre><code>$ cat &gt; tmp/data.rb &lt;&lt;RB
p DATA.read
__END__
data.rb
RB

$ ruby tmp/data.rb
"data.rb\n"

$ cat &gt; tmp/data-require.rb &lt;&lt;RB
require "./tmp/data"
RB

$ ruby tmp/data-require.rb
/Users/caius/tmp/data.rb:1:in `&lt;top (required)&gt;': uninitialized constant DATA (NameError)
</code></pre>

<p>And because it's a handle to <code>__FILE__</code> though, you can rewind it and read the entire ruby script into itself…</p>

<pre><code>$ ruby tmp/readself.rb 
DATA.rewind
print DATA.read

__END__
something goes here
</code></pre>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/mac/">mac</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Geolocation in nginx</h1>
    <time datetime="2012-12-04T09:42:00+00:00">2012-12-04 09:42:00</time>
  </header>

  <p>Sometimes you need to have a rough idea of where your website visitor is located. There's many ways to geolocate them, but if you just want to go to country level then <a href="http://dev.maxmind.com/geoip/geolite">MaxMind have free geo databases</a> available to help you. When we needed to do this quickly on-the-fly at EmberAds, we came up with the <a href="https://github.com/emberads/trifle#readme">trifle</a> gem, which supports ipv4 and ipv6 lookups.</p>

<p>Recently I was searching for something else to do with nginx and ran across <a href="http://www.ruby-forum.com/topic/125810">a mailing list thread</a> about using the maxmind database with nginx's <a href="http://wiki.nginx.org/NginxHttpGeoModule">HTTP Geo module</a> and do the lookup directly in nginx itself. Finally got a chance to sit down and work out the logistics of doing this. I've done this on an ubuntu 12.04 box, with the expected config file layouts that come with ubuntu.</p>

<p>Run the following on your server (as someone with write access to nginx config files):</p>

<pre><code># Generate the text file for nginx to import
perl &lt;(curl -s https://raw.github.com/nginx/nginx/master/contrib/geo2nginx.pl) &lt; &lt;(zip=$(tempfile) &amp;&amp; curl -s -o $zip http://geolite.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip &amp;&amp; unzip -p $zip) &gt; /etc/nginx/nginx_ip_country.txt

# Tell nginx to work out the IP country and store in variable
echo 'geo $IP_COUNTRY {
  default --;
  include /etc/nginx/nginx_ip_country.txt;
}' &gt; /etc/nginx/conf.d/ip_country.conf
</code></pre>

<p>Now go find the http block for the vhost you want to have the header passed to, and assuming it's passenger, add the following:</p>

<pre><code># http {
  # server_name freddy.com;
  passenger_set_cgi_param HTTP_X_IP_COUNTRY $IP_COUNTRY;
# }
</code></pre>

<p>(If you don't use passenger, look at the docs for <a href="http://wiki.nginx.org/HttpProxyModule#proxy_pass_header">proxy_pass_header</a> or <a href="http://wiki.nginx.org/HttpFastcgiModule#fastcgi_pass_header">fastcgi_pass_header</a> to see which you'll require for your setup.)</p>

<p>Reload nginx, and behold, <code>request.env["HTTP_X_IP_COUNTRY"]</code> (assuming a rack app running under ruby) will be a two letter country code, or <code>"--"</code>.</p>

<p>Unfortunately this is IPv4 only currently, there's a <a href="http://forum.nginx.org/read.php?29,232648">thread on the nginx mailing list from November 2012</a> saying IPv6 support should be coming on the v1.3 branch of nginx, but with no known ETA. So currently for IPv6 support, take a look at <a href="https://github.com/emberads/trifle#readme">EmberAds' trifle gem</a> instead.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/ubuntu/">ubuntu</a>, <a href="/tag/deployment/">deployment</a>, <a href="/tag/terminal/">terminal</a>, <a href="/tag/linux/">linux</a>, <a href="/tag/geolocation/">geolocation</a>, <a href="/tag/nginx/">nginx</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Mounting Harman Kardon Soundsticks on the wall</h1>
    <time datetime="2012-11-06T20:46:45+00:00">2012-11-06 20:46:45</time>
  </header>

  <p>Having recently moved my Soundstick III's into the front room, I've been thinking of a way to wall mount them safely to free up table room. Googling eventually turned up just one person who has previously documented <a href="http://www.thanatopsic.org/hendrik/article/102/hot-hotdesking-action">mounting his soundsticks</a> on the wall, using 22mm plumbing clips (intended for 22mm central heating pipes).</p>

<p>A quick scrounge round the local Homebase this afternoon yielded a pack of similar clips, 5x 22mm push clips for £1.99. Having just fitted the speakers to the wall, they're nice and secure (providing no-one hangs on them, which they shouldn't do), fairly neat and simple to fit.</p>

<p>I've left the subwoofer on the floor under the table, and only mounted the "sticks" (tweeters) on the wall, one each side of the mirror over our dining table. I can then conveniently run the cables to the "sticks" behind the mirror and keep it looking neater.</p>

<p>I affixed the clips to the wall, one either side of the mirror with enough space for the speaker to sit without overlapping the mirror. Mostly just held the stick up and guessed at where to put the clip, but it looks ok.</p>

<p><a href="http://caius.name/images/wallmount-soundstick-2.jpg">
  <img src="http://caius.name/images/wallmount-soundstick-2.jpg" alt="Speaker clip without speaker in it" width="320" />
</a></p>

<p>Then I bent the speaker stand backwards behind the stick (don't worry, it's on a hinge!) and threaded the cable through the middle of the ring to make it sit flusher against the wall.</p>

<p><a href="http://caius.name/images/wallmount-soundstick-1.jpg">
  <img src="http://caius.name/images/wallmount-soundstick-1.jpg" alt="Speaker ring bent behind the unit" height="320" />
</a></p>

<p>And then it was just a case of easing the speaker ring into the clip, with the clip at the top of the ring (picture below if you can't visualise that easily). I think the rings are more like 24-25mm so it takes a bit of easing to get them in there. Once it's in there's no play in the clip for it to wiggle out though, even though it's plastic. I tried not to fatigue the clip arms too much wiggling it in there as well, so as to minimise the chance of it failing over time. (Something to check periodically!)</p>

<p><a href="http://caius.name/images/wallmount-soundstick-4.jpg">
  <img src="http://caius.name/images/wallmount-soundstick-4.jpg" alt="Close up of speaker unit in clip" height="320" />
</a></p>

<p>Lastly, I just zip tied the cables together behind the mirror, and ran them down vertically from the middle to the floor and plugged them in. Sounds fantastic, and due to being plugged into an <a href="http://www.apple.com/airportexpress/">Airport Express</a>, anything compatible can stream audio through them wirelessly. Fabulous darling!</p>

<p><a href="http://caius.name/images/wallmount-soundstick-3.jpg">
  <img src="http://caius.name/images/wallmount-soundstick-3.jpg" width="320" />
</a></p>

<p><em>(Click any image for a larger version)</em></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/hack/">hack</a>, <a href="/tag/diy/">diy</a>, <a href="/tag/soundsticks/">soundsticks</a>, <a href="/tag/wall-mount/">wall mount</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Musical Quiz</h1>
    <time datetime="2012-10-10T14:11:41+00:00">2012-10-10 14:11:41</time>
  </header>

  <p>Using only song titles from ONE ARTIST, cleverly answer these questions. Try not to repeat a song title. It’s harder than you think.</p>

<dl>
  <dt>Pick Your Artist:</dt>
  <dd>Alanis Morissette</dd>

  <dt>Describe yourself:</dt>
  <dd>So-Called Chaos</dd>

  <dt>If you could go anywhere, where would you go?:</dt>
  <dd>edge of evolution</dd>

  <dt>Your favourite form of transportation:</dt>
  <dd>Head over Feet</dd>

  <dt>Your best friend is:</dt>
  <dd>Ironic</dd>

  <dt>What’s the weather like?:</dt>
  <dd>Limbo no More</dd>

  <dt>If your life was a TV show, what would it be called?:</dt>
  <dd>Citizen of the Planet</dd>

  <dt>What is life to you?:</dt>
  <dd>Madness</dd>

  <dt>What is the best advice you have to give?:</dt>
  <dd>You Learn</dd>

  <dt>If you could change your name, what would it be?:</dt>
  <dd>Not The Doctor</dd>

  <dt>Your favourite food is:</dt>
  <dd>Utopia</dd>

  <dt>Thought for the Day:</dt>
  <dd>Giggling Again For No Reason</dd>

  <dt>How would you like to die?</dt>
  <dd>havoc</dd>

  <dt>Your motto:</dt>
  <dd>Incomplete</dd>
</dl>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/music/">Music</a>, <a href="/tag/alanis-morissette/">Alanis Morissette</a>, <a href="/tag/quiz/">Quiz</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Human Affliction</h1>
    <time datetime="2012-04-09T14:04:32+00:00">2012-04-09 14:04:32</time>
  </header>

  <p>That damned human affliction,<br />
Missing someone like an addiction,<br />
The cure's quite simple,<br />
Like bursting a pimple,<br />
Hug them, hold them, repetition.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/poetry/">poetry</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Where did life go?</h1>
    <time datetime="2012-03-30T16:33:51+00:00">2012-03-30 16:33:51</time>
  </header>

  <p>Into the past,<br />
with our regrets and tears,<br />
and our successes and cheers.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/poetry/">poetry</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>diff in shell</h1>
    <time datetime="2012-03-10T14:11:34+00:00">2012-03-10 14:11:34</time>
  </header>

  <h1 id="diff-muninpassengerstatus-sed--re-susrbinenv-rubyoptruby193-p0binruby-muninpassengerstatus">diff munin_passenger_status &lt;(sed -re 's@#!/usr/bin/env ruby@#!/opt/ruby1.9.3-p0/bin/ruby@' munin_passenger_status)</h1>
<p>1c1
&lt; #!/usr/bin/env ruby
—
&gt; #!/opt/ruby1.9.3-p0/bin/ruby</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> 
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Install capybara-webkit gem on Ubuntu</h1>
    <time datetime="2012-03-01T11:01:34+00:00">2012-03-01 11:01:34</time>
  </header>

  <p>Dear future Caius searching for this issue,</p>

<p>The apt package you need to install to use the capybara-webkit rubygem on ubuntu (tested on 10.04 and 11.10) is <code>libqt4-dev</code>. That is, to <code>gem install capybara-webkit</code>, you need to run <code>aptitude install libqt4-dev</code>.</p>

<p>Yours helpfully,<br />
Past Caius</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/gem/">gem</a>, <a href="/tag/rubygems/">rubygems</a>, <a href="/tag/ubuntu/">ubuntu</a>, <a href="/tag/installing/">installing</a>, <a href="/tag/deployment/">deployment</a>, <a href="/tag/webkit/">webkit</a>, <a href="/tag/aptitude/">aptitude</a>, <a href="/tag/apt-get/">apt-get</a>, <a href="/tag/linux/">linux</a>, <a href="/tag/capybara/">capybara</a>, <a href="/tag/capybara-webkit/">capybara-webkit</a>, <a href="/tag/install/">install</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Use Readline With Default Ruby on OS X</h1>
    <time datetime="2012-02-05T18:13:20+00:00">2012-02-05 18:13:20</time>
  </header>

  <p>OS X Lion comes with ruby 1.8.7-p249 installed, although it's compiled against libedit rather than libreadline. Whilst libedit is a mostly-compatible replacement for libreadline, I find there's a couple of settings I'm used to that don't work in libedit. (Like <code>history-beginning-search-backward</code>.)</p>

<p>Luckily you can grab the source of ruby and compile just the readline extension, and move it into the right place for it to just work. Here's what's been working for me:</p>

<pre><code># Install readline using homebrew
$ brew install readline

# Download the ruby source and check out 1.8.7-p249
$ mkdir ~/tmp &amp;&amp; cd ~/tmp
$ git clone git://github.com/ruby/ruby
$ cd ruby
$ git checkout v1_8_7_249
$ cd ext/readline
$ ruby extconf.rb --with-readline-dir=$(brew --prefix readline) --disable-libedit
$ make
</code></pre>

<p>Now you should have <code>readline.bundle</code> in the current directory, and it should be compiled against your homebrew-installed readline library, rather than libedit that comes with the system. We can quickly double-check that by using <code>otool</code> to check what the binary is linked against.</p>

<pre><code>$ otool -L readline.bundle
readline.bundle:
    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/libruby.1.dylib (compatibility version 1.8.0, current version 1.8.7)
    /usr/local/Cellar/readline/6.2.2/lib/libreadline.6.2.dylib (compatibility version 6.0.0, current version 6.2.0)
    /usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 159.1.0)
</code></pre>

<p>And in the output you should see a line listing "libreadline", and no lines listing "libedit". Which that shows, we've compiled it properly then. Now the bundle is built we need to move it into the right place so it's loaded when ruby is invoked.</p>

<pre><code>$ RL_PATH="/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin11.0"
# Back up the original bundle, just in cases
$ sudo mv "$RL_PATH/readline.bundle" "$RL_PATH/readline.bundle.libedit"
$ sudo mv readline.bundle "$RL_PATH/readline.bundle"
</code></pre>

<p>And that's it. You've got a proper compiled-against-readline installed ruby 1.8.7-p249 on 10.7 now.</p>

<p>One gotcha I ran into was needing to pass the same arguments to rvm when installing any other version of 1.8.7 on the same machine. Simple enough, just need to remember to do it though.</p>

<pre><code>$ CC=gcc-4.2 rvm install 1.8.7-p357 -C --with-readline-dir=$(brew --prefix readline) --disable-libedit
</code></pre>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/installing/">installing</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/terminal/">terminal</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>End Of An Era</h1>
    <time datetime="2012-01-12T15:30:00+00:00">2012-01-12 15:30:00</time>
  </header>

  <p>I remember watching <a href="http://www.youtube.com/watch?v=UF8uR6Z6KLc">Steve Jobs' commencement speech</a> for the first time and being fairly touched by the three stories he told in it. The major one that resonated with me at the time, and has since made more sense to me, is the first story he tells about joining the dots later on when you're looking backwards. To quote from it:</p>

<blockquote>
  <p>Of course, it was impossible to connect the dots looking forward when I was in college. But it was very very clear looking backwards ten years later. Again, you can't connect the dots looking forward, you can only connect them looking backwards. So you have to trust that the dots will somehow connect in your future.</p>
</blockquote>

<p>It made me think back to a time when I was a teenager and someone far older and wiser than me told me one way to think about the future and how what we do today affects where we end up. He described it as holding a piece of string in your hand, with the other end dangling free. The end of the string not attached to you is the future, and where you're holding it is the present. As you do things in life your hand moves around, flicking the string around and amplifying the movements of the present in the future.</p>

<p>I think what he was trying to impart by telling me that story was to be careful not to do anything too extravagant in the present (like get expelled from school for instance), so as not to affect the future too much. Which I never really took on board at the time, but now I look back at the dots of my (some would say) rather short life so far, and connect them to see how some things influenced other things and how everything works out in the end. But that sometimes you need to push yourself or do something unexpected to get there.</p>

<h3 id="looking-backwards-to-go-forward">Looking Backwards to go Forward</h3>

<p>When I look back over the last few years of my life, I find the dots quite amazing to connect. First there was BarCamp Sheffield 2007 where I met <a href="http://www.thehodge.co.uk/">Dom</a>, and there was Twitter and BarCamp Manchester &amp; Leeds where I met geeks like <a href="http://www.3hv.co.uk/">Rahoul</a>, <a href="http://johnleach.co.uk/">John</a> and <a href="http://brightbox.co.uk/">Jeremy</a> both online and offline. And then in June 2008 I moved to Leeds, sharing a house with Dom and quite quickly ended up being hired into what was basically my dream first job at <a href="http://www.brightbox.com/">Brightbox</a>.</p>

<p>And that's where I've been working for the last 1198 days, having far too much fun, solving weird, wonderful and sometimes downright frustrating problems, all with fantastically awesome and hilarious colleagues. And working on a massive variety of things, from <a href="https://github.com/brightbox/rujitsu/">tiny utilities</a> to the newly launched <a href="http://www.brightbox.com/">Cloud Platform</a>.</p>

<p>And today I flick my wrist ever so slightly more than normal by leaving Brightbox, without really knowing where the future end of the string will eventually end up, but knowing that I'll look back in a few years and see dots connected that I can't imagine today. I truly don't think I could have had a better job to start off as a professional geek, and especially want to thank <a href="http://johnleach.co.uk/">John</a> and <a href="http://brightbox.co.uk/">Jeremy</a> for hiring me and helping me start my career in the best way possible.</p>

<p>As for my next challenge, I'm solving interesting problems in the online advertising world with <a href="http://cristianobetta.com/">Cristiano</a>, <a href="http://www.thehodge.co.uk/">Dom</a>, <a href="http://missgeeky.com/">Melinda</a> and <a href="http://www.3hv.co.uk/">Rahoul</a>. And we're bloody amazing together. :-)</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/leeds/">leeds</a>, <a href="/tag/brightbox/">brightbox</a>, <a href="/tag/emberads/">emberads</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Nighttime Horrors</h1>
    <time datetime="2012-01-10T10:51:03+00:00">2012-01-10 10:51:03</time>
  </header>

  <blockquote>
  <p>Screaming ghouls and scary monsters,<br />
Permeating our subconscious,<br />
At night they roam freely through our dreams,<br />
With the sole intent of causing our screams,<br />
Scaring us until we awake,<br />
Annoyingly, for we know they are fake.</p>
</blockquote>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/poetry/">poetry</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Defining Ruby Superclasses On The Fly</h1>
    <time datetime="2011-12-18T01:13:14+00:00">2011-12-18 01:13:14</time>
  </header>

  <p>Any rubyist that's defined a class should understand the following class definition:</p>

<pre><code>class Foo &lt; Object
end
</code></pre>

<p>It creates a new Constant (<code>Foo</code>) that is a subclass of <code>Object</code>. Pretty straightforward. But what you might not know is that ruby executes each line it reads in as it reads them. So we could do the following to show that:</p>

<pre><code>class Foo &lt; Object
  puts "we just defined object!"
end
</code></pre>

<p>And get the following output when we run that file:</p>

<pre><code># &gt;&gt; we just defined object!
</code></pre>

<p>So.. we know ruby is executing things on the fly whilst defining classes for us. How can we use this for profit and shenanigans?! (Err, use this for vanquishing evil and creating readable code I mean. Honest.)</p>

<p>How about if we've got a couple of opinionated people who like to think they've got the biggest ego in the interpreter? The last one to be loaded likes to have any new people ushered into the interpreter to be a subclass of themselves. Lets abuse a global for storing it in, and use a method to choose that on the fly when creating a new class.</p>

<pre><code>def current_awkward_bugger
  $awkward_bugger
end

class Simon; end
$awkward_bugger = Simon

class Fred &lt; current_awkward_bugger()
end
Fred.superclass # =&gt; Simon

class Harold; end
$awkward_bugger = Harold

class John &lt; current_awkward_bugger()
end
John.superclass # =&gt; Harold
</code></pre>

<p>Okay, so that looks a bit different to normally defined classes. We create <code>Simon</code>, assign him to the awkward bugger global then create <code>Fred</code>, who subclasses the return value of the <code>current_awkward_bugger</code> method which happens to be <code>Simon</code> currently. Then <code>Harold</code> muscles his way into the interpreter and decides he's going to be the current awkward bugger, so poor <code>John</code> gets to subclass <code>Harold</code> even though he's defined in the same way as <code>Fred</code>.</p>

<p>On a somewhat related note there's a lovely method called <code>const_missing</code> that gets invoked when you call a Constant in ruby that isn't defined. (Much like <code>method_missing</code> if you're familiar with that.) Means you can do even more shenanigans with non-existent superclasses for classes you're defining.</p>

<pre><code>class Simon; end
class Harold; end

class Object
  def self.const_missing konstant
    [Simon, Harold].shuffle.first
  end
end

class Fred &lt; ArrogantBastard
end
Fred.superclass # =&gt; Simon

class Albert &lt; ArrogantBastard
end
Albert.superclass # =&gt; Harold
</code></pre>

<p>So here we're choosing from Simon and Harold on the fly each time a missing constant is referenced (in this case the aptly named <code>ArrogantBastard</code> constant.) If you run this code yourself you'll see the superclasses change on each run according to what your computer picks that time.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>, <a href="/tag/ruby1-9/">ruby1.9</a>, <a href="/tag/hack/">hack</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Magic Bubble</h1>
    <time datetime="2011-12-06T22:03:46+00:00">2011-12-06 22:03:46</time>
  </header>

  <blockquote>
  <p>You and me,<br />
Quietly,<br />
Watching the rain in the stars,<br />
From a bubble near Mars.</p>
</blockquote>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/poetry/">poetry</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Experimental Procrastination</h1>
    <time datetime="2011-11-07T00:41:49+00:00">2011-11-07 00:41:49</time>
  </header>

  <p>A while ago I read a blog post that Elizabeth N wrote, on the <a href="http://naramore.net/blog/the-value-of-self-serving-code">value of writing self-serving code</a>. Ever since I've been moderately aware of when I've written self-serving code, usually either at hackdays, or just little projects where I'm either experimenting with something or just bashing out a new idea.</p>

<p>In fact, I even wrote about one of my recent "self-serving" projects I bashed out in an evening, <a href="http://caiustheory.com/tweetsavr">TweetSavr</a>. It has no tests, was written moderately quickly and not refactored immensely (here's hoping the git history backs me up on that! I certainly didn't knowingly majorly refactor it at any point at least.)  But it "scratched an itch" and solved the problem I had, and it works for the limited use case I need it to, so it's a success as far as I'm concerned.</p>

<p>More recently a friend remarked to me in a private conversation that everyone needs to procrastinate occasionally, to save them going "stir crazy". Whilst I agree with what she said, everyone needs to switch gears and do something that perhaps you shouldn't, or that won't directly contribute to completing your current task, I couldn't help but draw a link between procrastinating and writing self-serving code.</p>

<p>Now I'm a programmer, it's what I did for a hobby through school, it's what I leapt into a career doing when I was offered the chance and even when I've had a particularly exhausting week, it's something I'll eventually turn back to. But I realised that often when I procrastinate, I do so by writing self-serving code. My creative output or process if you will is to create things digitally on the computer, be that a web app, hacky script to let me do something I'm not supposed to be able to with someone else's application, just dicking around or exploring whatever tidbit of interesting info/behaviour in a language or library someone's just shared on IRC.</p>

<p><em>Aside: I've often joked (semi-seriously) that if/when I have enough cash in the bank to not have to actually have a "day job", I'll just spend all day building the random ideas that get tossed out on IRC instead. Quite often the smaller things I code up anyway already of an evening and they end up in my <a href="https://gist.github.com/caius">gists</a>.</em></p>

<p>Now it's unhealthy and counter-productive to want to program 24/7, at least in the long term. (Doing the odd 24 hour hackday event here and there can mean winning fun prizes to play with however.) And sometimes all that you need to do to solve a problem you've been butting your head against for the last couple of hours is to get off the damn computer. (I usually find taking a shower makes my subconscious reveal the answer it's been quietly computing and hey presto, I know how to solve the problem properly!) At other times it just requires changing gears and flexing a different part of your brain muscle. Like say, writing self-serving code. And procrastinating by doing so.</p>

<p>I'm not entirely sure what the point of this thought process is, or if there can really be a point to it, but it really intrigued me drawing a link between procrastinating and writing self-serving code. I can imagine other creatively minded people might do much the same thing, an artist just sketching for the sake of sketching, or a writer taking a couple of hours off from her next novel to write a short story for her blog. (That last one is actually something a friend's done, go read her <a href="http://libertyfallsdown.wordpress.com/tag/short-story/">short stories</a>, they're quite good. Start from the bottom though.)</p>

<p>And of course sometimes you just need to vegetate and read facebook (or twitter), but constructive procrastination does serve a real purpose I think, and can be quite useful as well.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/code/">code</a>, <a href="/tag/musings/">musings</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Install GCC-4.2.1 (Apple build 5666.3) with Xcode 4.2</h1>
    <time datetime="2011-10-30T17:36:48+00:00">2011-10-30 17:36:48</time>
  </header>

  <p>As of Xcode 4.2 Apple have stopped bundling GCC with it, shipping only the (mostly) compatible llvm-gcc binary instead. The suggested fix is to install GCC using the <a href="https://github.com/kennethreitz/osx-gcc-installer">osx-gcc-installer</a> project. However, I wanted to build and install it from source, which apple provides at <a href="http://opensource.apple.com/">http://opensource.apple.com/</a>.</p>

<p>You should already have installed Xcode 4.2 from the app store, then basically the following steps are to grab the tarball from the <a href="http://opensource.apple.com/release/developer-tools-41/">4.1 developer tools source</a>, unpack &amp; compile it, then install it into the right places.</p>

<h2 id="instructions">Instructions</h2>

<pre><code># Grab and unpack the tarball
$ mkdir ~/tmp &amp;&amp; cd ~/tmp
$ curl -O http://opensource.apple.com/tarballs/gcc/gcc-5666.3.tar.gz
$ tar zxf gcc-5666.3.tar.gz
$ cd gcc-5666.3

# Setup some stuff it requires
$ mkdir -p build/obj build/dst build/sym
# And then build it. You should go make a cup of tea or five whilst this runs.
$ gnumake install RC_OS=macos RC_ARCHS='i386 x86_64' TARGETS='i386 x86_64' \
  SRCROOT=`pwd` OBJROOT=`pwd`/build/obj DSTROOT=`pwd`/build/dst SYMROOT=`pwd`/build/sym

# And finally install it
$ sudo ditto build/dst /
</code></pre>

<p>And now you should have <code>gcc-4.2</code> in your <code>$PATH</code>, available to build all the things that <code>llvm-gcc</code> fails to compile.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/installing/">installing</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/mac-app-store/">mac app store</a>, <a href="/tag/gcc/">gcc</a>, <a href="/tag/llvm/">llvm</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>TweetSavr</h1>
    <time datetime="2011-10-22T12:05:39+00:00">2011-10-22 12:05:39</time>
  </header>

  <p>I've had a dream for a while. A simple webapp that takes the last tweet in a conversation and outputs that conversation in chronological order on a page you can link to forevermore. Occasionally I'll google to see if anything new's turned up, but they all seem to do far more, require the start and end tweets or are covered in ads.</p>

<p>So one friday evening I just built it. It's called <a href="http://tweetsavr.com/">TweetSavr</a>. It's very simple—to the point the error page is just a standard 500 server error page currently. It fetches, caches and displays a conversation, given just the last tweet in said conversation.</p>

<p>KISS extends to the interface as well, I'm quite a fan of <a href="http://jerz.setonhill.edu/writing/etext/url-hacking.htm">URL hacking</a> to use webapps, so TweetSavr works on that basis as well. The homepage sort of has some help telling you how to use it, but you basically take the (old-twitter) URL of the last tweet and paste it after tweetsavr.com in the address bar. Eg, <a href="http://tweetsavr.com/http://twitter.com/ElizabethN/status/19766711653765120">http://tweetsavr.com/http://twitter.com/ElizabethN/status/19766711653765120</a>. It'll then redirect you through to the actual page for that conversation. You can also put just the status id on the end of the URL, <a href="http://tweetsavr.com/19766711653765120">http://tweetsavr.com/19766711653765120</a> and hey presto, it loads.</p>

<p>The caching layer is moderately rudimentary, after fetching a tweet that isn't in the cache it writes out a hash of data for that tweet into a yaml file. And when looking up a tweet it checks to see if that file exists, reading it in from disk if it is. Bonus side-effect is it builds up a corpus of tweets as yaml files on disk.</p>

<p>It lives on the internet at <a href="http://tweetsavr.com/">http://tweetsavr.com/</a> and the source is on github at <a href="http://github.com/caius/tweetsavr">http://github.com/caius/tweetsavr</a></p>

<p>Side note: isn't it wonderful what we can create given just a few hours, a server somewhere in the cloud, and an idea? Never ceases to amaze me what can be built in just a short amount of time, even the dead simple things.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/twitter/">twitter</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/hack/">hack</a>, <a href="/tag/yaml/">YAML</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>#to_param and keyword slugs</h1>
    <time datetime="2011-07-05T23:13:43+00:00">2011-07-05 23:13:43</time>
  </header>

  <p>Imagine you've got a blogging app and it's currently generating URL paths like <code>posts/10</code> for individual posts. You decide the path should contain the post title (in some form) to make your URLs friendlier when someone reads them. I know I certainly prefer to read <a href="http://caiustheory.com/abusing-ruby-19-and-json-for-fun">http://caiustheory.com/abusing-ruby-19-and-json-for-fun</a> vs <a href="http://caiustheory.com/?id=70">http://caiustheory.com/?id=70</a>. <em>(That's a fun blog post if you're into (ab)using ruby occasionally!)</em></p>

<p>Now you know <em>all</em> about how to change the URL path that rails generates—just define <code>to_param</code> in your app. Something simple that generates a slug consisting of hyphens and lowercase alphanumerical characters. For example:</p>

<pre><code># 70-abusing-ruby-1-9-json-for-fun
def to_param
  "#{id}-#{title.gsub(/\W/, "-").squeeze("-")}".downcase
end
</code></pre>

<p><em><strong>NB</strong>: You might want to go the route of storing the slug against the post record in the database and thus generating it before saving the record. In which case the rest of this post is sort of moot and you just need to search on that column. If not, then read on!</em></p>

<p>Now we're generating a nice human-readable URL we need to change the way we find the post in the controller's show action. Up until now it's been a simple <code>@post = Post.find(params[:id])</code> to grab the record out the database. Problem now is <code>params[:id]</code> is <code>"70-abusing-ruby-1-9-json-for-fun"</code>, rather than just <code>"70"</code>. A quick check in the <a href="http://ruby-doc.org/core/classes/String.html#M001149">String#to_i</a> docs reveals it "Returns the result of interpreting leading characters in str as an integer base base (between 2 and 36)." Basically it extracts the first number it comes across and returns it.</p>

<p>Knowing that we can just lean on it to extract the id before using find to look for the post: <code>@post = Post.find(params[:id].to_i)</code>. Fantastic! We've got nice human readable paths on our blog posts and they can be found in the database. All finished… or are we?</p>

<p>There's still a rather embarassing bug in our code where we're not explicitly checking the slug in the URL against the slug of the Post we've extracted from the database. If we visited <code>/posts/70-ruby-19-sucks-and-python-rules-4eva</code> it would load the blog post and render it without batting an eyelid. This has caused <a href="http://www.niemanlab.org/2011/04/how-url-spoofing-can-put-libelous-words-into-news-orgs-mouths/">rather a few embarrassing situations</a> for some high profile media outlets who don't (or didn't) check their URLs and just output the content. Luckily there's a simple way for us to check this.</p>

<p>All we want to do is render the content if the id param matches the slug of the post exactly, and return a 404 page if it doesn't. We already know the id param (<code>params[:id]</code>) and have pulled the Post object out of the database and stored it in an instance variable (<code>@post</code>). The <code>@post</code> knows how to generate it's own slug, using <code>#to_param</code>.</p>

<p>So we end up with something like the following in our posts controller, which does all the above and correctly returns a 404 if someone enters an invalid slug (even if it starts with a valid post id):</p>

<pre><code>def show
  @post = Post.find(params[:id].to_i)
  render_404 &amp;&amp; return unless params[:id] == @post.to_param
end

def render_404
  render :file =&gt; Rails.root + "public/404.html", :status =&gt; :not_found
end
</code></pre>

<p>And going to an invalid path like <code>/posts/70-ruby-19-sucks-and-python-rules-4eva</code> just renders the default rails 404 page with a 404 HTTP status. (If you want the id to appear at the end of the path, alter <code>to_param</code> accordingly and do something like <code>params[:id].match(/\d+$/)</code> to extract the Post's id to search on.)</p>

<p>Hey presto, we've implemented human readable slugs that are tamper-proof (without storing them in the database.)</p>

<p><em>(And bonus points if in fact you spotted I used my blog as an example, but that it isn't a rails app. (Nor contains the blog post ID in the pretty URL.) It's actually powered by <a href="http://habariproject.org/">Habari</a>!</em></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/merb/">merb</a>, <a href="/tag/code/">code</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/habari/">habari</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/ruby1-9/">ruby1.9</a>, <a href="/tag/security/">security</a>, <a href="/tag/validation/">validation</a>, <a href="/tag/tips/">tips</a>, <a href="/tag/hack/">hack</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Bad Recruiters - Rhys Evans at Devonshire</h1>
    <time datetime="2011-02-09T14:03:49+00:00">2011-02-09 14:03:49</time>
  </header>

  <p>This is a linked-in invitation I received from Rhys, and my reply.</p>

<hr />

<p><strong>Update 2011-02-10:</strong> As much as recruiters can be scummy twats, Rhys appears to at least care somewhat about his relationship with potential clients/contacts and has <a href="http://caiustheory.com/bad-recruiters-rhys-evans-at-devonshire#comment-34098">responded in the comments</a>. Normally my policy with recruiters is a two strike one, first email gets a polite "No thanks, go away.", second gets a mini-rant to bugger off and stop contacting me. Rhys hadn't technically contacted me before, but the unsolicited xmas email showed up when I searched my mailbox (which had annoyed me back when I received it.) And asking amongst my peers around at the time showed he was fairly disliked. (As you can see in some of the comments left below as well.) Since then, including a comment left below, a few people I trust have noted he's really not that bad as recruiters go, and the fact he's left a comment acknowledging perhaps his approach is a little misguided is enough for me to see he does still care about trying to be better than the rest of the recruitment crowd.</p>

<p>I still stand by my initial reply to him, and all other recruiters who don't understand "No." however.</p>

<hr />

<p>On 02/09/11 5:30 AM, Rhys Evans wrote:</p>

<blockquote>
  <p>Hi Caius,</p>

  <p>Good afternoon, I hope all is well.</p>

  <p>I've noticed we are connected to a number of the same people within the Rails space on LinkedIn. I've tried you on 07960 268100 to no avail so I'd like to add you to my network and make contact.</p>

</blockquote>

<p>Hi Rhys,</p>

<p>I've already got you blocked on twitter, so we've obviously run across each other in the past. You also appear to have sent me a Merry Xmas email from Devonshire, with no previous contact initiated by me. (I seem to remember a lot of my friends got those emails as well and we eventually worked out you'd scraped Github for them.)</p>

<p>Now it would appear you're being more intrusive and hunting folk out on linked in, ignoring the fact that they are employed and have specifically set linked in to say they aren't looking for new jobs currently. From asking around you harass a few of my friends, to the point of ringing one up recently to tell them you knew they'd changed jobs and where they were now working. If you're going to spend time doing that much research then why not have the decency to not be a completely mannerless cunt and leave them alone when they request you to.</p>

<p>It would also appear you've just blanket-spammed me and a few people in my peer group through linked in with the same request, again a pretty dumb thing to do. It's as if you recruiters think we never talk to each other, and don't realise how much you lot being a bunch of pestering spammy bastards taints developers against ever dealing with a recruiter.</p>

<p>So no, I don't think I do want to accept your invitation to connect. And please never phone, email or contact me via any other means. I'm happily employed and if I <em>ever</em> need the services of a recruiter I'll find someone who actually possesses an ounce of politeness about approaching (potential) candidates.</p>

<p>Thanks,<br />
Caius</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/bad-recruitment/">bad recruitment</a>, <a href="/tag/recruiters/">recruiters</a>, <a href="/tag/spam/">spam</a>, <a href="/tag/idiots/">idiots</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Abusing Ruby 1.9 &amp; JSON for fun</h1>
    <time datetime="2011-02-07T19:16:58+00:00">2011-02-07 19:16:58</time>
  </header>

  <p>Ever since I found out about the new hash syntax you can use in ruby 1.9, and how similar that syntax is to JSON, I've been waiting for someone to realise you can just abuse <code>eval()</code> for parsing (some) JSON now.</p>

<p>For example, lets say we have the following ruby hash, which could be generated by a RESTful api:</p>

<pre><code>thing = {
    :person =&gt; {
        :name =&gt; "caius"
    }
}
</code></pre>

<p>If we pull in the JSON gem and dump that out as a string, we get the following:</p>

<pre><code>ruby-1.9.2-p136 &gt; jsonstr = thing.to_json
 =&gt; '{"person":{"name":"caius"}}'
</code></pre>

<p>That's… not quite what we wanted. It's not going to turn back into valid ruby as it is. Luckily javascript will parse objects without requiring the attributes to be wrapped in quotes, eg: <code>{some: "attribute"}</code>. We could build a JSON emitter that does it properly, or we could just run it through a regular expression instead. <em>(Lets also add a space after the colon to aid readability.)</em></p>

<pre><code>ruby-1.9.2-p136 &gt; jsonstr.gsub!(/"([^"]+)": /, '\1: ')
 =&gt; '{person: {name: "caius"}}'
</code></pre>

<p>Okay, so now we've turned a ruby hash into a JSON hash, that can still be parsed by the browser. Here's a screenshot to prove that:</p>

<p><img alt="Valid JSON 'thing'" src="http://farm6.static.flickr.com/5300/5425314597_43be5824cf_o.jpg" /></p>

<p>As you can see, it parses that into a valid JS object, complete with person and then (nested) name attributes. If we wanted to, <code>thing["person"]["name"]</code> or <code>thing.person.name</code> would access the nested value "caius" just fine.</p>

<p>Now then, we've proved that is successfully parsed into javascript objects by the browser, generated from a ruby hash. No great shakes there, that's fairly simple and has worked for ages. Now for my next trick, I'm going to turn that string of JSON back into a ruby hash, all without going anywhere near the JSON gem.</p>

<p>Some of you might have guessed what I'm about to do and have started hoping you've guessed wrongly — just for the record I don't condone doing this except for fun and games. The JSON gem is there for a reason ;) With that little disclaimer out the way, here we go!</p>

<pre><code>ruby-1.9.2-p136 &gt; thing2 = eval(jsonstr)
 =&gt; {:person=&gt;{:name=&gt;"caius"}}
ruby-1.9.2-p136 &gt; thing2 == thing
 =&gt; true
</code></pre>

<p>Oh snap! We just turned javascript objects back into valid ruby objects, in one simple method call. And we'd be able to access the "caius" value by calling <code>thing2[:person][:name]</code>, or creating OpenStructs from the hashes and calling <code>thing2.person.name</code>. Which is uncannily like the JS!</p>

<p><strong>Updated 2011-02-07</strong>: <a href="http://jens.ayton.se/">Jens Ayton</a> pointed out unquoted keys aren't strictly valid JSON, which is correct. Amended to say they're parsed as javascript objects instead, with no mention of it being valid JSON.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/funny/">funny</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>, <a href="/tag/rubygems/">rubygems</a>, <a href="/tag/ruby1-9/">ruby1.9</a>, <a href="/tag/javascript/">javascript</a>, <a href="/tag/tips/">tips</a>, <a href="/tag/json/">json</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>App Store Hidden Preferences</h1>
    <time datetime="2011-01-06T19:45:49+00:00">2011-01-06 19:45:49</time>
  </header>

  <p><em>See the Update at the end before you get excited :(</em></p>

<p>Having just installed 10.6.6 to use the Mac App Store, I was <a href="http://twitter.com/Caius/status/23096911170899968">slightly annoyed</a> that it fills my dock with apps as I install them. I'm a bit strange, in that I use a hidden preference to make the dock uneditable (it stops me accidentally dragging an app off.) But that means I can't drag off the Mac App Store installed apps either.</p>

<p>Had a quick look through <code>/Applications/App Store.app/Contents/MacOS/App Store</code> with <code>strings</code> (love that tool) and noted a few strings that looked interesting. (There's a full list <a href="https://gist.github.com/768442">in this gist</a>.) There wasn't anything that explicitly stated it stopped it putting anything in the dock, but I did notice an option that stopped it showing <strong>install progress</strong> in the dock.</p>

<p>Yank up a terminal window, bash out the following…</p>

<pre><code>defaults write com.apple.appstore FRDebugShowInstallProgress -bool NO
</code></pre>

<p>…head back to the MAS and install another (free) app, and hey presto, it's leaving my dock alone! Hopefully that's all I needed to continue using my Dock as I like. (Hidden, and left alone.)</p>

<p><strong>Update 2011-01-06:</strong></p>

<p>Seems my joy was short-lived. I'd re-downloaded an app I'd already purchased and it just showed download progress in the MAS app, not in the dock. Installing new applications still shows up in the dock (annoyingly.)</p>

<p>I've been having a poke through how it all hangs together, and if it's possible to actually block downloads from the Dock or not. It doesn't look like there's a hidden preference to hide new apps from downloading in the dock, you can just disable the progress bars in the dock with prefs. The MAS.app seems to be codenamed "Firenze", with <a href="https://gist.github.com/768829">the "hidden" prefs</a> being prefixed with "FRDebug".</p>

<p>As I understand it, the App\ Store.app invokes a binary inside <code>/System/Library/PrivateFrameworks/CommerceKit.framework</code> called "storeagent" to do the actual downloading/talking to the dock. From looking at the <a href="https://gist.github.com/768837">class-dump</a> of storeagent it communicates with the dock to place a new type of DockTile. Interesting sounding methods to (potentially?) swizzle are <code>-[DownloadQueue sendDownloadListToDock]</code> and <code>-[DownloadQueue tellDockToAddDownload:]</code>.</p>

<p>I've given up for now, but I reckon it should be possible to create a bundle that swizzles the right methods in storeagent to stop it placing the downloads on the Dock.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/hack/">hack</a>, <a href="/tag/mac-app-store/">mac app store</a>, <a href="/tag/app-store/">app store</a>, <a href="/tag/defaults/">defaults</a>, <a href="/tag/terminal/">terminal</a>, <a href="/tag/strings/">strings</a>, <a href="/tag/hidden-preferences/">hidden preferences</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Facebook iPhone app Contact Sync isn't automatic</h1>
    <time datetime="2010-10-06T14:10:06+00:00">2010-10-06 14:10:06</time>
  </header>

  <p>There's an article on the guardian about <a href="http://www.guardian.co.uk/technology/blog/2010/oct/06/facebook-privacy-phone-numbers-upload">private phone numbers being uploaded from facebook</a>, and another over <a href="http://www.techeye.net/security/facebook-takes-and-stores-data-numbers-from-your-iphone">techeye.net on the same subject.</a></p>

<p>Firstly a quote from the techeye article:</p>

<blockquote>
  <p>Facebook doesn't warn users that they are uploading their phone's address book to Facebook.</p>
</blockquote>

<p>And whilst the guardian article never says it happens automatically, it also doesn't lay it out that you have to <strong>explicitly</strong> enable that feature, <strong>and</strong> agree to the facebook app uploading the data.</p>

<p>I was pretty sure that facebook wouldn't be grabbing all your contact information without telling you, if they did at all, and that both articles were just pure scaremongering. So I fired up the facebook iPhone app, headed into my friends list on there, clicked sync and got the following screen:</p>

<p><img alt="" src="http://farm5.static.flickr.com/4148/5056619687_973ae660cc_d.jpg" /><br />
<a href="http://www.flickr.com/photos/caius/5056619687/">View Original</a></p>

<p>Ok, so according to that text, they're just pulling down profile images and profile links from facebook and putting them in your address book against your contacts. Seems fairly harmless so far. So I toggled the top switch, to enable Contact Sync, and got the following screen:</p>

<p><img alt="" src="http://farm5.static.flickr.com/4145/5056697193_252e954ec3_d.jpg" /><br />
<a href="http://www.flickr.com/photos/caius/5056697193/">View Original</a></p>

<p>Reading that, it's fairly obvious what data facebook are uploading (although a little ambiguous why), and it <strong>certainly</strong> isn't happening automatically. As it says, it uploads the "name, email address, phone number" from all your contacts to facebook, and pull down "your friends' profile photos and other info from Facebook".</p>

<p>So whilst facebook <em>are</em> collecting more data (albeit stored subject to their Privacy Policy), it's certainly <strong>NOT</strong> done automatically, and is <strong>very explicit</strong> about what is being uploaded at the point you enable it.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/facebook/">facebook</a>, <a href="/tag/iphone-app/">iphone app</a>, <a href="/tag/guardian/">guardian</a>, <a href="/tag/privacy/">privacy</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>+[NSObject load] in MacRuby</h1>
    <time datetime="2010-06-12T02:11:32+00:00">2010-06-12 02:11:32</time>
  </header>

  <p><em>If you've not heard of it, <a href="http://www.macruby.org/">MacRuby</a> is <q>an implementation of Ruby 1.9 directly on top of Mac OS X core technologies such as the Objective-C runtime and garbage collector, the LLVM compiler infrastructure and the Foundation and ICU frameworks.</q> Basically means you write in Ruby using Objective-C frameworks, and vice versa. It's pretty damn cool to be honest!</em></p>

<h3 id="what-is-nsobject-load">What is +[NSObject load]?</h3>

<p>From the <a href="http://developer.apple.com/mac/library/documentation/cocoa/reference/foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/clm/NSObject/load">documentation</a>:</p>

<blockquote>
  <p>Invoked whenever a class or category is added to the Objective-C runtime; implement this method to perform class-specific behavior upon loading.</p>
</blockquote>

<p>This means when your class is loaded, and implements the <code>load</code> method, you get a <code>load</code> message sent to your class. Which means you can start doing stuff as soon as your class is loaded by the runtime.</p>

<p>The main place I've seen it used (and used it myself) is in <a href="http://www.culater.net/software/SIMBL/SIMBL.php">SIMBL</a> plugins. A SIMBL plugin is an NSBundle that contains code which is loaded (injected) into a running application shortly after said application is launched. It lets you extend (or "fix") cocoa applications with additional features. So you have this bundle of code, that gets loaded into a running application some point after it starts, and you want to run some code as the bundle is loaded - usually to kick off doing whatever you want to do in the plugin. This is where <code>load</code> becomes useful.</p>

<p>Here's a quick implementation that just logs to the console:</p>

<pre><code>@implementation MainController

+ (void) load
{
    NSlog(@"MainController#load called");
}
</code></pre>

<h3 id="now-where-does-macruby-come-into-this">Now where does MacRuby come into this?</h3>

<p>Well I came across a need to do the same in ruby, have some code triggered when the class is loaded into the runtime. Tried implementing <code>Class.load</code> but to no avail. Then remembered MacRuby is just ruby! And I can call any code from within my ruby class definition.</p>

<p>For continuity I still call it <code>Class.load</code>, but then call it as soon as I've defined it in the class. Eg:</p>

<pre><code>class MainController

    def self.load
        NSLog "MainController#load called"
    end
    self.load

end
</code></pre>

<p>Of course, I'm not sure when the Objective-C method is called, it's probably after the entire class has been defined rather than as soon as <code>load</code> has been loaded into the runtime. So you might want to move the <code>self.load</code> call to just before the closing <code>end</code>.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/objective-c/">objective-c</a>, <a href="/tag/ruby1-9/">ruby1.9</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/objc/">objc</a>, <a href="/tag/simbl/">SIMBL</a>, <a href="/tag/macruby/">MacRuby</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Potty Training YAML</h1>
    <time datetime="2010-05-10T21:46:17+00:00">2010-05-10 21:46:17</time>
  </header>

  <p>Ran into a problem today where I have a class with a few attributes on it, but I only want a certain three of those attributes to appear in the YAML dump of a class instance.</p>

<p>Diving straight into a code example–lets say we have a <code>Contact</code> class, and we only want to dump the <code>name</code>, <code>email</code> and <code>website</code> attributes.</p>

<pre><code>require "yaml"

class Contact
    attr_accessor :name, :email, :website, :telephone

    # helper method to make setting up easy
    def initialize params={}
      params.each do |key, value|
        meffod = "#{key.to_s}="
        send(meffod, value) if respond_to?(meffod)
      end
    end
end

# And create an instance for us to play with
caius = Contact.new(
  :name =&gt; "Caius",
  :email =&gt; "dev@caius.name",
  :website =&gt; "http://caius.name/",
  :telephone =&gt; "12345"
)
</code></pre>

<p>As we'd expect when dumping this, all instance variables get dumped out:</p>

<pre><code>print caius.to_yaml
# &gt;&gt; --- !ruby/object:Contact 
# &gt;&gt; email: dev@caius.name
# &gt;&gt; name: Caius
# &gt;&gt; telephone: "12345"
# &gt;&gt; website: http://caius.name/
</code></pre>

<p>Initially I tried to override <code>to_yaml</code> and unset the instance variables I didn't want showing up, but that just made them show up empty. After digging around a bit more, I happened across the <a href="http://yaml4r.sourceforge.net/doc/page/type_families.htm">Type Families</a> page in the yaml4r docs, which right at the bottom mentions <code>to_yaml_properties</code>.</p>

<p>Turns out <code>to_yaml_properties</code> returns an array of instance variable names (as strings) that should be dumped out as part of the object. A quick method definition later, and we're only dumping the variables we want. (<em>See my <a href="http://caiustheory.com/ruby-shortcuts">Ruby Shortcuts</a> post if you don't know what <code>%w()</code> does</em>)</p>

<pre><code>class Contact
    def to_yaml_properties
        %w(@name @email @website)
    end
end
</code></pre>

<p>And now we dump the class, expecting only the three attributes to be outputted:</p>

<pre><code>print caius.to_yaml
# &gt;&gt; --- !ruby/object:Contact 
# &gt;&gt; name: Caius
# &gt;&gt; email: dev@caius.name
# &gt;&gt; website: http://caius.name/
</code></pre>

<p>Success!</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/link/">link</a>, <a href="/tag/troubleshooting/">troubleshooting</a>, <a href="/tag/yaml/">YAML</a>, <a href="/tag/potty-training/">potty training</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Ruby Shortcuts</h1>
    <time datetime="2010-03-18T22:32:45+00:00">2010-03-18 22:32:45</time>
  </header>

  <p>There's a few useful shorthand ways to create certain objects in Ruby, a couple of obvious ones are <code>[]</code> to create an <code>Array</code> and <code>{}</code> to create a <code>Hash</code> (Or block/<code>Proc</code>). There's some not so obvious ones too, for creating strings, regexes and executing shell commands.</p>

<p>With all of the examples I've used <code>{}</code> as the delimiter characters, but you can use a variety of characters. Personally I tend to use <code>{}</code> unless the string contains them, in which case I'll use <code>//</code> or <code>@@</code>. My only exception appears to be <code>%w</code>, for which I tend to use <code>()</code>.</p>

<h3 id="strings">Strings</h3>

<p><code>%</code> and <code>%Q</code> are the same as using double quotes, including string interpolation. Really useful when you want to create a string that contains double quotes, but without the hassle of escaping them.</p>

<pre><code>%{}                 # =&gt; ""
%Q{}                # =&gt; ""

%{caius}            # =&gt; "caius"
%{caius #{5}}       # =&gt; "caius 5"
%{some "foo" thing} # =&gt; "some \"foo\" thing"
</code></pre>

<p><code>%q</code> is equivalent to using single quotes. Behaves exactly the same, no string interpolation.</p>

<pre><code>%q{}           # =&gt; ''
%q{caius}      # =&gt; "caius"
%q{caius #{5}} # =&gt; "caius \#{5}"
</code></pre>

<h3 id="arrays">Arrays</h3>

<p><code>%w</code> is the equivalent of using String#split. It takes a string and splits it on whitespace. With the added bonus of being able to escape whitespace too. <code>%W</code> allows string interpolation.</p>

<pre><code>%w(foo bar sed)  # =&gt; ["foo", "bar", "sed"]
%w(foo\ bar sed) # =&gt; ["foo bar", "sed"]
%W(foo #{5} bar) # =&gt; ["foo", "5", "bar"]
</code></pre>

<h3 id="regexes">Regexes</h3>

<p><code>%r</code> is just like using <code>//</code> to create a regexp object. Comes in handy when you're writing a regex containing <code>/</code> as you don't have to continually escape it.</p>

<pre><code>%r{foo|bar} # =&gt; /foo|bar/
%r{foo/bar} # =&gt; /foo\/bar/
</code></pre>

<h3 id="symbols">Symbols</h3>

<p><code>%s</code> creates a symbol, just like writing <code>:foo</code> manually. It takes care of escaping the symbol, but unlike <code>:""</code> it doesn't allow string interpolation however.</p>

<pre><code>%s{foo}      # =&gt; :foo
%s{foo/bar}  # =&gt; :"foo/bar"
:"foo-#{5}"  # =&gt; :"foo-5"
%s{foo-#{5}} # =&gt; :"foo-\#{5}"
</code></pre>

<h3 id="shelling-out">Shelling out</h3>

<p><code>%x</code> is the same as backticks (<code>``</code>), executes the command in a shell and returns the output as a string. And just like backticks it supports string interpolation.</p>

<pre><code>`echo hi`     # =&gt; "hi\n"
%x{echo hi}   # =&gt; "hi\n"
%x{echo #{5}} # =&gt; "5\n"
</code></pre>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/tips/">tips</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>iPad? iPerfect (…for me)</h1>
    <time datetime="2010-01-27T20:56:50+00:00">2010-01-27 20:56:50</time>
  </header>

  <p><em>Google Groups is a pile of fail and hasn't posted my message in reply to a thread on <a href="http://geekup.org/">Geekup</a> so I'm blogging it instead.</em></p>

<blockquote>
  <p>On 27 Jan 2010, at 19:53, Steve Richardson wrote:<br />
Thoughts?</p>
</blockquote>

<p>I've been searching for a device to fit between my Macbook Pro and iPhone. I work all day on the MBP, and moving it to then watch video in another room or read twitter/news/mail whilst watching telly, etc is a pain.</p>

<p>The iPhone is a great little device on the move, but for trying to multitask at home it's a bit.. tedious. Even jailbroken and running multiple apps at once it's still limiting.</p>

<p>I'd been looking around at netbooks, but what put me off actually getting one was my previous experience with one. I know I'd want it to run OS X to keep in sync (easily) with my other Apple devices, but hackintoshing one was a bit too much hassle, plus the fact ones to hackintosh cost more than I really wanted to pay for something that wasn't <em>quite</em> what I thought I needed.</p>

<p>And then.. the iPad. I've been sort of keeping up with the rumours (mainly through <a href="http://daringfireball.net">Daring Fireball</a>) and whilst I didn't get excited about it too much ahead of announcement<sup>1</sup>, having seen the official video of it it's pretty much guaranteed that I'm going to get one.</p>

<p>Yes, it's limited (App Store, closed device), but.. I don't care. Take the iPhone, it's good enough for doing things on it, even if someone else is in charge of the ecosystem and has a big finger saying yes or no. I (willingly) use iTunes, Mobile Me, all the things that are so wonderfully integrated in the world of Apple, so another device that consumes my media using channels I already know and use is just a massive win for me.</p>

<p>All I'm hoping now is that $499 doesn't equal £499. Hopefully it'll be £399, still a good £80 above direct exchange rate, but low enough that it's a no-brainer for me to get one.</p>

<p>…And I think this is the first Apple product that I've seen announced and actually known from the start <em>why</em> I'm going to get one, instead of just a knee-jerk "SHINY!!!! WANT!!!" reaction. Uh oh, does that make me an adult?</p>

<p><sup>1</sup> I miss getting really excited about apple announcements :(</p>

<h4 id="update">Update</h4>

<p>It just got even better. Was lamenting to a <a href="http://tmertz.com/">friend</a> on IM that it'd be so much nicer once you can directly suck photos off a camera/SD card into it. Turns out there's an adapter for that. See "iPad Camera Connection Kit" at the bottom of <a href="http://www.apple.com/ipad/specs/">http://www.apple.com/ipad/specs/</a> for details.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/event/">event</a>, <a href="/tag/iphone/">iphone</a>, <a href="/tag/jailbreak/">jailbreak</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/ipad/">ipad</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>at(1) on OS X</h1>
    <time datetime="2009-12-28T09:30:30+00:00">2009-12-28 09:30:30</time>
  </header>

  <p>I recently came across the <a href="http://developer.apple.com/mac/library/DOCUMENTATION/Darwin/Reference/ManPages/man1/at.1.html"><code>at(1)</code></a> command, and wondered why it wasn't executing jobs I gave it on my machine. Had a poke around the man pages, and discovered in <a href="http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man8/atrun.8.html"><code>atrun(8)</code></a> that by default <code>launchd(8)</code> has the <code>atrun</code> entry disabled.</p>

<p>To enable it (and have <code>at</code> jobs fire) you simply need to run the following command once:</p>

<pre><code>sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.atrun.plist
</code></pre>

<p>Personally I've taken to using this to sleep my machine after a custom amount of time, mainly because my alarm clock/sleep timer of choice (<a href="http://embraceware.com/awaken/">Awaken</a>) can't handle playing <a href="http://www.spotify.com/">Spotify</a> for x minutes and then sleeping the machine. The following command puts the machine to sleep, which (quite effectively) silences spotify.</p>

<pre><code>echo "osascript -e 'tell app \"Finder\" to sleep'" | at 1:00am
</code></pre>

<p>See the <a href="http://developer.apple.com/mac/library/DOCUMENTATION/Darwin/Reference/ManPages/man1/at.1.html"><code>at(1)</code></a> manpage for how to specify the time, but as I'm only ever scheduling it on the same day (usually 20 minutes or so in advance), just passing the time works fine.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/mac/">mac</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Read Later in a keystroke</h1>
    <time datetime="2009-12-06T22:15:37+00:00">2009-12-06 22:15:37</time>
  </header>

  <p>I use a wonderful service for saving text to be read later, <a href="http://instapaper.com/">instapaper.com</a>. It's gotten more wonderful as time has gone on and other applications/service's have gained the ability to save links/articles/webpages there for me to pick up later.</p>

<p>For instance, I'm out and about checking twitter on my iPhone using <a href="http://atebits.com/tweetie-iphone/">tweetie</a> and someone tweets a link. Rather than wait for it to load and having to read it then and there I can just hit "Read Later" and it's saved in my instapaper account for me to read as and when I choose to. Recently the legendary mac feed reader <a href="http://www.newsgator.com/INDIVIDUALS/NETNEWSWIRE/">NetNewsWire</a> gained this ability too.</p>

<p>There's a few ways to send a feed item to instapaper from within NNW. Firstly you can right-click and click "Send to Instapaper".</p>

<p><img alt="Send to Instapaper from contextual menu" src="http://farm3.static.flickr.com/2553/4163576297_ee60e26b53_o.jpg" /><br />
<a href="http://www.flickr.com/photos/caius/4163576297">View Original on Flickr</a></p>

<p>Secondly there's a menu item for it in the News menu, which also provides my chosen way of instapapering an item—the keyboard shortcut! ⌃P <em>(control-P)</em>.</p>

<p><img alt="Send to Instapaper from News menu" src="http://farm3.static.flickr.com/2748/4164341910_476f8ba539_o.jpg" /><br />
<a href="http://www.flickr.com/photos/caius/4164341910">View Original on Flickr</a></p>

<p>So, in NNW I'm happily sending stuff to instapaper with the handy ⌃P shortcut, but that doesn't exist in the third place I mark things to read later–Safari! Up until now I've been using the standard "Read Later" bookmarklet that <a href="http://instapaper.com/">instapaper.com</a> provides, and it's got a spot on my Bookmarks Bar so I can easily click it.</p>

<p>That doesn't really help with the fact I'm hitting ⌃P in NNW, and it doesn't work in Safari. Quite often I noticed myself hitting the key combination in Safari and wondering for a split second why it wasn't sending the item to instapaper. Then the solution hit me!</p>

<p>In OS X you can setup (and/or override) menu items with custom key combinations! Why hadn't I remembered this before. Because the "Read Later" bookmark<em>(let)</em> is nested under the Bookmarks menu, it <strong>is</strong> a menu item! A quick trip into the Keyboards Prefpane in System Preferences and a new binding later and voilâ, "Read Later" in Safari is bound to ⌃P and I can use it in both Safari and NNW.</p>

<p><img alt="Filling in the form to bind the keyboard shortcut" src="http://farm3.static.flickr.com/2517/4163642801_a14250da65_o.jpg" /><br />
<a href="http://www.flickr.com/photos/caius/4163642801">View Original on Flickr</a></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/safari/">safari</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/hack/">hack</a>, <a href="/tag/menubar/">menubar</a>, <a href="/tag/instapaper/">instapaper</a>, <a href="/tag/webkit/">webkit</a>, <a href="/tag/read-later/">read later</a>, <a href="/tag/bookmarklet/">bookmarklet</a>, <a href="/tag/key-bindings/">key bindings</a>, <a href="/tag/system-preferences/">system preferences</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>My Menubar Items</h1>
    <time datetime="2009-12-06T12:56:49+00:00">2009-12-06 12:56:49</time>
  </header>

  <!-- Just for this post -->
<style>
    ol { list-style-type: lower-alpha; }
    ol ol { list-style-type: decimal; }
</style>

<p>This is a something that occasionally makes the rounds again, I've not seen it for a while and I've added some new items since I last remember documenting it. Thus, <a href="http://twitter.com/macarne">@macarne</a> <a href="http://twitter.com/macarne/status/6398125336">asking</a> what the app was that gives me stats prompted me to document my current menubar items.</p>

<p><img alt="annotated-menubar by ©aius, on Flickr" title="annotated-menubar" src="http://farm3.static.flickr.com/2586/4162170875_1d1a8be4cf.jpg" /></p>

<p><a href="http://www.flickr.com/photos/caius/4162170875/">View original</a></p>

<ol>
  <li><a href="http://www.eidac.de/">SMCFanControl</a> - Lets me adjust the minimum speed of my fans.</li>
  <li><a href="http://atebits.com/tweetie-mac">Tweetie/mac</a></li>
  <li><a href="http://iscrobbler.sourceforge.net/">iScrobbler</a> - Scrobbles tunes iTunes plays</li>
  <li><a href="http://www.realmacsoftware.com/littlesnapper/">LittleSnapper</a> <em>(Or more accurately the menubar icon is NanoSnapper, LittleSnapper is the full app.)</em> Mainly used for screen grabs.</li>
  <li><a href="http://www.orange-carb.org/SBM/">SlimBatteryMonitor</a> - Takes up less horizontal space than Apple's menu item.</li>
  <li>Expresscard menu item - Lets me power off my <a href="http://www.memoryc.com/storage/solidstatedisk/48gbfilematesolidgoexpresscardultra.html">Expresscard/34 SSD</a></li>
  <li><a href="http://www.ragingmenace.com/software/menumeters/">MenuMeters</a> - An old friend I've been using for as long as I can remember running OS X. Set to show (left to right)
    <ol>
      <li>Ram - <strong>U</strong>sed and <strong>F</strong>ree totals.</li>
      <li>Network - Graph + values.</li>
      <li>CPU - Graph per core. Probably the most useful out of the three.</li>
    </ol>
  </li>
  <li>Bluetooth</li>
  <li>Time Machine</li>
  <li>Modem - To dial on my Huawei E220 3G stick.</li>
  <li>Airport</li>
  <li>Sound</li>
  <li>Day/Time</li>
  <li>Fast User Switching - Not sure why I keep this in the menubar, only have one user and I lock my screen with a password protected screensaver.</li>
  <li><a href="http://www.viscosityvpn.com/">Viscosity</a> - VPN software. Pretty useful.</li>
  <li>Spotlight! - Occasionally this vanishes when spotlight decides to be a dick and eat ram/cpu reindexing my disk every few hours. Touch wood it hasn't done it since 10.6.1.</li>
</ol>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/picture/">picture</a>, <a href="/tag/menubar/">menubar</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Read standard input using Objective-C</h1>
    <time datetime="2009-12-06T11:50:08+00:00">2009-12-06 11:50:08</time>
  </header>

  <p>On a couple of occasions now I've wanted to read from <code>STDIN</code> into an Objective-C command line tool, and both times I've had to hunt quite a bit to find the answer because nothing shows up in google for the search terms I used. "Objective-c read from stdin" and "objc read stdin" both turn up results ranging from using <code>NSInputStream</code> to dropping some C++ in there.</p>

<p>The answer is quite simple really, just use <code>NSFileHandle</code>. More specifically <code>+[NSFileHandle fileHandleWithStandardInput]</code>. You can then read all data currently in <code>STDIN</code>, monitor it for new data and anything else you can do with a normal <code>NSFileHandle</code>.</p>

<p>And here's some example code, reads all data from <code>STDIN</code> and stores it into an NSString:</p>

<pre><code>NSFileHandle *input = [NSFileHandle fileHandleWithStandardInput];
NSData *inputData = [NSData dataWithData:[input readDataToEndOfFile]];
NSString *inputString = [[NSString alloc] initWithData:inputData encoding:NSUTF8StringEncoding];
</code></pre>

<p><em>I'm using this in GarbageCollected apps, memory management without GC is left as an exercise to the user.</em></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/objective-c/">objective-c</a>, <a href="/tag/google/">google</a>, <a href="/tag/objc/">objc</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Nissan Almera Self Diagnostic Menu</h1>
    <time datetime="2009-09-28T10:44:00+00:00">2009-09-28 10:44:00</time>
  </header>

  <p>Here's how to access the self diagnostic / configuration menu on a Nissan Almera 2003 SVE (N16):</p>

<ol>
  <li>Start the engine</li>
  <li>Turn the radio on</li>
  <li>Turn the radio off</li>
  <li>Hold the info button in <em>then:</em></li>
  <li>Turn the volume knob up (clockwise) <em>until:</em></li>
  <li>Diagnostic menu appears</li>
</ol>

<p>From here you can do various things: run self-diagnostics; reset/change the main service counter; various other tests for the climate control, sat nav system, etc.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/car/">car</a>, <a href="/tag/troubleshooting/">troubleshooting</a>, <a href="/tag/nissan-almera/">nissan almera</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Ignore .gitignore in Git</h1>
    <time datetime="2009-09-21T06:00:00+00:00">2009-09-21 06:00:00</time>
  </header>

  <p>Recently I ran into an issue where I was working on a project which had files I wanted git to ignore, but I didn't want to commit a <code>.gitignore</code> file into the project. In case you don't know, any files matching a pattern in <code>.gitignore</code> in a git repository are ignored by git. (Unless the file(s) have already been committed, then they need removing from git before they are ignored.)</p>

<p>Initially I figured I could just throw the patterns I needed excluded into my global <code>~/.gitignore</code>, but quickly realised that I needed files matching these patterns to show up in other git repos, so going the global route really wasn't an option. After some thought I wondered if you could make git ignore <code>.gitignore</code>, whilst still getting it to ignore files matching the other patterns in the <code>.gitignore</code>.</p>

<p>Lets create a new empty repo to test this crazy idea in:</p>

<pre><code>$ mkdir foo
$ cd foo
$ git init
Initialized empty Git repository in /Volumes/Brutus/Users/caius/foo/.git/
</code></pre>

<p>And create a couple of files for us to play with:</p>

<pre><code>$ touch bar
$ touch baz
</code></pre>

<p>Ignore one of the files so we can check other matches are still ignored later on:</p>

<pre><code>$ echo "baz" &gt;&gt; .gitignore
$ git ststatus
# On branch master
#
# Initial commit
#
# Untracked files:
#   (use "git add &lt;file&gt;..." to include in what will be committed)
#
#       .gitignore
#       bar
nothing added to commit but untracked files present (use "git add" to track)
</code></pre>

<p>Ok so far, but we can still see .gitignore in git, so now for the crazy shindig, ignore the ignore file:</p>

<pre><code>$ echo ".gitignore" &gt;&gt; .gitignore 
</code></pre>

<p>Lets see if it worked, or if we can still see our .gitignore:</p>

<pre><code>$ git status
# On branch master
#
# Initial commit
#
# Untracked files:
#   (use "git add &lt;file&gt;..." to include in what will be committed)
#
#       bar
nothing added to commit but untracked files present (use "git add" to track)
</code></pre>

<p>And lets just double-check that <code>.gitignore</code> and <code>baz</code> still exist on the filesystem:</p>

<pre><code>$ ls -a
.               ..              .git            .gitignore      bar             baz
</code></pre>

<p>Fantastic! Turns out adding ".gitignore" to <code>.gitignore</code> works perfectly. The file is still parsed by git to ignore everything else too, so it does exactly what I needed in this instance.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/git/">git</a>, <a href="/tag/tips/">tips</a>, <a href="/tag/hack/">hack</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Filter through command</h1>
    <time datetime="2009-09-14T22:39:37+00:00">2009-09-14 22:39:37</time>
  </header>

  <p><em>This is another old post that I'm republishing. Originally published 27th April 2007.</em></p>

<p>My text editor <a href="http://macromates.com/">TextMate</a> has a nice feature called "Filter through command" whereby you can filter the current document through a command.</p>

<p>Anyway, I've never used it before, but today I had a text file with 30 or so url's in, each on a new line, so I thought I'd test it out.  I selected it to input the document &amp; to not replace the output.  I then entered the following command, which is a ruby command to take each line that isn't blank, and run the shell command <code>open $url</code>.</p>

<pre><code>ruby -e 'a = ARGF.read.scan(/\S+/); a.each { |x| `open #{x}` }'
</code></pre>

<p>What this does is take ARGF (the document) and read it in line by line, but only the non-whitespace characters (so newlines, space, etc are ignored.)  And it assigns it to an array called <code>a</code>.  What I then do is for each item of <code>a</code>, we run it past the shell command <code>open</code>, which on OS X if you pass it a URL it just opens that URL in the default browser.</p>

<p>My browser is Safari, and its set to open new links in a new tab in the foremost window.  So I ran the command, and hey presto, within a few seconds I had all the URL's loading in seperate tabs in Safari's foremost window!</p>

<p>The power of Unix <em>(OS X)</em> &amp; TextMate (amongst other tools) just never ceases to amaze me.</p>

<p><strong>Update</strong></p>

<p>I just realised if you change the regex to scan for http://.* then it'll select all website URLs.</p>

<pre><code>ruby -e 'a = ARGF.read.scan(/^http://.*$/); a.each { |url| `open #{url}` }'
</code></pre>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/code/">code</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/mac/">mac</a>, <a href="/tag/textmate/">textmate</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Mac Tips you may not know</h1>
    <time datetime="2009-08-31T13:08:48+00:00">2009-08-31 13:08:48</time>
  </header>

  <p>Here are some mac tips I know and consider "basic" mac knowledge, but no-one else seems to know.</p>

<ul>
  <li><strong>exposé</strong> key is on modern mac keyboards, looks like a load of squares on the F3 key.</li>
  <li><strong>⌘ + Exposé key</strong> =&gt; Show Desktop</li>
  <li><strong>⌃ + Exposé key</strong> =&gt; Show Application Windows</li>
  <li><strong>⌥ + Brightness keys</strong> =&gt; Open Displays prefpane in System Preferences.</li>
  <li><strong>⌥ + Exposé key</strong> =&gt; Open Exposé &amp; Spaces prefpane in System Preferences.</li>
  <li><strong>⌥ + Dashboard key</strong> =&gt; Open Exposé &amp; Spaces prefpane in System Preferences.</li>
  <li><strong>⌥ + Keyboard Backlight keys</strong> =&gt; Open Keyboard prefpane in System Preferences. <em>(Only on laptops with keyboard backlighting.)</em></li>
  <li><strong>⌥ + Volume keys</strong> =&gt; Open Sound prefpane in System Preferences.</li>
  <li><strong>⇧ + Volume keys</strong> =&gt; Adjust the volume with the feedback noise setting toggled. If you normally have feedback "blips", it'll be silent. Or vice versa.</li>
  <li><strong>⌥ + ⇧ + Volume keys</strong> =&gt; Adjust the volume in 1/4 of a usual step.</li>
  <li><strong>⌃ + Eject key</strong> =&gt; Shows the Shut Down dialog.</li>
  <li>In the shut down dialog, hit <em>R</em> to restart, <em>S</em> to sleep, <em>⎋</em> to cancel.</li>
  <li>(Pretty much) Any dialog that pops up, hitting <em>⎋</em> will push the "cancel" button.</li>
  <li>In "Show all windows" or "Show application windows" exposé modes, hit the tab key to cycle through applications.</li>
  <li>Hit the space bar in exposé to activate "Quick Look" + windows pop up to 100% size as you mouse over them.</li>
  <li>Hold down <strong>⌃ + ⇧</strong> when mousing over the dock to toggle magnification whilst the keys are down.</li>
</ul>

<p><em>(Alternative title <a href="http://www.petercooper.co.uk/">Peter Cooper</a> suggested, "A miscellany of input device co-ordinations to modulate the response of Apple's task preview and switching subsystem")</em></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/keyboard/">keyboard</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/tips/">tips</a>, <a href="/tag/os-x/">os x</a>, <a href="/tag/mac/">mac</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Education Network Restrictions</h1>
    <time datetime="2009-07-31T14:14:16+00:00">2009-07-31 14:14:16</time>
  </header>

  <p><em>This is a re-run of an old post I took offline in an old server move and hadn't re-published.</em></p>

<hr />

<p>Having been on two college systems and various university networks, I'm just amazed at the levels of freedom you have on some, and how locked down others are.</p>

<p>Take the first university network I ever used for example.  It was pretty much totally open, to the point that I could game quite freely, and the administrator only picked me up because I was logged in as admin and not a normal user.  (I didn't have an account for that machine.)</p>

<p>Going from that to my school network was a very big shock as it was moderately filtered through third party filtering software.  This meant you couldn't go on the usual <a title="Not Safe for Work" href="http://en.wikipedia.org/wiki/NSFW">NSFW</a> stuff, but still had access to other sites that could be seen as bad, such as proxy sites, or IRC java Clients for example.</p>

<p>Having moved from my old (slightly crass) college to my new one, its interesting how filtered this one is.  You can't seem to go on a site with <code>proxy</code> or <code>irc</code> in the URL, except <em>clean</em> sites like the <a title="British Broadcasting Corporation" href="http://www.bbc.co.uk/">BBC</a> or <a title="Wikipedia in English" href="http://wikipedia.org/">Wikipedia</a>.  The Proxy searching only came about through looking for web based IRC solutions.</p>

<p>Personally I think the universities have got it right.  With all the students they have, they just limit the things they definitely have to, and allow everything else.  (Blacklisting technique.)  Both colleges seem to do the opposite - block everything until its verified and unblocked.  (Whitelisting technique.)</p>

<p>The way I see it, the problem with the white listing technique is that people will always find a way around whatever restrictions are in place.  For instance, I'm locked out of all of my web based email sites, so I can't email anyone.  Its not the not being able to send that bothers me, its the not being able to save text that I've written in college to a website to then retrieve it from home that annoys me.</p>

<p>So how did I work around this restriction?  Well I remembered that Google had bought <a title="Collaborative Writing on the web" href="http://writely.com/">Writely</a> at some point recently, so one quick sign in later and I've got my own little area where I can save, organise and edit text based files.  All I have to do when I get home is login, copy / paste into my email client and hit send.</p>

<p>One word that isn't blocked yet is <code>blog</code>, so I can still post this, and edit my posts.  However, I'm still writing it in <a title="Collaborative Writing on the web" href="http://writely.com/">Writely</a> and checking my <a title="Markup HTML without HTML" href="http://daringfireball.net/projects/markdown/">markdown</a> syntax is correct with <a title="Preview and Practice MarkDown &amp; SmartyPants" href="http://daringfireball.net/projects/markdown/dingus/">Dingus</a>.  The writely interface is just that much nicer than notepad.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/security/">security</a>, <a href="/tag/education/">education</a>, <a href="/tag/college/">college</a>, <a href="/tag/school/">school</a>, <a href="/tag/network/">network</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Capitalise "ringer" on the iPhone Volume Bezel</h1>
    <time datetime="2009-06-20T15:44:04+00:00">2009-06-20 15:44:04</time>
  </header>

  <p><strong>Backstory:</strong> Got myself a first generation iPhone second hand and unlocked it to work on my existing T-Mobile (Official iPhone network in the UK is O2.) Noticed after a week or so of owning it that when you change the volume on the phone, the bezel that comes up says "ringer" across the top. But when you have headphones plugged in, it says "Headphones". <em>(Note the capitalisation difference.)</em></p>

<p>Now I'm not usually bothered by stuff like this (honest!) but as soon as I'd noticed the <em>"bug"</em>, I couldn't help but think of it everytime I changed the volume, whether I was looking at the screen or not. Seeing as I'm running a jailbroken phone, and therefore have SSH access to it, I figured the string would be defined in a .strings file somewhere in the <code>/System</code> folder. And I'd be able to change it!</p>

<p>Fast-forward a few months and I install the iPhone OS 3.0 update (jailbroken of course), and finally decide to turn the phone's SSH server on and go looking for the setting. To do so I figured I'd just need <code>grep</code> installed on the phone - I could copy the file itself to my mac and edit it there.</p>

<p>So I connect to the phone, have a poke around the filesystem and then start a search to find the correct file:</p>

<pre><code># On the iPhone
$ cd /System/Library/
$ grep -r "ringer" *
Binary file CoreServices/SpringBoard.app/English.lproj/SpringBoard.strings matches
Binary file CoreServices/SpringBoard.app/M68AP.plist matches
Binary file CoreServices/SpringBoard.app/SpringBoard matches
Binary file Frameworks/CFNetwork.framework/CFNetwork matches
Binary file Frameworks/CFNetwork.framework/da.lproj/Localizable.strings matches
Binary file Frameworks/CFNetwork.framework/no.lproj/Localizable.strings matches
Binary file Frameworks/Foundation.framework/da.lproj/URL.strings matches
</code></pre>

<p>At which point I stopped the grep search (<code>^C</code>) because I know the home screen of the iPhone is the SpringBoard.app, so I figured it would be in the file <code>SpringBoard.app/English.lproj/SpringBoard.strings</code>. Making sure to have SSH enabled on your mac, a simple <code>scp CoreServices/SpringBoard.app/English.lproj/SpringBoard.strings user@your_mac.local:</code> later and the file is sat in my home folder on my mac.</p>

<p>Switching to the mac, now I try and open the file with TextMate, only to realise its in binary format. I need it in the nice XML format to edit it, so a quick google later and I've found a hint on <a href="http://macosxhints.com">MacOSXHints</a> telling me how to convert from <a href="http://www.macosxhints.com/article.php?story=20050430105126392">binary to xml plist format</a>.</p>

<pre><code># On the mac
$ plutil -convert xml1 SpringBoard.strings
</code></pre>

<p>Then opening the file in TextMate was a bit more successful! I can actually understand what its defining now. Search through the file for "ringer" and I found the following lines:</p>

<pre><code>&lt;key&gt;RINGER_VOLUME&lt;/key&gt;
&lt;string&gt;ringer&lt;/string&gt;
</code></pre>

<p>Change the "ringer" to "Ringer" between the <code>&lt;string&gt;</code> and my editing work is complete! Yes, it really is that easy to edit an interface string that is defined in a <code>.string</code>. Now I just need to convert the file back to binary, and copy it back to the phone. Converting back to binary file is one line, just change the <code>xml1</code> in the previous command to <code>binary1</code>.</p>

<pre><code># On the mac
$ plutil -convert binary1 SpringBoard.strings
</code></pre>

<p>And then scp it back to the phone, make a backup of the existing file, and overwrite the existing file with the new one I've edited:</p>

<pre><code># On the iPhone
$ cd ~
$ scp user@mac_name.local:SpringBoard.strings .
$ cd /System/Library/CoreServices/SpringBoard.app/English.lproj/
$ mv SpringBoard.strings SpringBoard.strings.bak
$ cp ~/SpringBoard.strings SpringBoard.strings
</code></pre>

<p>And then restart the phone, either in the usual manner or just run <code>reboot</code> on the phone via SSH. Lo and behold once its rebooted and I changed the volume, it read "Ringer"!</p>

<p><img alt="Screenshot of Volume bezel" src="http://caius.name/images/ringer.jpg" /></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/picture/">picture</a>, <a href="/tag/google/">google</a>, <a href="/tag/ssh/">ssh</a>, <a href="/tag/iphone/">iphone</a>, <a href="/tag/jailbreak/">jailbreak</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Adding XHTML output validation to Cucumber stories</h1>
    <time datetime="2009-06-16T10:19:11+00:00">2009-06-16 10:19:11</time>
  </header>

  <p>At the 2009 <a href="http://barcampleeds.com/">Barcamp Leeds</a> I attended a talk by <a href="http://neilcrosby.com/vcard/">Neil Crosby</a> where he talked about automated testing, and about how he felt there was a gap in everything that people were testing. Everyone has unit tests, and people are doing full stack testing too, but no-one (so he feels) does XHTML/CSS/JS validation as part of their automated test suite. And certainly from what I've seen on the mainstream Ruby site's about testing, I agreed with him.</p>

<p>So after his talk I had a quick look at his <a href="http://github.com/NeilCrosby/frontend-test-suite/tree/master">frontend test suite</a>, and started wondering where exactly I would fit frontend validation testing into my workflow. Would it be part of my unit tests (RSpec), or part of the full stack tests (Cucumber)? As you've probably guessed by the title of this post, its ended up going into my cucumber tests. Since the initial play its been something I've mused about occasionally, but not something I've actively looked into how to implement as part of my test workflow.</p>

<p>Fast-forward a few weeks from <a href="http://barcampleeds.com/">Barcamp Leeds</a> and I see a news article in my feed reader entitled <a href="http://tenderlovemaking.com/2009/06/12/easy-markup-validation/">"Easy Markup Validation"</a> which gets me hopeful someone's solved this frontend validation thing easily for Rubyists. A quick read through and I'm sold on it and installing the gem. Opened an existing project I'm working on which has a fairly extensive test suite (both unit tests &amp; full stack tests) and tried to slot the validation into my controller unit tests.</p>

<p>Problem with doing this is by default RSpec-rails doesn't generate the views in your controller specs. At that point I realised I was already generating the full page when I was doing a full stack test using <a href="http://github.com/langalex/culerity/tree/master">culerity</a> and <a href="http://cukes.info/">cucumber</a>. So why not just add a cucumber step in my stories to validate the HTML on each page I visit? Mainly because its not enough of a failure for this app to have invalid XHTML markup. Having valid markup would be nice, but I'd rather have it as a separate test to my stories in some way.</p>

<p>Currently I just do that by only validating if <code>ENV["VALIDATION"]</code> is set to anything, so a normal run of my cucumber stories will just test the app does what its supposed to do. If I run them with <code>VALIDATION=true</code> then it will check my markup is valid as well.</p>

<p><strong>features/support/env.rb</strong></p>

<pre><code>require "markup_validity" if ENV["VALIDATION"]
</code></pre>

<p><strong>features/step_definitions/general_steps.rb</strong></p>

<pre><code>Then %r/the page is valid XHTML/ do
  $browser.html.should be_xhtml_strict if ENV["VALIDATION"]
end
</code></pre>

<p><strong>features/logging_in.feature</strong></p>

<pre><code>Feature: Logging in
  In order to do stuff
  As a registered user
  I want to login

  Scenario: Successful Login
    Given there is a user called "Caius"

    When I goto the homepage
    Then the page is valid XHTML

    When I click on the "Login" link
    Then I am redirected to the login page
    And the page is valid XHTML

    When I enter my login details
    And I click "Login"
    Then I am redirected to my dashboard
    And the page is valid XHTML
</code></pre>

<p>Now when I run <code>cucumber features/logging_in.feature</code>, it doesn't validate the HTML, it just makes sure that I can login as my user and that I am redirected to the right places. But if I run <code>VALIDATION=true cucumber features/logging_in.feature</code>, then it <em>does</em> validate my XHTML on the homepage, the login page and on the user's dashboard. If it fails validation then it gives you a fairly helpful error message as to what it was expecting and what it found instead.</p>

<p>From a quick run against a couple of stories in my app I discovered that I've not been wrapping form elements in an enclosing element, so they've been quickly fixed and now they validate. Now I realise this gem is only testing XHTML output, and doesn't include CSS or JS validation, but from a quick peek at the gem's source it should be fairly easy to add both of those in I think, although again they aren't major errors for me yet in this app.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/php/">php</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/link/">link</a>, <a href="/tag/brightbox/">brightbox</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/rspec/">rspec</a>, <a href="/tag/cucumber/">cucumber</a>, <a href="/tag/rubygems/">rubygems</a>, <a href="/tag/culerity/">culerity</a>, <a href="/tag/validation/">validation</a>, <a href="/tag/testing/">testing</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Quantum Javascript Bug</h1>
    <time datetime="2009-06-04T15:12:24+00:00">2009-06-04 15:12:24</time>
  </header>

  <p>So I've got some js I've written to update a couple of <code>&lt;select&gt;</code> lists in a form, and it was all working fine for me (under Safari.) <a href="http://johnleach.co.uk/">John</a> happened to mention it wasn't working for him under Firefox, so I fired up Firefox and took a look. Could reproduce it perfectly, changing the first popup was populating the second one, but then wasn't selecting the right value from the list.</p>

<p>Having no idea what was happened I figured I'd enable firebug and watch it execute to figure out what was happening. Enabled firebug, reloaded the page, selected from the first popup… and <strong>voila!</strong> It updated the second one and selected the correct row! WTF!!!</p>

<p>Turned firebug off and it didn't work, turned it back on and it worked. Figured it might be something buggy in the Firefox 3.0.5 js runtime, so I grabbed a copy of the new <a href="http://www.mozilla.com/en-US/firefox/all-beta.html">beta 3.5</a> and tried it in there—still failed to update the page as it should.</p>

<p>Then started poking around the javascript code, the function that was seemingly failing to run was being triggered by a setTimeout() call set to 1 second. We figured it might be the timing causing it, so started playing around with the time, tried anything from ½ a second up to 4 seconds but still no joy in firefox with firebug turned off.</p>

<p>Then <a href="http://johnleach.co.uk/">John</a> went looking for the javascript errors in firefox (with firebug off) and discovered that it was throwing an error because <code>window.console</code> didn't exist. All of a sudden it made perfect sense! Safari has <code>window.console.log()</code> for writing to the console log, as does firebug. But of course firefox <em>without</em> firebug doesn't!</p>

<p>So the function was just exiting on that error. It was very weird initially to have it work perfectly as soon as the developer tools were enabled!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/code/">code</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/javascript/">javascript</a>, <a href="/tag/firefox/">firefox</a>, <a href="/tag/safari/">safari</a>, <a href="/tag/firebug/">firebug</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Automatically Deploying Website From Remote Git Repository</h1>
    <time datetime="2009-05-30T02:30:40+00:00">2009-05-30 02:30:40</time>
  </header>

  <p>Before I start, I'll just quickly run through where I put stuff on my server. Apache logs and config are in the ubuntu default folders: <code>/var/log/apache2</code> and <code>/etc/apache2/</code> respectively.</p>

<pre><code>Websites:  /home/caius/vhosts/&lt;domain name&gt;/htdocs
Git Repos: /home/caius/git/&lt;domain name&gt;.git
</code></pre>

<p>So I have a git repo locally, <code>~/projects/somesite.com/</code>, and want to deploy it to my webserver. I'll keep the git repo in <code>~/git/</code> and set it up so that when I push to the repo <em>(over ssh)</em> it will automatically checkout the new changes into the website's htdocs folder.</p>

<p>I'm assuming DNS is already setup (or I've used <a href="http://github.com/bjeanes/ghost/tree/master">ghost</a> to map it locally.) And that I've setup the virtualhost in apache pointing at <code>/home/caius/vhosts/somesite.com/htdocs</code> and reloaded apache so the config is in place.</p>

<h2 id="remote-machine">Remote Machine</h2>

<p>We create a bare git repo, then point the working tree at the docroot of our website. This means all the git stuff is kept in the <code>somesite.git</code> folder, but the files themselves are checked out to the website's folder. Then we setup a post-receive hook to update the worktree folder after new changes have been pushed to the repo.</p>

<pre><code>$ cd git
$ mkdir somesite.git
$ cd somesite.git/
$ git init --bare
Initialized empty Git repository in /home/caius/git/somesite.git/
$ git --bare update-server-info
$ git config core.worktree /home/caius/vhosts/somesite.com/htdocs
$ git config core.bare false
$ git config receive.denycurrentbranch ignore
$ cat &gt; hooks/post-receive
#!/bin/sh
git checkout -f
^D
$ chmod +x hooks/post-receive
</code></pre>

<h2 id="local-machine">Local Machine</h2>

<p>And now on the client machine we add the remote repo as a git remote, and then push to it.</p>

<pre><code>$ git remote add web ssh://myserver/home/caius/git/somesite.git
$ git push web +master:refs/heads/master
Counting objects: 3, done.
Writing objects: 100% (3/3), 229 bytes, done.
Total 3 (delta 0), reused 0 (delta 0)
To ssh://myserver/home/caius/git/somesite.git
 * [new branch]      master -&gt; master
</code></pre>

<h2 id="all-done">All Done</h2>

<p>And now if you go to <em>somesite.com</em> you'll see the contents of your git repo there. (<em>somesite.com</em> is just an example url though, I don't actually own it!)</p>

<h3 id="helpful-urls">Helpful URLs</h3>

<ul>
  <li><a href="http://toroid.org/ams/git-website-howto">http://toroid.org/ams/git-website-howto</a></li>
  <li><a href="http://www.mblondel.org/journal/2008/05/25/git-memo/">http://www.mblondel.org/journal/2008/05/25/git-memo/</a></li>
  <li><a href="http://tatey.com/2009/04/29/jekyll-meets-dreamhost-automated-deployment-for-jekyll-with-git.html">http://tatey.com/2009/04/29/jekyll-meets-dreamhost-automated-deployment-for-jekyll-with-git.html</a></li>
</ul>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/git/">git</a>, <a href="/tag/website/">website</a>, <a href="/tag/deployment/">deployment</a>, <a href="/tag/ssh/">ssh</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Find shell commands with which</h1>
    <time datetime="2009-04-19T15:02:04+00:00">2009-04-19 15:02:04</time>
  </header>

  <p>So I have this command in my $PATH, <code>apachectl</code>. Because I'm on a mac and I've installed apache2 through <a href="http://macports.org/">MacPorts</a>, the command that gets found first is my macports install in <code>/opt</code>. Up until now I've always known that <code>which apachectl</code> will find that location, but to find any other locations of <code>apachectl</code> I'd usually use <code>locate</code> and <code>egrep</code> together.</p>

<p>Here's my original workflow, lets find the location of the <code>apachectl</code> being called when I don't specify a path.</p>

<pre><code>Julius:~ caius$ which apachectl
/opt/local/apache2/bin/apachectl
</code></pre>

<p>Simple enough. Now lets figure out what other locations there's an <code>apachectl</code> installed at.</p>

<pre><code>Julius:~ caius$ locate apachectl | egrep "\/apachectl$"
/opt/local/apache2/bin/apachectl
/opt/local/var/macports/software/apache2/2.2.11_0+darwin_9/opt/local/apache2/bin/apachectl
/usr/sbin/apachectl
</code></pre>

<p>Right, so now I know where else a command exists in the filesystem called <code>apachectl</code>, but I don't know if any of those is in my $PATH, or what order they come in when searching through my $PATH. In this (old) workflow I'd have compared them to my $PATH manually as there's so few of them.</p>

<p>So I noticed <a href="http://awhitebox.com">Ali</a> googling for the <code>which</code> man page on IRC, and <em>(quite stupidly)</em> poked fun at him for doing so. I then swallowed my ego and actually followed the link to the man page, and boy was I glad I did. Just shows with even a fairly simple command like <code>which</code>, you sure don't know everything!</p>

<p>What I discovered was that <code>which</code> has a single flag you can pass it, <code>-a</code>. From the <a href="http://unixhelp.ed.ac.uk/CGI/man-cgi?which">man page</a>:</p>

<pre><code>-a     print all matching pathnames of each argument
</code></pre>

<p>Right. So that <code>locate | grep</code> command plus manually figuring out what is in my $PATH is really hard work then. <code>which -a</code> should give us the same results, but a lot faster and with a lot less manual thought.</p>

<pre><code>Julius:~ caius$ which -a apachectl
/opt/local/apache2/bin/apachectl
/usr/sbin/apachectl
</code></pre>

<p>And hey presto, yet another useful bit of bash knowledge for me, thanks to <a href="http://awhitebox.com">Ali</a> not being afraid to <acronym title="Read the Fucking Manual">RTFM</acronym>!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/link/">link</a>, <a href="/tag/google/">google</a>, <a href="/tag/macports/">macports</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Validating Data with Regular Expressions in Ruby</h1>
    <time datetime="2009-04-11T12:41:48+00:00">2009-04-11 12:41:48</time>
  </header>

  <p>I happened to be sent a link to the <a href="https://www.owasp.org/index.php/Main_Page">OWASP</a> paper on <a href="https://www.owasp.org/images/8/89/Rails_Security_2.pdf">Rails Security</a> recently and started reading it. Partway in there's a section on Regular Expressions, which opens with the following line:</p>

<blockquote>
  <p>A common pitfall in Ruby's regular expressions is to match the string's beginning and end by <code>^</code> and <code>$</code>, instead of <code>\A</code> and <code>\z</code>.</p>
</blockquote>

<p>Now I've never used <code>\A</code> and <code>\z</code> in my regular expressions to validate data, I've only ever used <code>^</code> and <code>$</code> assuming they matched the start and end of the string. This becomes an issue with validating data in rails, because <code>%0A</code> (<code>\n</code> URL encoded) is decoded by rails before passing the string to your model to validate.</p>

<h2 id="testing-our-expectations">Testing our expectations</h2>

<p>Lets say we want to validate the string as a username for our app. A username is 5 characters long and consists only of lowercase letters.</p>

<pre><code>regex = /^[a-z]{5}$/
</code></pre>

<p>First we make sure it matches the data we want it to:</p>

<pre><code>"caius".validate(regex) =&gt; true
</code></pre>

<p>Excellent, that validated. Now we'll try a shorter string, which we expect to fail.</p>

<pre><code>"cai".validate(regex) =&gt; false
</code></pre>

<p>Once more, it behaves how we expected it to. The shorter string was rejected as we wanted it to be. Now, what happens if we test a string with a newline character in it? We'll make sure the data before the <code>\n</code> is valid, and then add some more data after the newline.</p>

<pre><code>"caius\nfoo".validate(regex) =&gt; true
</code></pre>

<p>Uh oh! That validated and would've been saved as a username?!</p>

<p>Lets have a look at exactly what's happening there, the <code>$</code> matches the <code>\n</code> character, so the regex is only matching the first 5 characters of the string, and just ignores anything after the <code>\n</code>. As it turns out, this is exactly what we've asked the regex to match, but we didn't want this behaviour.</p>

<p>Now you might be thinking, "So what? someone can have a username with a newline in it." For starters this will probably display weirdly anywhere you use their username, but more importantly it opens your application to an injection attack. Suppose they took advantage of this by setting their username to include some javascript on the page which stole your login cookie and sent it to them. You view their account in the admin section and oh no! They can login as your admin account and do what they want.</p>

<p>Simple example of this is just having it output an alert dialog. <em>(This is actually the code I'll use to test an application as its not malicious, but blindingly obvious if the javascript is executed or not.)</em></p>

<pre><code>"caius\n&lt;script&gt;alert('hello')&lt;/script&gt;".validate(regex) =&gt; true
</code></pre>

<p>Ok, so that was the result we were expecting this time, although it's still not the outcome we wanted. Anytime their username is viewed (providing you aren't escaping the data to HTML entities) you'll see the following:</p>

<p><img alt="javascript alert dialog" src="http://caius.name/images/qs/javascript-alert-dialog.png" /></p>

<h2 id="the-solution">The Solution</h2>

<p>Having realised from our testing above that ^$ matches the beginning/end of a <em>line</em> in ruby not the beginning and end of a <em>string</em>, I hear you cry, "How do we make sure we're matching the entire string?!"</p>

<p>The answer is pretty simple. Just swap out <code>^$</code> for <code>\A\z</code>. Lets go ahead and try this with the same data as we have above, but with the modified regular expression.</p>

<pre><code>new_regex = /\A[a-z]{5}\z/
"caius".validate(new_regex) =&gt; true
</code></pre>

<p>That's a good start, the valid string still matches.</p>

<pre><code>"cai".validate(new_regex) =&gt; false
</code></pre>

<p>Looks like it's going well, invalid string is invalid.</p>

<pre><code>"caius\nfoo".validate(new_regex) =&gt; false
</code></pre>

<p>Oh Excellent! It's validating this one correctly now.</p>

<p>And just for consistency, lets test it with a more likely attack string.</p>

<pre><code>"caius\n&lt;script&gt;alert('hello')&lt;/script&gt;".validate(new_regex) =&gt; false
</code></pre>

<p>Fantastic! We've fixed the security hole in our validation of the user's username.</p>

<hr />

<p>If you want to actually run the code above you'll need the following at the start of the ruby script to patch the validate method into String.</p>

<pre><code>class String
  def validate regex
    !self[regex].nil?
  end
end
</code></pre>

<p><strong><em>Update:</em></strong> I had <code>\Z</code> in the <code>new_regex</code> rather than the <code>\z</code> it should've been. Thanks <a href="http://ciaranwal.sh/">Ciarán</a>.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/security/">security</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Safari 4 Hidden Preferences</h1>
    <time datetime="2009-02-24T16:11:05+00:00">2009-02-24 16:11:05</time>
  </header>

  <p><strong>Updated 2009-06-09:</strong> This post is for the Safari 4 <strong>beta</strong> and will not work with the new Safari 4 released yesterday at the WWDC keynote. I've had a look through that release and can't see any way to revert the address bar, etc sorry.</p>

<hr />

<p>Having a quick poke through the new Safari binary yields the following strings:</p>

<pre><code>$ strings /Applications/Safari.app/Contents/MacOS/Safari | grep DebugSafari4
DebugSafari4TabBarIsOnTop
DebugSafari4IncludeToolbarRedesign
DebugSafari4IncludeFancyURLCompletionList
DebugSafari4IncludeGoogleSuggest
DebugSafari4LoadProgressStyle
DebugSafari4IncludeFlowViewInBookmarksView
DebugSafari4TopSitesZoomToPageAnimationDimsSnapshot
DebugSafari4IncludeTopSites
</code></pre>

<p><em>NB: Run these commands in Terminal.app and then you need to restart Safari for them to take effect.</em></p>

<h3 id="debugsafari4tabbarisontop">DebugSafari4TabBarIsOnTop</h3>

<p>This moves the tab bar back where you expect it to be:</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4TabBarIsOnTop -bool NO
</code></pre>

<h3 id="debugsafari4includetoolbarredesign-and-debugsafari4loadprogressstyle">DebugSafari4IncludeToolbarRedesign and DebugSafari4LoadProgressStyle</h3>

<p>When both set to NO it restores the blue loading bar behind the URL. <em>Also puts a page loading spinner in the tab itself, which looks odd with the new tabs.</em></p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4IncludeToolbarRedesign -bool NO
$ defaults write com.apple.Safari DebugSafari4LoadProgressStyle -bool NO
</code></pre>

<h3 id="debugsafari4includefancyurlcompletionlist">DebugSafari4IncludeFancyURLCompletionList</h3>

<p>Switches off the new URL autocomplete menu and goes back to the original one.</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4IncludeFancyURLCompletionList -bool NO
</code></pre>

<h3 id="debugsafari4includegooglesuggest">DebugSafari4IncludeGoogleSuggest</h3>

<p>Turns off the new Google suggest menu.</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4IncludeGoogleSuggest -bool NO
</code></pre>

<h3 id="debugsafari4includeflowviewinbookmarksview">DebugSafari4IncludeFlowViewInBookmarksView</h3>

<p>Removes CoverFlow from the Bookmarks view entirely. (<a href="http://twitter.com/iacas/status/1245800183">Credit</a> to <a href="http://nslog.com/">Erik</a>)</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4IncludeFlowViewInBookmarksView -bool NO
</code></pre>

<h3 id="debugsafari4topsiteszoomtopageanimationdimssnapshot">DebugSafari4TopSitesZoomToPageAnimationDimsSnapshot</h3>

<p>Disables the dimming when you click on a Top Site and it scales the screenshot up to fill the screen.</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4TopSitesZoomToPageAnimationDimsSnapshot -bool NO
</code></pre>

<h3 id="debugsafari4includetopsites">DebugSafari4IncludeTopSites</h3>

<p>Disables Top Sites feature completely.</p>

<pre><code>$ defaults write com.apple.Safari DebugSafari4IncludeTopSites -bool NO
</code></pre>

<h2 id="undoing-changes">Undoing changes</h2>

<p>Just run the defaults command with the <code>delete</code> flag for the appropriate key you wish to delete.</p>

<pre><code>$ defaults delete com.apple.Safari &lt;key&gt;
</code></pre>

<p><em>NB: Don't include the <code>-bool NO</code> at the end, it just requires the key (eg: "DebugSafari4IncludeGoogleSuggest")</em></p>

<h3 id="update-2009-02-26">Update 2009-02-26</h3>

<p><a href="http://swedishcampground.com/safari-4-hidden-preferences#comment-3265">Jools points out in the comments</a> how to reset the recent searches in the google search box.</p>

<h3 id="update-2009-05-26">Update 2009-05-26</h3>

<p>Lowell's kindly created a Mac OS X application to edit these settings without using Terminal. <a href="http://github.com/cocoastep/tweaky">http://github.com/cocoastep/tweaky</a></p>

<h3 id="update-2010-11-18">Update 2010-11-18</h3>

<p>Patric has kindly <a href="http://www.movavi.com/opensource/safari-4-hidden-preferences-be">translated this post into Belorussian</a> and posted it on his site.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/objective-c/">objective-c</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Migrating Rubygems to Ruby 1.9.x</h1>
    <time datetime="2009-01-31T20:29:57+00:00">2009-01-31 20:29:57</time>
  </header>

  <p>So I just installed ruby 1.9.1 through <a href="http://macports.org/">MacPorts</a> and wanted to easily migrate my rubygems across from 1.8 to see which ones would fail to install.</p>

<p>Thought about it for a while, then came up with the following bash one-liner to do it:</p>

<pre><code>gem list | grep "(" | awk '{ print $1 }' | xargs -L 1 gem1.9 install
</code></pre>

<p><strong>NB:</strong> Installing Ruby 1.9.1 through macports <code>sudo port install ruby19</code> means I get <code>ruby1.9</code>, <code>gem1.9</code> and <code>rake1.9</code> installed alongside my usual 1.8 <code>ruby</code>, <code>gem</code> and <code>rake</code>.</p>

<p>That grabs the list of installed gems from <code>gem</code>, searches for lines containing "(" so it only grabs the gem names, spits out the first section of the line, which is the name of the gem, and finally calls <code>gem1.9 install</code> for each line via <code>xargs -L 1</code>. Make sure to run it as root or prefix <code>gem1.9</code> with <code>sudo</code>. <em>(Or let it install in your home folder, but I hate that.)</em></p>

<p>From my quick run of the above snippet, 75% of my gems installed <em>(73 out of 98)</em> and the other few that failed to install were ones like <a href="http://github.com/why/hpricot/tree/master">Hpricot</a> that require native extensions compiling. You can see the entire list of failures and successes of the gems in <a href="http://pastie.textmate.org/pastes/376136">this pastie</a></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/gem/">gem</a>, <a href="/tag/rubygems/">rubygems</a>, <a href="/tag/macports/">macports</a>, <a href="/tag/installing/">installing</a>, <a href="/tag/ruby1-9/">ruby1.9</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>View Raw Source</h1>
    <time datetime="2009-01-31T01:54:57+00:00">2009-01-31 01:54:57</time>
  </header>

  <p>So I write this blog using <a href="http://daringfireball.net/projects/markdown/">Markdown</a> because I'm a human and writing <code>stuff &lt;strong&gt;with&lt;/strong&gt; tags</code> is just <strong>WRONG</strong>. Thankfully, <a href="http://daringfireball.net/">Gruber</a> solved this problem by writing markdown.</p>

<p>Now on the <a href="http://daringfireball.net/projects/markdown/">markdown page</a> he says:</p>

<blockquote>
  <p>The best way to get a feel for Markdown’s formatting syntax is simply to look at a Markdown-formatted document. For example, you can view the Markdown source for the article text on this page here: <a href="http://daringfireball.net/projects/markdown/index.text">http://daringfireball.net/projects/markdown/index.text</a></p>
</blockquote>

<blockquote>
  <p>(You can use this ‘.text’ suffix trick to view the Markdown source for the content of each of the pages in this section, e.g. the Syntax and License pages.)</p>
</blockquote>

<p>And ever since I noticed that I've always read his articles using the '.text' trick. One of the plugins I've been meaning to write for <a href="http://habariproject.org/">habari</a> is one that replicates this '.text' behaviour. So tonight I decided to try and write it, started picking through the <a href="http://wiki.habariproject.org/en/Creating_A_Plugin">Plugin documentation</a> in preparation. Got a bit stuck with it as I've been out of the habari development loop for a few months, popped into <a href="irc://irc.freenode.net/#habari">#habari</a> and asked if I was thinking along the right lines.</p>

<p>Few minutes later <a href="http://asymptomatic.net/">Owen</a> pops up and sends me a link to <a href="http://svn.habariproject.org/habari-extras/plugins/plaintext/trunk/plaintext.plugin.php">plaintext.plugin.php</a>, which does exactly what I was trying to do! Couple of tweaks later (switching it to '.text' instead of '.md') and its installed and working on this blog. Feel free to view the <a href="http://caiustheory.com/view-raw-source.text">raw source</a> of this post. Or any other post on this site.</p>

<h3 id="updated-2009-01-31">Updated 2009-01-31</h3>

<p>Added to the habari-extras repo as the <a href="http://svn.habariproject.org/habari-extras/plugins/plaintext/trunk/plaintext.plugin.php">Plaintext</a> plugin.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/php/">php</a>, <a href="/tag/code/">code</a>, <a href="/tag/habari/">habari</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/markdown/">markdown</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>This is my Compiler</h1>
    <time datetime="2009-01-30T12:18:56+00:00">2009-01-30 12:18:56</time>
  </header>

  <p>As some friday fun in <a href="http://twitter.com/geekupirc">#geekup</a> we ended up converting the <a href="http://usmilitary.about.com/od/marines/l/blriflecreed.htm">US Marines Creed</a> to a geekier version.</p>

<blockquote>
  <p>This is my compiler.<br />
There are many like it, but this one is MINE.<br />
My compiler is my best friend. It is my life.<br />
I must master it as I must master my life.<br />
My compiler without me is useless. Without my compiler, I am useless.<br />
I must run my compiler true.<br />
I must run faster than my bug who is trying to kill me.<br />
I must squash him before he squashes me. I will…<br />
My compiler and myself know that what counts in war is not the warnings we squash,<br />
the builds we create, nor the optimisations we make.<br />
We know it is the build errors fixed that count. We will fix…<br />
My compiler is human, even as I, because it is my life.<br />
Thus, I will learn it as a brother.<br />
I will learn its weaknesses, its strengths, its output, its code,<br />
its quirks, and its errors.<br />
I will ever guard it against the ravages of virii and disk failures.<br />
I will keep my compiler clean and ready, even as I am clean and ready.<br />
We will become part of each other. We will…<br />
Before Assembler I swear this creed.<br />
My compiler and myself are the defenders of good code.<br />
We are the masters of our bugs.<br />
We are the saviors of our code.<br />
So be it, until code is compiling and there are no bugs, but compiled code.</p>
</blockquote>

<p>And then <a href="http://jamx.org/">jamx</a> jumped in with the <a href="http://en.wikipedia.org/wiki/Lord's_Prayer#English_versions">Lords Prayer</a></p>

<blockquote>
  <p>Our Compiler, who art in memory. GNU be thy name.<br />
Thy source code come, thy will be done.<br />
On script as it is in memory.<br />
Give us this day our daily data, and forgive us our segfaults as we forgive those who segfault against us.<br />
And lead us not into /dev/null but deliver us from M$,<br />
for thine is the domain, the cpu and the peeps.<br />
for (x=0; x&lt;2; x++){ x=0; }<br />
Amen</p>
</blockquote>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/funny/">funny</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/social/">social</a>, <a href="/tag/lords-prayer/">lords prayer</a>, <a href="/tag/marine-creed/">marine creed</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Install Mysql Gem on Leopard</h1>
    <time datetime="2009-01-21T17:09:41+00:00">2009-01-21 17:09:41</time>
  </header>

  <p>So, I keep having to reinstall mysql5 and rubygems from time to time for various reasons. I always install mysql5 through <a href="http://macports.org/">MacPorts</a> as a dependency for the php5 port (along with various other bits for the LA*P stack).</p>

<pre><code>sudo port install php5 +mysql5 +pear +readline +sockets +apache2 +sqlite
</code></pre>

<p>Once this is installed then I have <code>mysql</code> and can setup my databases, etc.</p>

<p>Ignoring the rest of the LAMP stack, I then need to connect Ruby to the Mysql I just installed through MacPorts. Its quite simple to do, once you know the right argument to pass to it. The easiest way is to just tell it where the <code>mysql5_conf</code> file is and let it figure out the rest for itself.</p>

<pre><code>sudo gem install mysql -- --with-mysql-config=/opt/local/bin/mysql_config5
</code></pre>

<p>Hopefully this will save me 10 minutes of googling next time I need to do this!</p>

<h3 id="update-2009-01-21">Update 2009-01-21</h3>

<p>I'm an idiot and typed the <code>gem install</code> command by hand, and ended up with <code>--with-mysql-conf</code> instead of <code>--with-mysql-config</code>. Updated now.</p>

<h3 id="update-2009-10-19">Update 2009-10-19</h3>

<p>On Snow Leopard I needed to tell rubygems to install the gem as a 64-bit binary. Hattip to <a href="http://www.schmidp.com/2009/06/14/rubyrails-and-mysql-on-snow-leopard-10a380/comment-page-1/">Philipp</a></p>

<pre><code>sudo env ARCHFLAGS="-arch x86_64" gem install mysql -- --with-mysql-config=/opt/local/bin/mysql_config5
</code></pre>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/gem/">gem</a>, <a href="/tag/rubygems/">rubygems</a>, <a href="/tag/google/">google</a>, <a href="/tag/macports/">macports</a>, <a href="/tag/mysql/">mysql</a>, <a href="/tag/installing/">installing</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>GTranslate</h1>
    <time datetime="2009-01-04T09:40:59+00:00">2009-01-04 09:40:59</time>
  </header>

  <p>I finally wrapped up some code I've been meaning to write for a while, its a wrapper for the <a href="http://translate.google.com/">Google Translate API</a>. Its also the first serious time I've used <code>method_missing</code> in a class, in this case its to add methods for translating between all the various languages.</p>

<p>Its fairly simple to use, there is an <a href="http://github.com/caius/gtranslate/tree/master/examples.rb">examples.rb</a> included with it, but the basic usage is just this:</p>

<pre><code># Convert from english to french
Google::Translate.english_to_french( "Hello" ) # =&gt; "Bonjour"

# There is also a short(er)-hand version
Google::Tr.en_to_fr( "Hello" )
</code></pre>

<p>As per usual with all my code its available on my <a href="http://github.com/caius/">github account</a>, as the <a href="http://github.com/caius/gtranslate/">GTranslate</a> project. I'll throw some specs together for it and package it up as a gem soon.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/gtranslate/">gtranslate</a>, <a href="/tag/google/">google</a>, <a href="/tag/translation/">translation</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>The Shell Meme</h1>
    <time datetime="2008-12-30T18:29:35+00:00">2008-12-30 18:29:35</time>
  </header>

  <p>I ran across <a href="http://lstoll.net/2008/04/shell-meme/">The Shell Meme</a> on <a href="http://lstoll.net/">Lincoln Stoll's</a> blog, and figured I'd, uh, <em>borrow</em> it.</p>

<p>Run this command in a new shell:</p>

<pre><code>history|awk '{a[$2]++} END{for(i in a){printf "%5d\t%s\n ",a[i],i}}'|sort -rn|head
</code></pre>

<p>I get this as the output</p>

<pre><code>379    git
221    cd
181    ssh
77    sudo
69    ruby
66    ls
34    rake
33    m
32    bb
31    m.
</code></pre>

<p><code>bb</code> changes directory straight into my <a href="http://www.brightbox.co.uk/">BrightBox</a> source directory. <code>m</code> and <code>m.</code> are <a href="http://macromates.com/">TextMate</a> alias's to open files or directories in TextMate for editing.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/brightbox/">brightbox</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Sending Array elements as individual arguments in Ruby</h1>
    <time datetime="2008-12-26T07:25:15+00:00">2008-12-26 07:25:15</time>
  </header>

  <p>Lets imagine we've got an array of strings, and we want to print it out as a list of strings using printf. <em>(If you're complaining about my logic here, hold fire for just a second good sir/madam.)</em></p>

<p>So we start off with the array of strings, and then pass it to printf with the right amount of <code>%s</code>'s in the format string:</p>

<pre><code>arr = ["one", "two", "three"]

printf "%s, %s, %s", arr
# ~&gt; -:3:in `printf': too few arguments (ArgumentError)
# ~&gt;     from -:3
</code></pre>

<p>Oh whoops, we've actually only passed <code>"%s, %s, %s", ["one", "two", "three"]</code> to printf. So of course it whinges about not getting enough arguments. Now how do we fix this, how <strong>do</strong> we pass an array with each element a seperate argument to a method?</p>

<p>We use the <code>*</code> of course! Just prefix the variable name with <code>*</code> and the method is passed each element as separate arguments, rather than the whole array as one arguement.</p>

<p>Going back to our <code>printf</code> example above, we simply insert one character <em>(the lowly <code>*</code>)</em> and end up with a string being outputted.</p>

<pre><code>printf "%s, %s, %s", *arr
# &gt;&gt; one, two, three
</code></pre>

<p>Now I realise this is a partially stupid example, but it serves to explain the point I wanted to make. If you were complaining about my choice of printf earlier, here is the way I think most rubyists would solve this problem instead.</p>

<pre><code>arr = ["one", "two", "three"]

print arr.join(" ")
# &gt;&gt; one two three
</code></pre>

<p>And if I wanted to be slightly cleverer with the <code>printf</code> version, and print out an array containing an unknown number of strings, but of a set width, then I could do the following. <em>(NB: This is actually how I ran into this problem.)</em></p>

<pre><code>arr = ["one", "two", "three"]

printf arr.map { "%6s" }.join, *arr
# &gt;&gt;    one   two three
</code></pre>

<p>And that is where the lowly <code>*</code> comes in.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Merry Testing</h1>
    <time datetime="2008-12-25T15:01:54+00:00">2008-12-25 15:01:54</time>
  </header>

  <p>Just a few examples of the same test written in a few languages. Its testing setting the date on an object that is created in the tests' setup method already. These fall under the unit testing, rather than full-stack testing.</p>

<h3 id="testing-in-objc-with-ocunithttpwwwsentechsoftwareocunit">Testing in ObjC with <a href="http://www.sente.ch/software/ocunit/">OCUnit</a></h3>

<pre><code>// Add a date and time
- (void)testSettingDate
{    
    NSDate *theDate = [NSDate date];        
    
    STAssertNoThrow([calc setDate:theDate], @"Shouldn't raise an exception");
    // And it should match when pulled out as well
    STAssertEqualObjects([calc date], theDate,
                         @"%@ should match %@",
                         [calc date], theDate);

}
</code></pre>

<h3 id="testing-in-ruby-using-rspechttprspecinfo">Testing in Ruby using <a href="http://rspec.info/">RSpec</a></h3>

<pre><code>it "should set the date successfully" do
  the_date = Date.today

  @calc.date = the_date
  # And it should match when pulled out as well
  @calc.date.should == the_date
end
</code></pre>

<h3 id="testing-in-ruby-using-testunithttpwwwruby-docorgstdliblibdoctestunitrdocclassestestunithtml">Testing in Ruby using <a href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/classes/Test/Unit.html">Test::Unit</a></h3>

<pre><code>def test_setting_date
  the_date = Date.today
  @calc.date = the_date
  # And it should match when pulled out as well
  assert_equal(@calc.date, the_date)
end
</code></pre>

<h3 id="testing-in-php-using-phpunithttpphpunit">Testing in PHP using <a href="http://phpun.it/">PHPUnit</a></h3>

<pre><code>function testSettingDate()
{
    $date = date();
    $calc-&gt;date = $date;
    # And it should match when pulled out as well
    $this-&gt;assertEquals($calc-&gt;date, $date);
}
</code></pre>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/php/">php</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/rspec/">rspec</a>, <a href="/tag/phpunit/">phpunit</a>, <a href="/tag/objective-c/">objective-c</a>, <a href="/tag/ocunit/">ocunit</a>, <a href="/tag/test-unit/">test::unit</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Think Visibility: An Online Marketing Conference</h1>
    <time datetime="2008-12-20T13:48:05+00:00">2008-12-20 13:48:05</time>
  </header>

  <p>Now I'm not one for blogging about events usually—if I'm attending one then I'll just talk about it on <a href="http://twitter.com/caius">twitter</a> quite a bit beforehand. However, seeing as this one is being organised by my housemate and I like to keep him in a good mood so he doesn't do something daft like change the locks, I figured I'd blog about this one. <em>(Also its really rather a good idea, I'll be paying to attend and think he's bloody mad to organise a conference!)</em></p>

<p>The conference is <a href="http://www.thinkvisibility.com/">Think Visibility</a>, which is a</p>

<blockquote>
  <p>one-day mini conference with a focus on the areas of web development and marketing which are usually left behind in the creation process: SEO, PPC, Monetisation, Blogging, Accessibility and Usability.</p>
</blockquote>

<p>The <a href="http://www.thinkvisibility.com/speakers.html">speaker line-up</a> has rather a lot of big names in it if you follow the SEO/Online marketing world, and its only £30 to turn up for the day and listen to them speak. Oh, and theres an afterparty with free drinks <em>(Sponsor permitting)</em> where you can get drunk with your hero's. (Or something.)</p>

<p>Me, I'm attending simply because up until a year or so ago I thought SEO was a complete heap of crap, but having known <a href="http://www.thehodge.co.uk/">Dom</a> for a while, and worked for an SEO agency, I'm starting to appreciate that there is an art to it, and it is a much needed skill to run a successful website.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/leeds/">leeds</a>, <a href="/tag/uk/">uk</a>, <a href="/tag/social/">social</a>, <a href="/tag/event/">event</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Fix Mail.app crashing after 10.5.6 upgrade</h1>
    <time datetime="2008-12-17T13:58:04+00:00">2008-12-17 13:58:04</time>
  </header>

  <p>When you upgrade to Mac OS 10.5.6, Mail.app might start crashing a few seconds after starting due to the GPG Bundle.</p>

<p>The solution is to grab the updated version of the <a href="http://www.sente.ch/software/GPGMail/English.lproj/GPGMail.html">GPG bundle</a> – <a href="http://www.sente.ch/pub/beta/GPGMail_d55_Leopard.dmg">GPGMail_d55_Leopard.dmg</a></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/apple/">apple</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Quick Picture of Yourself</h1>
    <time datetime="2008-12-16T18:12:53+00:00">2008-12-16 18:12:53</time>
  </header>

  <p>Theres a meme going round the <a href="http://www.google.com/search?q=Take+a+picture+of+yourself+right+now">blogosphere</a>/<a href="http://search.twitter.com/search?q=Take+a+picture+of+yourself+right+now">twitterverse</a> recently, so I figured I'd jump on it because there aren't any pictures of me on this blog yet. And there aren't that many in my <a href="http://flickr.com/photos/caius/">flickr</a> photostream either actually.</p>

<p><img alt="Picture of Caius" title="Caius Durling" src="http://caius.name/images/qs/Me.png" /></p>

<p><em><a href="http://caius.name/images/qs/Me.png">Fullsize Picture</a></em></p>

<h2 id="instructions">Instructions</h2>

<ol>
  <li>Take a picture of yourself right now.</li>
  <li>Don’t change your clothes, don’t fix your hair… just take a picture.</li>
  <li>Post that picture with NO editing.</li>
  <li>Post these instructions with your picture.</li>
</ol>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/camera/">camera</a>, <a href="/tag/flickr/">flickr</a>, <a href="/tag/me/">me</a>, <a href="/tag/picture/">picture</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Installing Ubuntu on an iMac G3</h1>
    <time datetime="2008-12-09T08:51:48+00:00">2008-12-09 08:51:48</time>
  </header>

  <p>I decided to install ubuntu onto my iMac G3<ref>450Mhz G3, 768mb ram, 20GB Hard Drive</ref> to play around with.  Only problem was it would boot so far, then just stop at a black screen.  In googling the fix, the blog post that contains the fix is <em>slightly</em> outdated and 100% 404.</p>

<p>Here is the fix, updated for Ubuntu 6.10 Desktop PPC:</p>

<ol>
  <li>
    <p>When the screen goes black, drop to the console</p>

    <pre><code> Control - Option - F2
</code></pre>

    <p><em>(if you need to log in use the name ubuntu to log in.)</em></p>

    <pre><code> $ sudo nano /etc/X11/xorg.conf
</code></pre>
  </li>
  <li>
    <p>Change the frequencies in monitor section as follows:</p>

    <pre><code> Section “Monitor”
     Identifier “Generic Monitor”
     Option “DPMS”
     HorizSync 60-60
     VertRefresh 43-117
 EndSection
</code></pre>
  </li>
  <li>After the changes then type <code>control-o</code>, <code>return</code> (to accept the filename), then <code>control-x</code> (save and exit nano)</li>
  <li>
    <p>Restart X by running the following:</p>

    <pre><code> sudo killall gdm &amp;&amp; sudo /etc/init.d/gdm start
</code></pre>
  </li>
</ol>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/code/">code</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/modification/">modification</a>, <a href="/tag/apple/">apple</a>, <a href="/tag/imac/">imac</a>, <a href="/tag/ubuntu/">ubuntu</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>About</h1>
    <time datetime="2008-12-07T04:09:28+00:00">2008-12-07 04:09:28</time>
  </header>

  <h2 id="the-domain-name">The Domain Name</h2>

<p>This blog used to be located at <a href="http://swedishcampground.com/">SwedishCampground.com</a>, but I ended up with a better use for that name, so this got sidelined over here. I bought <a href="http://caiustheory.com/">CaiusTheory.com</a> after having someone mention it to me in parody of Chaos Theory, and decided it was fairly apt for my musings and technical waffling.</p>

<h2 id="the-author">The Author</h2>

<p>I'm a:</p>

<ul>
  <li>Mac User</li>
  <li>Developer at <a href="http://freeagent.com/">FreeAgent</a></li>
  <li><a href="http://twitter.com/caius">Twitter Addict</a></li>
</ul>

<p>Find out more about me over on my <a href="http://caius.name/">profile site</a>.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> 
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>When work just feels right</h1>
    <time datetime="2008-11-21T11:51:08+00:00">2008-11-21 11:51:08</time>
  </header>

  <p>Much like <a title="3hv" href="http://www.3hv.co.uk/">Rahoul's</a> post on <a title="Working for Brightbox" href="http://www.3hv.co.uk/blog/2008/10/16/working-for-brightbox/">knowing you're on the right path</a>, I had that moment this morning whilst we were discussing a future feature for our control panel.</p>

<blockquote>
  <p><strong>john</strong>: will I be able to superpoke our customers?<br />
<strong>john</strong>: is that in the spec?<br />
<strong>Jeremy</strong>: "John made server10 a zombie"<br />
<strong>Caius</strong>: "server10 zombified server9"<br />
<strong>Jeremy</strong>: "David has poked server19 19234 times"<br />
<strong>john</strong>: server16 messaged David "My disk is filling up and I have files I need to put somewhere, please help!"<br />
<strong>Caius</strong>: "Rahoul ended his friendship with server15"<br />
<strong>David</strong>: "server02 is now married to server05"<br />
<strong>Rahoul</strong>: server10 has sent you 12 videos of a fat man eating a cake<br />
<strong>David</strong>: server11 joined the group "KVM ftw"<br />
<strong>Caius</strong>: "server16 threw a sheep at server15"<br />
<strong>john</strong>: server03 joined the group "Centos sucks!"<br />
<strong>Caius</strong>: "server15 sent an emergency broadcast: physical movement detected"<br />
<strong>john</strong>: storage03 has logged off<br />
<strong>Caius</strong>: "x13 flew to the moon 0 times"<br />
<strong>john</strong>: disk5 in storage02 is now a zombie<br />
<strong>Jeremy</strong>: disk4 in storage02 is now a zombie<br />
<strong>Jeremy</strong>: disk3 in storage02 is now a zombie<br />
<strong>Jeremy</strong>: disk2 in storage02 is now a zombie<br />
<strong>john</strong>: storage02 was sold on ebay by Jeremy<br />
<strong>Caius</strong>: "john was sold on brightbox marketplace by storage5"</p>
</blockquote>

<p><em>(In case you don't know, I work for <a href="http://www.brightbox.co.uk/">Brightbox</a>.)</em></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/funny/">funny</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/leeds/">leeds</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/brightbox/">brightbox</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Adding a remote to existing git repo</h1>
    <time datetime="2008-11-09T18:32:55+00:00">2008-11-09 18:32:55</time>
  </header>

  <p>Usually for me this happens when I have an existing project and I setup a <a href="http://github.com/">github</a> repo for it. As part of the setup for the github project, it gives you the commands to run to add the github repo as a remote to my local git repo.</p>

<pre><code>cd existing_git_repo
git remote add origin git@github.com:caius/foo.git
git push origin master
</code></pre>

<p>The problem then is you've added the remote account, but the local master branch isn't tracking the remote master branch, so when you try and just <code>git pull</code> it will fail with a message telling you to set the remote refs up.</p>

<blockquote>
  <p>Julius:foo(master) caius$ git pull<br />
You asked me to pull without telling me which branch you<br />
want to merge with, and 'branch.master.merge' in<br />
your configuration file does not tell me either.  Please<br />
name which branch you want to merge on the command line and<br />
try again (e.g. 'git pull <repository> <refspec>').  
See git-pull(1) for details on the refspec.</refspec></repository></p>

  <p>If you often merge with the same branch, you may want to<br />
configure the following variables in your configuration<br />
file:</p>

  <pre><code>branch.master.remote = &lt;nickname&gt;
branch.master.merge = &lt;remote-ref&gt;
remote.&lt;nickname&gt;.url = &lt;url&gt;
remote.&lt;nickname&gt;.fetch = &lt;refspec&gt;
</code></pre>

  <p>See git-config(1) for details.</p>
</blockquote>

<p>The answer is to do what it says funnily enough, and add the remote refs tracking to the config file. The easiest way I've found of doing this is to edit <code>.git/config</code> and add the following at the bottom of it.</p>

<pre><code>[branch "master"]
    remote = origin
    merge = refs/heads/master
</code></pre>

<p><em>Remember to change the branch or remote names if you need to.</em></p>

<p>Once you've added that to the config you can run <code>git pull</code> on the master branch and it'll do the usual automagical thing and pull the remote master branch changes into the local one!</p>

<h4 id="updated-2008-11-09">Updated 2008-11-09</h4>

<p>See CiarÃƒÂ¡n's comment below for an all-inclusive command to do the above.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/git/">git</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Removing non-existent source from rubygems</h1>
    <time datetime="2008-11-07T06:08:28+00:00">2008-11-07 06:08:28</time>
  </header>

  <p>I just came to move some ruby scripts onto my mac mini, and to do so I needed to install a couple of gems. Now I realised I hadn't installed or updated rubygems on the machine for a while, so I figured it was best to update <code>gem</code> before installing the gems I wanted. Easier said than done.</p>

<p>At some point in the past I had added <code>http://gems.datamapper.org</code> as a source to rubygems. Since then the datamapper project has discontinued using this gem source to serve up gems, so I was getting the following output:</p>

<pre><code>mm:daemons caius$ sudo gem update --system
Updating installed gems
Bulk updating Gem source index for: http://gems.rubyforge.org/
ERROR:  While executing gem ... (Gem::RemoteSourceException)
    HTTP Response 404 fetching http://gems.datamapper.org/yaml
</code></pre>

<p>Eeek! I can't update because the source no longer exists. So I figured I'd remove the source before updating, that should work right? Wrong. It updates the sources before removing the source from the config it would appear.</p>

<pre><code>mm:daemons caius$ sudo gem sources
** CURRENT SOURCES ***

http://gems.rubyforge.org
http://gems.datamapper.org

mm:daemons caius$ sudo gem sources -r http://gems.datamapper.org
Bulk updating Gem source index for: http://gems.rubyforge.org/
ERROR:  While executing gem ... (Gem::RemoteSourceException)
    HTTP Response 404 fetching http://gems.datamapper.org/yaml
</code></pre>

<p>Oh balls. So how do I remove the source without updating it first. I need to update it to remove it, but to remove it I need to update from it. Gotta love catch 22s!</p>

<p>I remembered that <code>gem install</code> has an option not to update sources, <code>--no-update-sources</code>. So I figured thats gotta work when removing a source as well, but it doesn't.</p>

<pre><code>mm:daemons caius$ sudo gem sources -r http://gems.datamapper.org --no-update-sources
ERROR:  While executing gem ... (OptionParser::InvalidOption)
    invalid option: --no-update-sources
</code></pre>

<p>Oh crap. Now what do I do? Take my usual tactic and google for a hint of course! I'd considered trying to find where the gem config was and remove the source by hand, but I figured that wouldn't be that simple. After hitting a couple of sites that weren't relevant I ended up <a href="http://jaigouk.blogspot.com/2008/07/404-fetching-httpgemsdatamapperorgyaml.html">on the edge of complexity</a> where he mentions the command <code>nano ~/.gemrc</code>. Which made me wonder if that file contains the sources.</p>

<pre><code>mm:daemons caius$ cat ~/.gemrc
--- 
:update_sources: true
:verbose: true
:bulk_threshold: 1000
:sources: 
- http://gems.rubyforge.org
- http://gems.datamapper.org
:backtrace: false
:benchmark: false
</code></pre>

<p>All I needed to do was remove the <code>- http://gems.datamapper.org</code> line and <em>poof</em>, <code>gem</code> was working again. One quick <code>gem update --system</code> later and I was upgraded from gem 1.1.1 to 1.3.1 and installing the gems I needed.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/catch-22/">catch 22</a>, <a href="/tag/gem/">gem</a>, <a href="/tag/rubygems/">rubygems</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Setting up git with rails apps</h1>
    <time datetime="2008-11-06T13:03:02+00:00">2008-11-06 13:03:02</time>
  </header>

  <p>When I create a new rails app, I'm constantly going back to another project and stealing the <code>.gitignore</code> file from it to make sure that git doesn't know about certain files rails either updates frequently, or stores machine-specific data in. The latter is generally just <code>config/database.yml</code>, because I develop alongside my colleagues at <a title="Brightbox - Serious Rails Hosting" href="http://brightbox.co.uk/">Brightbox</a> and we deploy via <a href="http://www.capify.org/">capistrano</a>, we always put the <code>database.yml</code> file in the shared directory on the server, so we each have our own version with our local credentials in it locally. And thus we don't want it to be tracked by git.</p>

<p>Here's what I've collated from various sources over the few weeks I've been using git + rails everyday.</p>

<h4 id="gitignore">.gitignore</h4>

<pre><code>config/database.yml
log/*.log
tmp/*

# OS X only
.DS_Store
**/.DS_Store
</code></pre>

<p>Then to make sure <code>log/</code> and <code>tmp/</code> are tracked, I just add a blank .gitignore file in them.</p>

<pre><code>touch log/.gitignore
touch tmp/.gitignore
</code></pre>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/git/">git</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Spanning Sync</h1>
    <time datetime="2008-11-03T11:40:04+00:00">2008-11-03 11:40:04</time>
  </header>

  <p>So for <a title="Brightbox - Serious rails hosting" href="http://www.brightbox.co.uk">work</a> I have to subscribe to a shared google calendar the company uses. Annoyingly this can't be through my Google Apps account though, it has to be through my normal google account.</p>

<p>Also annoying is the fact google doesn't let me subscribe to my shared calendars without making them 100% public. Which means the shared private calendar work uses would have to be a <em>public</em> shared calendar, which is obviously not going to happen. (Can't have everyone knowing when the secret drinking parties are!)</p>

<p>Thankfully, there is already a solution out there to this problem, and it comes in the form of a Preference Pane called <a title="Spanning Sync" href="http://spanningsync.com/">SpanningSync</a> that syncs iCal to Google Calendar. All you need to do is install the prefpane and enter your google email/password (which is then safely secured in your keychain I believe.)</p>

<p>What it does is stick an icon in the menubar, and then at a pre-defined (and customisable) interval, sync any new changes between the local iCal calendar and the remote shared calendar in your google acccount.</p>

<p>Spanning Sync is only $25 to register for the year, but you can save yourself $5 by entering <strong>6EMQAC</strong> as the spanning sync coupon code, or <a href="http://spanningsync.com/?r=6EMQAC">clicking here</a></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> 
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Create a blank rails app including plugins</h1>
    <time datetime="2008-11-03T06:48:27+00:00">2008-11-03 06:48:27</time>
  </header>

  <p>When I create a rails app from scratch I like to include certain plugins to help me write the app, such as the <em>Rspec</em> testing framework instead of the built-in <em>Test::Unit</em> and <em>jQuery</em> instead of <em>prototype</em>.</p>

<ul>
  <li><a href="http://rspec.info/">Rspec</a></li>
  <li><a href="http://github.com/rahoulb/rspec-rails/wikis">Rspec-rails</a> <em>(NB: I use <a href="http://3hv.co.uk">rahoul</a>'s fork of rspec-rails)</em></li>
  <li><a href="http://github.com/aslakhellesoy/cucumber/wikis">Cucumber</a></li>
  <li><a href="http://github.com/brynary/webrat/wikis">Webrat</a></li>
  <li><a href="http://ennerchi.com/projects/jrails">jRails</a></li>
  <li><a href="http://plugins.code.lukeredpath.co.uk/browser/demeters_revenge/trunk">Demeters Revenge</a></li>
</ul>

<p>And here are the commands in the order I run them to create the blank app.</p>

<pre><code># Create the rails app
cd ~/Sites/apps/
rails myapp
cd myapp

# Setup a git repo
git init
# Add all files and make the initial import
git add .
git commit -m "Initial Import"

# Add the plugins as git submodules
git submodule add git://github.com/dchelimsky/rspec.git vendor/plugins/rspec
git submodule add git://github.com/rahoulb/rspec-rails.git vendor/plugins/rspec-rails
git submodule add git://github.com/aslakhellesoy/cucumber.git vendor/plugins/cucumber
git submodule add git://github.com/brynary/webrat.git vendor/plugins/webrat
git submodule add git://github.com/caius/demeters_revenge.git vendor/plugins/demeters_revenge

# Commit the changes
git ci -am "Adding all needed submodules"

# Replace TestUnit with rspec
git rm -r test/
ruby script/generate rspec
# Replace stories with cucumber features
rm -rf stories/
ruby script/generate cucumber

# Add the changes to git
git add .
git ci -m "Committing initial rspec/cucumber files"

# Install jRails, we have to install it using script/plugin
# Remove existing javascript files
git rm public/javascripts/*
mkdir public/javascripts
# Add jrails
ruby script/plugin install http://ennerchi.googlecode.com/svn/trunk/plugins/jrails
git add vendor/plugins/jrails/ public/javascripts
git ci -m "Adding jRails to replace Prototype"
</code></pre>

<p>And now you have a blank app waiting for you to write using features for full stack testing, and rspec for testing model and controller code.</p>

<h4 id="updated-2008-11-04">Updated 2008-11-04</h4>

<p>Added demeters revenge and jRails plugins.</p>

<h4 id="update-2008-11-05">Update 2008-11-05</h4>

<p>I've also blogged the <a href="http://swedishcampground.com/setting-up-git-with-rails-apps">.gitignore</a> file I use with rails apps as well. Usually add it into my apps before running <code>git init</code></p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>, <a href="/tag/rails/">rails</a>, <a href="/tag/rspec/">rspec</a>, <a href="/tag/cucumber/">cucumber</a>, <a href="/tag/webrat/">webrat</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Keyboards</h1>
    <time datetime="2008-10-14T13:59:01+00:00">2008-10-14 13:59:01</time>
  </header>

  <p>Back in the day I swapped the keys on my 12" powerbook keyboard around to read <code>macgenius</code> across the middle row.</p>

<p><a href="http://www.flickr.com/photos/caius/2941719496/"><img alt="Powerbook Keyboard" src="http://farm4.static.flickr.com/3213/2941719496_caf2a6a813_m.jpg" /></a></p>

<p>I unearthed the picture, and figured, why not do it to my apple aluminium keyboard? So I found a <a href="http://skeltoac.com/2007/10/22/apple-keyboard-aluminum-keycap-removal/">tutorial</a> from some other guy that'd done it, and dug out my penknife.</p>

<p><a href="http://www.flickr.com/photos/caius/2938651260/"><img alt="External Keyboard" src="http://farm4.static.flickr.com/3243/2938651260_915f42d92d_m.jpg" /></a></p>

<p>After that I decided to rearrange the macbook internal keyboard as well. First I googled around to make sure lifting the keys was the same as doing it on the external keyboard (which it appeared to be), then I went ahead and rearranged them as well.</p>

<p><a href="http://www.flickr.com/photos/caius/2940872039/"><img alt="Internal Keyboard -- Macgenius" src="http://farm4.static.flickr.com/3214/2940872039_164ee672ef_m.jpg" /></a></p>

<p>So whilst I was wondering what to do about it, my mother emailed me and suggested using <code>ontherails</code> instead of <code>macgenius</code>. So I did, and now the top row reads <code>ontherails</code> on the macbooks' internal keyboard.</p>

<p><a href="http://www.flickr.com/photos/caius/2941726222/"><img alt="Internal Keyboard -- Ontherails" src="http://farm4.static.flickr.com/3146/2941726222_67b2405a89_m.jpg" /></a></p>

<p>All pictures are licenced under <a href="http://creativecommons.org/licenses/by/2.0/deed.en_GB">Creative Commons Attribution 2.0 Generic licence</a> and the above pictures, plus some <em>in progress</em> shots, are available in my <a href="http://www.flickr.com/photos/caius/sets/72157608015895484/">Keyboard Modifications</a> flickr set.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/funny/">funny</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/flickr/">flickr</a>, <a href="/tag/mother/">mother</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/keyboard/">keyboard</a>, <a href="/tag/modification/">modification</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Alistapart Survey</h1>
    <time datetime="2008-07-29T14:47:24+00:00">2008-07-29 14:47:24</time>
  </header>

  <p><a href="http://alistapart.com/articles/survey2008"><img src="http://aneventapart.com/webdesignsurvey/templates/ala/images/i-took-the-2008-survey.gif" title="I took the 2008 alistapart survey -- you should to!" /></a></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/statistics/">statistics</a>, <a href="/tag/programming/">programming</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Another Concise Code Example</h1>
    <time datetime="2008-04-26T15:54:09+00:00">2008-04-26 15:54:09</time>
  </header>

  <p>This is just another example showing how I refactor code down to its bare minimum. The reason why I do this so much (and indeed I think why ruby is so easy to read compared to other languages) is because it makes my code more readable and less of a bugger to pick up after a while.</p>

<pre><code>class Page
    attr_accessor :parent_id
    
    def old_parent
    # The returns aren't needed here in ruby, but in other
    # languages using this logic block you would require
    # the returns, so I left them in here.

    if self.parent?
      return Page.find( self.parent_id )
    else
      return false
    end
  end

  def parent
    return Page.find( self.parent_id ) if self.parent?
    false
  end

end
</code></pre>

<p><code>old_parent</code> and <code>parent</code> return exactly the same, but one is 2 lines compared to 5 and easier to read.</p>

<p><strong>Update:</strong> <a href="http://ciaranwal.sh/">Ciaran</a> pointed out that the Page.parent method would only ever return false. Added the return statement to it to fix the bug.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Inaugural Habaricon</h1>
    <time datetime="2008-04-01T07:27:55+00:00">2008-04-01 07:27:55</time>
  </header>

  <p>So I managed to secure a place to <a href="http://habaricon.com/">HabariCon '08</a>. Not quite sure what to expect, but being able to meet other people in real life and talk about habari &amp; related things all day will be quite cool.</p>

<p>Expect a round-up post of the 'con tonight!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/tech/">tech</a>, <a href="/tag/social/">social</a>, <a href="/tag/link/">link</a>, <a href="/tag/youtube/">youtube</a>, <a href="/tag/habari/">habari</a>, <a href="/tag/habaricon/">habaricon</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>BarCamp Manchester</h1>
    <time datetime="2008-03-01T11:34:25+00:00">2008-03-01 11:34:25</time>
  </header>

  <p>So I'm at BarCamp Manchester for the day.  Its great meeting people I already know, and meeting new ones; most impressed by <a href="http://petercooper.co.uk/">Peter</a>'s ruby shoes.. they glitter!</p>

<p>So heres a little list of links for the day:</p>

<ul>
  <li><a href="http://www.flickr.com/photos/tags/BarCampManchesterUk/">http://www.flickr.com/photos/tags/BarCampManchesterUk/</a></li>
  <li><a href="http://barcamp.org/BarCampManchesterUk">http://barcamp.org/BarCampManchesterUk</a></li>
</ul>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/camera/">camera</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/uk/">uk</a>, <a href="/tag/barcamp/">barcamp</a>, <a href="/tag/social/">social</a>, <a href="/tag/manchester/">manchester</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Command line tricks: Scripting Languages</h1>
    <time datetime="2008-02-14T16:24:27+00:00">2008-02-14 16:24:27</time>
  </header>

  <p>To search your php.ini file quickly and easily with the option to use regular expressions, I tend to drop back to the <acronym title="command line interface">cli</acronym>.  The reason for this is I can easily parse the output of <code>phpinfo()</code> with <code>grep</code>, and can do various things with the output, could even pass it to a script if I really wanted to.</p>

<p>Here is the line I use to search <code>phpinfo()</code></p>

<pre><code>echo "&lt;?php phpinfo() ?&gt;" | php | grep -i $search_string
</code></pre>

<p>It passes the string through the php interpreter and then searches through it with grep.</p>

<p>You can also do other nifty things with the shell &amp; php + ruby especially (though I imagine python &amp; perl work in the same way.) For instance I wanted to see if the following ruby would return the number of seconds since the <a href="http:/en.wikipedia.org/wiki/Unix_Time">epoch</a> till now.</p>

<pre><code>puts Time.now.to_i
</code></pre>

<p>Now I could fire up a PHP page and do something like the following</p>

<pre><code>&lt;?php
    echo "php: " . time() . "\n";
    echo `ruby -e 'puts "ruby: #{Time.now.to_i}"'`;
?&gt;
</code></pre>

<p>But what if I've not got a web server with PHP running on the machine I'm using? Well then I could drop back to the shell and run it through <code>php</code> using <code>cat</code> as a way to insert multiple lines, and it would look like the following</p>

<pre><code>Julius:~ caius$ cat | php
&lt;?php
    echo "php: " . time() . "\n";
    echo `ruby -e 'puts "ruby: #{Time.now.to_i}"'`;
?&gt;
^D
php: 1203004463
ruby: 1203004463
</code></pre>

<p>Now this works, but why do I want to remember all that php, and seeing as I have to drop back to the shell to access the ruby statement, why not just let the shell do all the work? So after a few seconds thinking, I came up with this</p>

<pre><code>ruby -e 'puts "ruby: #{Time.now.to_i}"' &amp;&amp; \
echo '&lt;?php echo "PHP: " . time() . "\n" ?&gt;' | php
</code></pre>

<p>This runs the ruby code through <code>ruby</code> and the php code through <code>php</code> without dropping back to the shell from within a language interpreter :)</p>

<h3 id="update">Update:</h3>

<p>Following fangels comment pointing out <code>php -r</code> is the equivilent of <code>ruby -e</code> I've since modified the final commands to read as follows</p>

<pre><code>ruby -e 'puts "ruby: #{Time.now.to_i}"' &amp;&amp; \
php -r 'echo "PHP: ".time()."\n";'
</code></pre>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/php/">php</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/code/">code</a>, <a href="/tag/cli/">cli</a>, <a href="/tag/bash/">bash</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Refactoring code logically</h1>
    <time datetime="2008-02-12T12:28:38+00:00">2008-02-12 12:28:38</time>
  </header>

  <p>And now an example of how I write my ruby code and get it down to the bare, readable, minimum code needed. This is real life code taken from a website I'm building, but I've changed the objects to a blog post because more people will relate to that easier.</p>

<p>The show object has an id passed in using the <code>params</code> Hash, I want to check if that post exists in the database first.  If it does, then render the page, and if it doesn't return a 404 error page.</p>

<p>So I start off by writing this in <em>longhand</em> ruby, I'm using the <a href="http://merbivore.com/">merb</a> framework with <a href="http://datamapper.com/">DataMapper</a> ORM by the way.</p>

<pre><code>def show
    @post = Post.first(params[:id])
    if @post
        render
    else
        raise "404 - Not found"
    end
end
</code></pre>

<p>Now whilst theres nothing wrong with this code, it just doesn't look right to me. There is a big if/else statement in there whilst I'm sure there doesn't need to be.</p>

<p>Now I know if I return at any point in a ruby method, it exits the method at that point. So the first thing to is to refactor the <code>if</code> test to remove a line of code. I shall assign <code>@post</code> to the result of the DB as the actual if statement's test.</p>

<pre><code>def show
    if @post = Post.first(params[:id])
        render
    else
        raise "404 - Not found"
    end
end
</code></pre>

<p>So thats reading slightly better, and also is a line less of code. Now I wonder if I can use a <code>return true</code> in there to stop me having to explicitly state an <code>else</code> clause.</p>

<pre><code>def show
    if @post = post.first(params[:id])
        render
        return true
    end
    raise "404 - Not found"
end
</code></pre>

<p>Now the eagerest amongst you will be wondering what the advantage of that code is. It doesn't appear any more readable (slightly less in fact as you have to figure out its an implicit else) and is exactly the same amount of lines as the previous example. But what if we change the <code>if</code> to an <code>if !</code> and flip the code logic around?</p>

<pre><code>def show
    if !@post = Post.first(params[:id])
        raise "404 - not found"
    end
    render
end
</code></pre>

<p>Now a raise will stop the code executing, and in the real application you would in fact just redirect to your 404 error page. The problem now is the <code>if !</code> looks ugly and isn't easily readable.</p>

<p>All <code>unless</code> does is <code>if !</code>, that is, if the inverse of the result of the test statement is true, then invoke the block given to it. A quick example for you:</p>

<pre><code># without unless
if !@user.logged_in?
    puts "Please login."
end

# using unless
unless @user.logged_in?
    puts "Please login."
end
</code></pre>

<p>Now whilst <code>if !</code> doesn't seem that bad compared to <code>unless</code>, the readablility of the code increases. It reads more as a flow of logic, and is quicker for the human brain to walk through (my brain anyway!)</p>

<p>So using unless we get 4 lines of code that is easily readable.</p>

<pre><code>def show
    unless @post = Post.first(params[:id])
        raise "404 - Not found"
    end
    render
end
</code></pre>

<p>Now what if we go one step further and use the unless shorthand way of testing and exectuting one line of code?</p>

<pre><code>def show
    raise "404 - Not found" unless @post = Post.first(params[:id])
    render
end
</code></pre>

<p>And that is generally how I write my code logically.  Of course for something simple like this I'd probably jump in at the last block having refactored it in my head first, but for more complex things I tend to write them exlicitly and then refactor them down whilst maintaining readability of my code.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/merb/">merb</a>, <a href="/tag/datamapper/">datamapper</a>, <a href="/tag/code/">code</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Use datamapper sessions with merb & datamapper</h1>
    <time datetime="2008-02-05T20:27:31+00:00">2008-02-05 20:27:31</time>
  </header>

  <h3 id="issue">Issue</h3>

<p>Can't use merb sessions with datamapper &amp; mysql, get back an error about needing an id on the text column or something (I had the error a couple of days ago.)</p>

<h3 id="solution">Solution</h3>

<p>I suggest grabbing merb_datamapper svn source to fix this in.  To do so make sure you have subversion installed on your machine (I'm assuming a Unix based machine here.)</p>

<ol>
  <li>
    <p>Checkout the source</p>

    <pre><code> svn co http://svn.devjavu.com/merb/plugins/merb_datamapper
</code></pre>

    <p>Checks out the svn source to ./merb_datamapper</p>
  </li>
  <li>
    <p>Open up the affected file in your favourite editor <em>(I use TextMate)</em></p>

    <pre><code> cd merb_datamapper
 mate lib/merb/sessions/data_mapper_session.rb
</code></pre>
  </li>
  <li>
    <p>Find line 25 that contains</p>

    <p><code>property :session_id, :text, :lazy =&gt; false, :key =&gt; true</code></p>

    <p>and remove <code>:text, :lazy =&gt; false</code> to replace it with <code>:string</code></p>

    <p><code>property :session_id, :string, :key =&gt; true</code></p>

    <p>Save and close the file, thats the editing done.  Now to install the gem.</p>
  </li>
  <li>
    <p>Build the gem</p>

    <pre><code> rake gem
</code></pre>
  </li>
  <li>
    <p>Install the gem</p>

    <pre><code> sudo gem install pkg/merb_datamapper-0.5.gem
</code></pre>
  </li>
</ol>

<p>And you're away with the fix installed.  Now just run <code>merb</code> to create your sessions table in the db.  Hope this helped!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/programming/">programming</a>, <a href="/tag/merb/">merb</a>, <a href="/tag/datamapper/">datamapper</a>, <a href="/tag/merb_datamapper/">merb_datamapper</a>, <a href="/tag/code/">code</a>, <a href="/tag/bug/">bug</a>, <a href="/tag/fix/">fix</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Why do I love Ruby?</h1>
    <time datetime="2008-01-30T14:15:24+00:00">2008-01-30 14:15:24</time>
  </header>

  <p>So mother (who can't program) just posed me the question</p>

<blockquote>
  <p>Why is Ruby your favourite programming language?</p>
</blockquote>

<p>Me being a show off jumped straight into <a href="http://macromates.com/">TextMate</a> and banged out some code in real time to show her.  First up, a quick little one-liner of Ruby code to output a String:</p>

<pre><code>puts "Hello World"
# =&gt; "Hello World"
</code></pre>

<p>So she goes, "Sure, but whats so brilliant about that?" So I just decide to reverse the string, have it output in reverse order:</p>

<pre><code>puts "Hello World".reverse
# =&gt; "dlroW olleH"
</code></pre>

<p>Then the next question comes, "So what makes that so much easier than in other languages?" Well now I was thinking on the spot about which other language I can bang out a quick example in without having to look up too much information.  PHP seems the logical choice, being the language I know best behind Ruby.</p>

<p>Thinking about how to do it in PHP, I can't think of a function to reverse the content of a string, but I know that <code>array_reverse()</code> exists, so I just split it into an array and reverse that array.  Only problem is I can't remember how to split a string by <code>""</code>, I don't think <code>explode( "", $var )</code> does the job.  So I quickly jump in and write the following code to test my concern.</p>

<pre><code>&lt;?php
$a = "Hello World"
$b = explode( "", $a );
$c = array_reverse( $b );
echo implode( "", $c );
?&gt;
# =&gt; ERROR
</code></pre>

<p>The reason for the error is because I've missed a semi colon off the end of line 2, to this I get the response, "well thats certainly not as nice as ruby." Just because one little character is missing!</p>

<p>So I fix the semi colon and run it again, now I get an error complaining about explode not being able to split by a missing delimiter (the empty string - <code>""</code>)  So I go hunting through the <a href="http://php.net/">php.net</a> docs and find <code>str_split()</code>, which does exactly what I want it to.</p>

<p>In replacing <code>explode()</code> with <code>str_split()</code> and running it via the <code>php</code> command line binary, I realise that I haven't got any <code>\n</code> (newlines) at the end of it, so it doesn't display nicely in the terminal.  I thus update the script to the following and show her the result:</p>

<pre><code>&lt;?php
$a = "Hello World";
$b = explode( "", $a );
$c = array_reverse( $b );
echo implode( "", $c )."\n";
?&gt;
# =&gt; "dlroW olleH"
</code></pre>

<p>And so she goes away seeing why I prefer Ruby to other languages for <em>most</em> programming I do. There are things Ruby fails at (and don't get me started on why rails isn't going to replace php!) and other places where it succeeds very well.</p>

<p>But each to their own, and my own favourite is Ruby!</p>

<h3 id="update">Update</h3>

<p>As pointed out in the comments, if I had looked a bit further I would've found <code>strrev()</code> which does the same as the <code>reverse</code> method in Ruby.  So in fact the final code would be:</p>

<pre><code># Ruby Code
puts "Hello World".reverse

# PHP Code
echo strrev( "Hello World" );
</code></pre>

<p>So it turns out this was a bad way to show why I prefer Ruby to PHP code wise to mother, think I might have to just bite the bullet and write about why I prefer <code>object.method</code> to <code>method( object )</code>!</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/geek/">geek</a>, <a href="/tag/tech/">tech</a>, <a href="/tag/mother/">mother</a>, <a href="/tag/ruby/">ruby</a>, <a href="/tag/php/">php</a>, <a href="/tag/programming/">programming</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>UK Parking</h1>
    <time datetime="2008-01-12T12:35:01+00:00">2008-01-12 12:35:01</time>
  </header>

  <p>So I just saw this in my twitter stream:</p>

<blockquote>
  <p><a href="http://twitter.com/peterc/statuses/590099072">peterc</a>: Warning UK drivers.. councils get powers on March 31st to give you parking fines for infractions they see on CCTV!</p>
</blockquote>

<p>This indeed sucks.  We'll see how successful they are at ticketing people and whether anyone abuses the system…</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/twitter/">twitter</a>, <a href="/tag/uk/">uk</a>, <a href="/tag/law/">law</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Published Pictures</h1>
    <time datetime="2008-01-05T16:08:39+00:00">2008-01-05 16:08:39</time>
  </header>

  <p>Interesting email arrived in my inbox today.  I attended <a href="http://barcamp.org/BarCampLeeds">BarCamp Leeds</a> in late 2007 and whilst I was there I happened to take some pictures (as I am apt to do these days.)</p>

<p>Anyway, I was rather happy to see that at least one picture isn't just stagnating in my <a href="http://flickr.com/photos/caius/">flickr stream</a>:</p>

<blockquote>
  <p>Hi Caius,</p>

  <p>I am delighted to let you know that one of your photos with<br />
a Creative Commons license has been selected for inclusion<br />
in the newly released fourth edition of our Schmap Leeds<br />
Guide:</p>

  <p>Town Hall
<a href="http://www.schmap.com/leeds/sights_hydepark/p=39139/i=39139_10.jpg">http://www.schmap.com/leeds/sights_hydepark/p=39139/i=39139_10.jpg</a></p>
</blockquote>

<p><a href="">Original Picture on flickr</a></p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/camera/">camera</a>, <a href="/tag/flickr/">flickr</a>, <a href="/tag/leeds/">leeds</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Twitter Statistics</h1>
    <time datetime="2008-01-02T07:15:00+00:00">2008-01-02 07:15:00</time>
  </header>

  <p><a href="http://flickr.com/photo_zoom.gne?id=2157771886&amp;size=o"><img alt="Twitter Statistics for caius" src="http://farm3.static.flickr.com/2345/2157771886_9e41008ac2_m.jpg" /></a></p>

<p><a href="http://dcortesi.com/2007/12/27/twitter-stats/">Just</a> <a href="http://www.flickr.com/photos/gruber/2156085517/">joining</a> <a href="http://www.randsinrepose.com/archives/2008/01/01/year_in_twitter.html">the</a> <a href="http://kosmar.de/archives/2007/12/29/twitter-statistics/">band</a> <a href="http://blog.nordquist.org/?p=2083">wagon</a> in posting up my twitter statistics.  The skew towards december being the month I twitter most in is because I enabled twitter sms, and ended up replying/updating a lot more often than I expected.</p>



  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/twitter/">twitter</a>, <a href="/tag/geek/">geek</a>, <a href="/tag/statistics/">statistics</a>, <a href="/tag/graph/">graph</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>OS X User has a virus</h1>
    <time datetime="2008-01-02T01:15:15+00:00">2008-01-02 01:15:15</time>
  </header>

  <p>No not my computer, me.  I've managed to pickup an <acronym title="Common Cold">acute coryza</acronym> virus.  It causes <code>/dev/random</code> to constantly pass data to <code>/Volumes/nose</code>.  I don't think I got this from reading email, but I'm pretty sure it was a windows user who passed it to me.</p>

<p>If I flush my partitions to disk every now and then I can get by with a clean <code>/Volumes/nose</code> for a while before <code>/dev/random</code> starts clogging it up again.</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/funny/">funny</a>, <a href="/tag/cold/">cold</a>, <a href="/tag/geek/">geek</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>dSLR Quote</h1>
    <time datetime="2007-12-31T17:25:25+00:00">2007-12-31 17:25:25</time>
  </header>

  <p>I was just talking to <a href="http://keihatsu.org/">Nadim</a> about him getting a new camera and then this happened:</p>

<blockquote>
  <p>Nadim: <a href="http://cyraq.deviantart.com/art/Above-the-Clouds-72170767">http://cyraq.deviantart.com/art/Above-the-Clouds-72170767</a><br />
Nadim: Did you see that?<br />
Nadim: Taken couple of weeks ago<br />
Caius: woa<br />
Caius: and you need a new camera because? :P<br />
Nadim: I have wet dreams about DSLR's</p>
</blockquote>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/funny/">funny</a>, <a href="/tag/camera/">camera</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>

  <article>

  <header>
    <h1>Quote to see the new year in</h1>
    <time datetime="2007-12-31T17:11:11+00:00">2007-12-31 17:11:11</time>
  </header>

  <p>So I'm a geek, as my friends are gradually realising more and more.  Anyway, I twitter a lot, and occasionally write quotes that need to be saved elsewhere.  And what generally makes tweets funnier are other people replying to them.</p>

<p>A little background information.  This had just taken place in #habari (a chat room.)</p>

<pre><code>&lt;h0bbel&gt; ringmaster: i'll show you my winky
* ringmaster runs.
&lt;h0bbel&gt; as jmullan has seen it
&lt;h0bbel&gt; i think
&lt;jmullan&gt; no, I didn't look
&lt;ringmaster&gt; 0_o
&lt;h0bbel&gt; i was kinda drunk at the time
&lt;h0bbel&gt; lol
&lt;jmullan&gt; we were playing "lightsabers" while peeing
&lt;jmullan&gt; not "swords"
&lt;jmullan&gt; I had the yellow saber, h0bbel had the green one
&lt;jmullan&gt; I'm not sure how that worked
&lt;h0bbel&gt; you said you didn't look!
&lt;h0bbel&gt; How did you know it was green?
&lt;jmullan&gt; I just saw the beam, not the handle, if you know what I'm saying
&lt;h0bbel&gt; ehehe
&lt;Caius&gt; xD
&lt;ringmaster&gt; This is all somewhat disturbing.
</code></pre>

<p>So in order</p>

<ul>
  <li>
    <p><a href="http://twitter.com/caius/statuses/549893582">me</a></p>

    <blockquote>
      <p>man, #habari just wouldn't be the same without the semi-homosexual discussions every now and then</p>
    </blockquote>
  </li>
  <li>
    <p><a href="http://twitter.com/caius/statuses/549893582">me</a></p>

    <blockquote>
      <p>Formatting some SQL queries for a fellow dev</p>
    </blockquote>
  </li>
  <li>
    <p><a href="http://twitter.com/h0bbel/statuses/549895502">h0bbel</a></p>

    <blockquote>
      <p><a href="http://twitter.com/caius/statuses/549893582">http://twitter.com/caius/st…</a> is realy quoteworthy ;-)</p>
    </blockquote>
  </li>
  <li>
    <p><a href="http://twitter.com/tmertz/statuses/549899752">Mertz</a></p>

    <blockquote>
      <p>@<a href="http://twitter.com/caius">caius</a>, wtf are you doing? put down the computer, take five steps back and go find a new years celebration.</p>
    </blockquote>
  </li>
  <li>
    <p><a href="http://twitter.com/caius/statuses/549903292">me</a></p>

    <blockquote>
      <p>@<a href="http://twitter.com/tmertz">tmertz</a> just hanging in #habari whilst editing some SQL queries @<a href="http://twitter.com/h0bbel">h0bbel</a> wrote waiting for 1900GMT to go round my mates and get drunk</p>
    </blockquote>
  </li>
</ul>

<p>And on the back of that, I'd just like to say have a very merry new years eve and just follow your desires onwards in life!</p>


  <footer>
    <p class="tags">
      <strong>Tags:</strong> <a href="/tag/quote/">quote</a>, <a href="/tag/twitter/">twitter</a>, <a href="/tag/funny/">funny</a>
    </p>

    <p class="license">
      This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>
</article>


    </main>

    <nav>
      <div class="archives">
        <h3>Archives</h3>
<!--        <ul>
            <li></li>
        </ul>
-->
      </div>

      <div class="feed">
        <link rel="alternate" type="application/rss+xml" title="Syndicate (atom)" href="/feed/" />
      </div>
    </nav>

    <span class="clear"></span>

    <footer>
      <p class="first">
        <a href="/">CaiusTheory</a>
      </p>
      <p class="last">
        Inspired by <a href="http://labs.utopian.net/habari/theme/sp/">sp</a>
      </p>
      <span class="clear"></span>
    </footer>
  </body>
</html>
